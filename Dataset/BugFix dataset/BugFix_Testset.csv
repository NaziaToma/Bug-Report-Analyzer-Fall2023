Bug ID,Short Description,Resolution,Bug Report,Comment2,Comment3,Comment4,Comment5,Comment6,Comment7,Comment8,Comment9,Comment10,Comment11,Comment12,Comment13,Comment14,Comment15,Comment16,Comment17,Comment18,Comment19,Comment20,Comment21,Comment22,Comment23,Comment24,Comment25,Comment26,Comment27,Comment28,Comment29,Comment30,Comment31,Comment32,Comment33,Comment34,Comment35,Comment36,Comment37,Comment38,Comment39,Comment40,Comment41,Comment42,Comment43,Comment44,Comment45,Comment46,Comment47,Comment48,Comment49,Comment50,Comment51,Comment52,Comment53,Comment54,Comment55,Comment56,Comment57,Comment58,Comment59,Comment60,Comment61,Comment62,Comment63,Comment64,Comment65,Comment66,Comment67,Comment68,Comment69,Comment70,Comment71,Comment72,Comment73,Comment74,Comment75,Comment76,Comment77,Comment78,Comment79,Comment80,Comment81,Comment82,Comment83,Comment84,Comment85,Comment86,Comment87,Comment88,Comment89,Comment90,Comment91,Comment92,Comment93,Comment94,Comment95,Comment96,Comment97,Comment98,Comment99,Comment100,Comment101,Comment102,Comment103,Comment104,Comment105,Comment106,Comment107,Comment108,Comment109,Comment110,Comment111,Comment112,Comment113,Comment114,Comment115,Comment116,Comment117,Comment118,Comment119,Comment120,Comment121,Comment122,Comment123,Comment124,Comment125,Comment126,Comment127,Comment128,Comment129,Comment130,Comment131,Comment132,Comment133,Comment134,Comment135,Comment136,Comment137,Comment138,Comment139,Comment140,Comment141,Comment142,Comment143,Comment144,Comment145,Comment146,Comment147,Comment148,Comment149,Comment150,Comment151,Comment152,Comment153,Comment154,Comment155,Comment156,Comment157,Comment158,Comment159,Comment160,Comment161,Comment162,Comment163,Comment164,Comment165
1631162,mozregression GUI log pane context menu results in crash,FIXED,"User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0

Steps to reproduce:

I'm using the latest mozregression from the repo and testing some issues related to bug 1536324.

pip install -e . && python gui/build.py test

After the log pane gets some text in it right-click on the pane to bring up the context menu and choose Debug.


Actual results:

~~~
platform: Windows-7-6.1.7601-SP1
python: 3.8.1 (64bit)
mozregression: 4.0.4.dev0+ga387b60.d20200417
message: TypeError: 'PySide2.QtGui.QTextBlock' object is not an iterator
traceback:   File ""X:\code\mozregression\mozregression\gui\mozregui\log_report.py"", line 90, in on_log_filter
    current_block = next(current_block)
~~~



Expected results:

No crash. The context-menu entries if I understand should be used to filter on/off verbosity levels.",Thanks Ray! Will look into this.,"Created attachment 9141729
Link to GitHub pull-request: https://github.com/mozilla/mozregression/pull/621","Should be fixed in the next release, see pull request",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1624336,Startup crash of Firefox 74.0 on Windows 7 and Comodo Firewall 5.12,FIXED,"Created attachment 9135109
Win7_Firefox_74.0_crash_error_signature.txt

User Agent: Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0

Steps to reproduce:

On a clean Windows 7 installation (with all MS updates) and with Comodo Firewall 5.12.256249.2599 and Avira Antivirus installed (so far no other software installed) Firefox 74.0 crashes on startup (a message window pops-up saying ""Firefox has stopped working""). Firefox crashes on Windows 7 since versions greater then 70.0.1. Versions 70.0.1 and below run fine.
After I installed and tried to start 74.0 (which failed) I re-installed 70.0.1 again and that version works normally.

I've been using Firefox and Comodo Firewall 5.12 together for many many years (since Windows 2000, Windows XP) without problems.
I have read about some other Firefox startup crash bugs related to Comodo software so I think my problem could be in the same category but I'm not sure.



Actual results:

Firefox crashes on startup on Windows 7. Firefox window does not show up at all.


Expected results:

Normal startup, showing Firefox window on Windows 7.","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.","Bugbug, I'm not sure whether your component change is correct or not. But I think the Product should be Firefox so I made the change.","hi, this is likely the same issue or similar to bug 1590430. please try to update or else ditch comodo.

*** This bug has been marked as a duplicate of bug 1590430 ***","Hello,

I don't think this is a duplicate bug because there is no ""iseguard64.dll"" on the whole Windows 7 partition (not even a match for ""ise*.*"") . However, there is a ""guard64.dll"" file located in the Windows 7 ""c:\Windows\System32\"" directory and one in ""c:\Windows\SysWOW64\guard32.dll"".
Could it be that these dll files are causing the same issue as the ""iseguard64.dll"" file?

I was hoping that Mozilla could fix this issue so that I still could continue to use Comodo Firewall 5.12 (I know there are newer versions but they come with a lot of stuff that I don't need.)

Is there any chance from Mozilla to fix the Firefox crash for this Comodo version 5.12?

Thanks.","Hello,

Also referring to my previous comment...
Please note that no Comodo Antivirus has been installed on Windows 7 only the Firewall part is installed which might cause this issue (still not sure though).
 
Please feel free to close this bug for good if Mozillas final decision is to not fix this issue for Comodo Firewall 5.12.

Thank you very much.","Additional information:

To prove that Comodo Firewall 5.12 is causing the Firefox 74.0 startup crash I did the following.

1) Created an image of the Windows 7 HD partition for backup purpose.
2) Booted into Windows 7 (with Comodo Firewall 5.12 and Firefox 70.0.1 installed, both working normally).
3) Uninstalled Comodo Firewall 5.12 and as instructed by the uninstall software rebooted Windows 7.
4) Installed Firefox 74.0 by upgrading version 70.0.1 to 74.0.
5) Started Firefox 74.0 successfully (no crash).
6) Installed Comodo Firewall 5.12 again and as instructed by the install software rebooted Windows 7. 
7) Started Firefox 74.0 again, this time unsuccessfully  (crash).
8) Uninstalled Comodo Firewall 5.12 once again and as instructed by the uninstall software rebooted Windows 7.
9) Started Firefox 74.0 again successfully (no crash).
10) Backup image of step 1 put back on Windows 7 HD partition. 

Above steps show clearly that Firefox 74.0 conflicts with Comodo Firewall 5.12.
Could you please clarify what the root cause of this conflict is and if this issue could be solved by Mozilla?

Thanks you.","(In reply to nototheleft from comment #6)
> Could you please clarify what the root cause of this conflict is and if this issue could be solved by Mozilla?

It's almost certainly due to dlls injected by comodo into the firefox process, which are not dealing correctly with changes made in Firefox since 70.0.1. But we have no visibility into what those dlls do so there is very little we can do, apart from attempting to block the dlls if/when we know what they are -- this will likely break whatever functionality Comodo tries to offer within Firefox, but would also stop the crashes.

I have a few questions to try to help narrow down what's happening here:

1. when Firefox 74 crashes due to Comodo, does the Firefox crash reporter come up?
2. if you start Firefox in safe mode (pass --safe-mode on the commandline), does it work?
3. if the answer in (1) was ""yes"", if you start Firefox 70.0.1, and visit `about:crashes`, do you see crash reports from (1) (judging by the date/time), and if so, can you open them and then copy/paste the URLs in a comment here?
4. if the answer for (1) was ""no"", can you visit `about:crashparent` in Firefox 70.0.1 -**this will crash Firefox** - and then do the same as in (3) ? Those crash reports will tell us the names of all the DLLs in the process, and might help figure out what dll is causing the crashes.

Thank you!","Created attachment 9135413
Win7_Firefox74_FirefoxHasStoppedWorking.jpg","Hello,

Thank you for getting back on this issue!

Here is already one answer to your questions:

1. No, I don't see any Firefox window appearing after the crash. So no, I don't see a crash reporter come up. I attached the picture of the Windows 7 message window which pops-up immediately after the crash.

I get back to you for the answers on questions 2, 3 and 4 (need some time for that to check)

Thank you.","Created attachment 9135437
70.0.1_CrashReporterWindow.jpg","Here are all the answers in sequence of execution.

1. Answer to this question (as already given) is no.
2. When starting Firefox 74.0 from the commandline with ""E:\Mozilla Firefox>firefox --safe-mode"" it still crashes immediately, no Crash Reporter window comes up.
3. Answer in (1) is no, so no further action here at the moment.
4. Downgraded Firefox 74.0 to 70.0.1 first (I guess that is the intention) and started Firefox 70.0.1 and visted ""about:crashparent"". As expected Firefox 70.0.1 crashed and comes up with Crash Reporter window. In the Crash Reporter window (see attached picture) I clicked on ""Restart Firefox"" and visited ""about:crashes"" as per instruction in question (3),  Firefox window says ""No crash reports have been submitted.""


I repeated the whole sequence once more:
- Installed 74.0 again.
- Started 74.0 and let it crash.
- Installed 70.0.1 again
- Started 70.0.1 and visited ""about:crashparent"" and let it crash.
- Crash Reporter window comes up (see attached picture).
- Restarted Firefox 70.0.1 and visited ""about:crashes"".
- Firefox 70.0.1 showing a empty window saying ""No crash reports have been submitted.""

If all the above steps were executed correctly then, unfortunately, it seems that there is no crash report generated by Firefox 74.0 when it crashes.

Thank you.","We can solve this issue but we'll need you to collect a minidump for us to be able to identify the offending DLL. Since the crash is happening too early for our crash reporter to catch it you'll have to collect a user-mode dump. The instructions to do so are [here](https://docs.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps) but here's quick run-down:

* Using **regedit.exe** create the `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps` registry key. The key can be left empty as the default settings are fine.
* Launch Firefox and wait for it to crash
* Go into C:\Users\<username>\AppData\Local\CrashDumps and see if there's a minidump in there (.dmp extension)
* Send the minidump to me via e-mail so that I can analyze it

Important note: **do not attach the minidump to this bug**. It may contain sensitive information so it should not be public.","Ok, will do.
Need some time again.

Thanks","Done, I have sent the minidump via email to you.

Thanks",I've identified the DLL causing the crash. It's `guard64.dll` version `5.12.59641.2599`. I'll make a build that blocks it on try so that we can test if blocking fixes the problem.,"Great!
Looking forward to test it!","This is a test build of Firefox nightly that blocks the DLL causing the crash:

https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/C7PggDMwQzq6pnCGxIefUw/runs/0/artifacts/public/build/install/sea/target.installer.exe

Can you try it and report if it works?If you don't have nightly installed it will create a new profile so it won't touch your main Firefox profile. You can simply uninstall it once you're done testing it.",I'll download the file and test it and let you know if it works.,"Created attachment 9135644
76.0a1_FirefoxNigthly_Screenshot.jpg","Created attachment 9135645
76.0a1_FirefoxNigthly_ComodoDefensePlusAlert_1_PingSender.jpg","Created attachment 9135646
76.0a1_FirefoxNigthly_ComodoDefensePlusAlert_2_PingSender.jpg","Created attachment 9135647
76.0a1_FirefoxNigthly_ComodoDefensePlusAlert_3_PingSender.jpg","Created attachment 9135648
76.0a1_FirefoxNigthly_ComodoFirewallAlert_PingSender.jpg","Looks like it worked? Yay!

As for pingsender, it is a small executable that comes with Firefox that is used to send telemetry (that otherwise is sent by Firefox itself). You can turn off sending telemetry in the Firefox options.

I'm pretty sure it doesn't itself try to modify any registry keys (the full code for Windows is at https://searchfox.org/mozilla-central/source/toolkit/components/telemetry/pingsender/pingsender.cpp and https://searchfox.org/mozilla-central/source/toolkit/components/telemetry/pingsender/pingsender_win.cpp ) - it just calls standard Windows APIs to say ""send this http request"" (Firefox normally doesn't do so; it has its own http stack. pingsender doesn't use that, it's deliberately designed to be very lightweight). If those end up touching windows registry settings internally, that's a windows issue...","I've installed the Firefox Nightly 76.0a1 build and it starts without crashing!!!
Great!!
I've attached a screenshot of it!

After closing down Firefox Nightly I got Comodo Firewall pop-up Alerts of Firefox Nightly trying to execute the unknown ""PingSender.exe"" executable in trying to access system resources and an Alert on ""PingSender.exe"" trying to access the internet. As a test case I kept on blocking all Alerts generated ""PingSender.exe""  to check if ""PingSender.exe"" would finally give up trying to access the resources and trying to access the internet. It did give up after many blocking Alerts, great. I've attached screenshots of those Alerts too.

So to me your bug fix seems to work for Comodo Firewall 5.12.
Maybe it needs some more testing from my side but first results are looking good!

I do have a question regarding the fix you've implemented in Firefox Nightly.
Is this fix common for all Comodo Firewall versions including the most recent one (version 12)? In other words, does the most recent version of Comodo Firewall also inject dlls into the Firefox process(es) and is it blocked (by the fix you made) more or less in the same way or does the most recent version of Comodo Firewall inject dlls in a more compatible way so that it not conflicts with the Firefox process(es) or maybe the most recent version does not inject dlls at all (using another protecting scheme).
Also can you elaborate on, from the feedback given in comment #7 ""this will likely break whatever functionality Comodo tries to offer within Firefox"", what the impact of the fix is regarding the Comodo protecting level given to Firefox (i.e. what kind of protection still works and what not)

Thank you very much!","@Gijs your reply was much quicker then mine, I didn't see your reply because I was in the middle writing my reply, I even got a collision error while saving changes :)
Thanks for the feedback!","(In reply to nototheleft from comment #25)
> After closing down Firefox Nightly I got Comodo Firewall pop-up Alerts of Firefox Nightly trying to execute the unknown ""PingSender.exe"" executable in trying to access system resources and an Alert on ""PingSender.exe"" trying to access the internet. As a test case I kept on blocking all Alerts generated ""PingSender.exe""  to check if ""PingSender.exe"" would finally give up trying to access the resources and trying to access the internet. It did give up after many blocking Alerts, great. I've attached screenshots of those Alerts too.

That's normal because none of the executables are recognized, they're all freshly built.

> So to me your bug fix seems to work for Comodo Firewall 5.12.
> Maybe it needs some more testing from my side but first results are looking good!
> 
> I do have a question regarding the fix you've implemented in Firefox Nightly.
> Is this fix common for all Comodo Firewall versions including the most recent one (version 12)? In other words, does the most recent version of Comodo Firewall also inject dlls into the Firefox process(es) and is it blocked (by the fix you made) more or less in the same way or does the most recent version of Comodo Firewall inject dlls in a more compatible way so that it not conflicts with the Firefox process(es) or maybe the most recent version does not inject dlls at all (using another protecting scheme).

This patch will only stop the version that was crashing Firefox and older versions. New versions of the software will be unaffected.

> Also can you elaborate on, from the feedback given in comment #7 ""this will likely break whatever functionality Comodo tries to offer within Firefox"", what the impact of the fix is regarding the Comodo protecting level given to Firefox (i.e. what kind of protection still works and what not)

The DLL was probably modifying Firefox behavior in some way - possibly to block URLs and the like. That functionality won't be available with the patch in place because the DLL is blocked from loading.","Created attachment 9135665
Bug 1624336 - Block old versions of COMODO Firewall to prevent them from crashing Firefox r=aklotz","I have done some more testing of the Nightly build. Till now everything seems fine.

For your information, I started ProcessExplorer to check the loading of ""guard64.dll"" after starting Firefox 70.0.1 and after starting FirefoxNightly 76.0a1 (both were run separately, so not at the same time). I've attached some screenshots of ProcessExplorer.
As can be seen from the screenshots:
- There are two instances of ""guard64.dll"" loaded by Firefox 70.0.1 (one for the main process and one for a sub-process)
- There is only one instance of ""guard64.dll"" loaded by FirefoxNightly 76.0a1 in a sub process (by the fix the main process doesn't load it anymore)

I was wondering why the sub-process of FirefoxNightly 76.0a1 doesn't crash on the loading of  ""guard64.dll"" and if FirefoxNightly as a whole is still nicely protected by Comodo Firewall even though the main process doesn't load it?","Created attachment 9135715
70.0.1_ProcessExplorer_guard64dll_loaded_by_Firefox_Prcoess_1.jpg","Created attachment 9135716
70.0.1_ProcessExplorer_guard64dll_loaded_by_Firefox_Process_2.jpg","Created attachment 9135717
76.0a1_ProcessExplorer_guard64dll_loaded_by_FirefoxNightly_Process.jpg","Yes, we can block DLL loading both in the main process and in child processes. I think that our default policy is to block loading DLLs only where it prevents the crash, not everywhere by default.","I understand, blocking it everywhere would cause a serious security risk as there would be no or less protection from Comodo Firewall.
The ultimate solution would be to not block the DLL from loading anywhere in the process but I guess that can't be solved I'm afraid (or can it?).","Created attachment 9135827
70.0.1_76.0a1_ProcessExplorer_guard64dll_loaded_by_Firefox(Nightly)_Process_All.jpg","A small correction to the number of loaded instances of ""guard64.dll"" by Firefox 70.0.1 as reported earlier.
All processes (main and all child processes) of Firefox 70.0.1 do load ""guard64.dll"" whereas FirefoxNightly 76.0a1 only loads one instance in a child process.
Please see newly attached screenshot showing both Firefox 70.0.1 and FirefoxNightly 76.0a1 running in ProcessExplorer.
I my earlier screenshot I didn't sort ProcessExplorer Search window on Processes (but on PID) so I didn't see all running processes of Firefox 70.0.1 in the first place.

To sum it up:
- Firefox 70.0.1 has in total 5 running processes (main and childs) and has also 5 loaded instances of ""guard64.dll"" for each process one.
- FirefoxNightly 76.0a1 has in total 6 running processes (main and childs) but has only one loaded instance of ""guard64.dll"" for a child process.

I get the feeling or the impression that by the fix FirefoxNightly is very much less protected by Comodo Firewall then Firefox 70.0.1.
This lower protection is undesirable and makes FirefoxNightly more prone to potential attacks and higher serious security risks.

Is there an another way (a more clean way) to fix the crash so that Comodo Firewall 5.12 still can give the full protection to Firefox(Nightly).

Thank you.","Unfortunately not, you'll have to update that software to a newer version. That particular program is changing how Firefox behaves and it's simply incompatible with the newer versions of Firefox. That being said a firewall should work even without a browser extension so I doubt that disabling its injection process changes much with regard to that.","I understand your point of view and you're correct about that the firewall will still work.
However, Comodo Firewall is not only a plain firewall but also has a feature called Defense+ which monitors each executable (and its child processes) and other running processes what they are doing on a system (i.e. is an executable or running process allowed to access or modify certain registry keys or allowed to access certain system directories or allowed to make specific modification to files and what more...) that feature makes Comodo Firewall so powerful in protecting the whole system.
If you are interested you can read more about Defense+ here: https://help.comodo.com/topic-72-1-284-3036-General-Settings.html

I would love to upgrade the software but it comes which such an amount of other software and other features that I really don't need so I really don't like to start using it.

I don't know the ins and outs of Firefox and why suddenly after version 70.0.1 things have had to change so drastically in Firefox.
Comodo Firewall 5.12 was designed and released to run on Windows 7 and 8, unfortunately Firefox now breaks its functionality.

Anyhow, either I'll stay with 70.0.1 or upgrade or use the fix as is I don't know. There is obviously no other solution.

Thank you.","In addition to my previous comment:

- It is the Comodo Defense+ feature that is broken by the fix, not the firewall feature (maybe you already got that point). Comodo Defense+ can't monitor the main Firefox process or it's child processes (executed by itself or by Add-ons or by Extensions) any longer and as such all Firefox processes are free to make whatever changes to the system they want to. This is highly unwanted.
- Upgrading Comodo to the latest version would introduce many new (and yet unknown) bugs as it comes with plenty of other software and features. I did have a look at the Firefox bug-list regarding Comodo V8 and v10 and that doesn't make me happy (I'm not saying that Firefox alone is causing all the bugs, Comodo creates bugs too). This is also unwanted.

What if I would upgrade Comodo to v12 anyway on Windows 7?
Would I then get the full Comodo protection towards Firefox that Comodo is designed to offer to Firefox?
Would the Defense+ feature (in the latest version v12 they call the feature HIPS) fully work on Firefox or does Firefox above version 70.0.1 keep Comodo v12 HIPS out of the door (block it) as well (not by the Comodo Firewall 5.12 fix but generally speaking)?
In other words, do any Firefox versions (in particular the versions above 70.0.1) cripple any feature of the latest Comodo version v12 on Windows 7 or Windows 10?

Thanks.","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug is a regression, but please revert this change in case of error.","(In reply to nototheleft from comment #39)
> What if I would upgrade Comodo to v12 anyway on Windows 7?
> Would I then get the full Comodo protection towards Firefox that Comodo is designed to offer to Firefox?
> Would the Defense+ feature (in the latest version v12 they call the feature HIPS) fully work on Firefox or does Firefox above version 70.0.1 keep Comodo v12 HIPS out of the door (block it) as well (not by the Comodo Firewall 5.12 fix but generally speaking)?
> In other words, do any Firefox versions (in particular the versions above 70.0.1) cripple any feature of the latest Comodo version v12 on Windows 7 or Windows 10?

Firefox doesn't purposefully ""cripple"" any features from any external products. The history in bug 1590430 suggests newer versions of Comodo will have a higher chance of working correctly, but that's not a guarantee. Whether Comodo's interference will cause crashes in Firefox again, or how much of its featureset is supported in Firefox or any other browsers is pretty much up to Comodo.","I don't expect Firefox to purposefully ""cripple"" any third party features but blocking (any) third party features to prevent Firefox from crashing is in my opinion not the right way to go.

Please can you tell if currently all features (specifically HIPS) of Comodo v12 will/do work with Firefox above 70.0.1?
Else, what sense does it make to upgrade from 5.12 to 12 when the HIPS feature is still being disabled by Firefox.

Furthermore, do Firefox and Comodo work together to solve bugs like these?
Comodo's browser Dragon uses Firefox code so I expect you work together somehow.","Created attachment 9136469
74.0_ProcessExplorer_guard64dll_loaded_by_Firefox_Process_All.jpg","Created attachment 9136470
74.0_browser.launcherProcess.enabled_false.jpg",Any comments on attached screenshots perhaps???,At this point we are only blocking very old versions of COMODO software that we know cause Firefox to crash thus harming our users. Recent versions (including 12) are likely to run but nobody here can guarantee that. That's entirely up to COMODO. We have absolutely no control over that.,"To summarize this bug report:

- Firefox versions 70.0.1 and below worked perfectly well together with Comodo Firewall/Defense+ 5.12 and there were absolutely no crashes in the past. Firefox was all the time very well protected by Comodo Firewall and its Defense+ feature.
- All Firefox versions above 70.0.1 crashed immediately after startup when Comodo Firewall/Defense+ 5.12 was installed and running.
- The initial, at first sight, root cause of the startup crash was related to a Comodo DLL.
- Firefox stated that Comodo Firewall is not compatible with Firefox versions above 70.0.1 and as such causes the startup crash of those Firefox versions.
- A Firefox Nightly build 76.0a1 was made to block the offending Comodo DLL from loading into the Firefox process as a workaround to stop the startup crashes.
- The Firefox Night build 76.0a1 didn't crash at startup anymore, so the blocking seemed to work.
- However, the blocking of the offending Comodo DLL in Firefox Nightly 76.0a1 completely disabled Comodos Defense+ feature offered towards Firefox and as such Firefox and all its Add-ons and Extensions can now make whatever changes to the underlying system they want to. The Comodo Defense+ feature is crippled by blocking the offending DLL and not any longer able to Alert the user about suspicious system changes. This poses a serious security threat.
- Firefox version 74.0 was installed again together with Comodo Firewall/Defense+ 5.12 running.
- As expected Firefox 74.0 did again crash immediately at startup. 
- A configuration setting change was made in Firefox 74.0 to disable the Firefox LauncherProcess during startup.
- Very very surprisingly Firefox 74.0 now started without crashing and runs normally together with Comodo Firewall/Defense+ 5.12 running !!!!!! See the newly attached screenshots !!!!!!
- Firefox 74.0 now is, like Firefox 70.0.1, again very well protected by Comodos Defense+ feature because it now loads the offending DLL in all its processes (main and childs) without crashing.
- In Firefox versions 70.0.1 and below the LauncherProcess was all the time enabled by default but those Firefox versions did not crash !!!!!!
- It is not, as initially thought, the offending Comodo DLL that is causing the startup crash of Firefox versions 70.0.1 and above but a bug in Firefox LauncherProcess is causing the Firefox startup crash when Comodo Firewall/Defense+ 5.12 is running.

Firefox made a statement that Comodo Firewall/Defense+ 5.12 is simply not compatible with Firefox versions above 70.0.1.
Above I have proven that this statement is incorrect and just not true, it is Firefox itself that makes Comodo Firewall/Defense+ incompatible by blocking the loading of the ""offending"" DLL in the Firefox LauncherProcess executed at startup and then just let Firefox crash to make the user think it is incompatible.

Firefox policy is to block all DLL injections in an effort to improve stability, security, and privacy.
And as such cripples any third party features that injects DLLs for their needs.
In my opinion this policy is just a cover and an opportunity to build a base for a Trojan Horse.","(In reply to nototheleft from comment #47)
> In my opinion this policy is just a cover and an opportunity to build a base for a Trojan Horse.

It's really not -- though if you already believe this, I'm not sure anything I'm going to say is going to make you change your mind. You know all the source code for Firefox is public, right? If it was a trojan horse, people would notice pretty quickly.

It's useful to know that things work if you disable the launcher process. To be clear, it's Comodo's dll that causes the crash here, not Firefox ""deciding"" to crash in that case. If the launcher process breaks when this old version of Comodo injects into it, perhaps we can avoid that somehow. Though frankly, it's pretty unreasonable for applications doing perfectly legitimate things to have to make changes to make other, unmaintained, external applications that inject random executable code into their process, and for which no source code is available, happy -- and it's not clear that would even be possible.

Gabriele, is there anything in the minidump that'd allow you to see what part of the launcher process upsets Comodo and how we could make it less upset?",We're crashing deep into Microsoft DLLs. This seems to happen [here](https://searchfox.org/mozilla-central/rev/fa2df28a49883612bd7af4dacd80cdfedcccd2f6/mozglue/misc/TimeStamp_windows.cpp#517-519) when we're querying for `GetSystemTimePreciseAsFileTime()` in kernel32.dll. That's a perfectly valid call and it should simply yield NULL on the target machine because it's a function that's not available on Windows 7. This particular instance of COMODO injected a hook in Microsoft's KERNELBASE.dll and my guess is that since it's older than the method we're requesting it's breaking because it doesn't know what to do with that function. That idea is reinforced by the fact that the crash is a `NULL` pointer access.,"Is it not common practice to first check what OS is running so one can make existing system calls?
Making non-existing system calls on any OS is asking for trouble in any case.

What's the minimum OS system requirement for Firefox 74.0? I guess it should be Windows 8 then.","(In reply to nototheleft from comment #50)
> Is it not common practice to first check what OS is running so one can make existing system calls?

We're not making a system call, we're requesting the pointer to that function in a DLL. If it's not there we'll get `NULL` and we know we can't use it. That's the standard way of checking for optional functionality in Windows DLLs.

> What's the minimum OS system requirement for Firefox 74.0? I guess it should be Windows 8 then.

Still Windows 7. That particular function is only used if it is found.",Do you check for optional (non Windows 7) functionality in Windows DLLs only in the Launcher Process code?,">Do you check for optional (non Windows 7) functionality in Windows DLLs only in the Launcher Process code?

No, we definitely do this elsewhere as well. This same call for example is also being checked in the JS engine, so I guess that might crash as well due to the Comodo bug: https://searchfox.org/mozilla-central/search?q=GetSystemTimePreciseAsFileTime&path=","Mr. Toshihito

Can you please explain and clarify for what reasons and for what purposes Firefox detours ntdll!LdrLoadDll ?","Pushed by gsvelto@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/5a8b721ced71
Block old versions of COMODO Firewall to prevent them from crashing Firefox r=aklotz",https://hg.mozilla.org/mozilla-central/rev/5a8b721ced71,"(In reply to nototheleft from comment #54)
> Can you please explain and clarify for what reasons and for what purposes Firefox detours ntdll!LdrLoadDll ?

Our purpose is to collect information about DLLs which are loaded into our processes.  In my understanding, the situation where two parties try to hook the same function is not a problem.  It's even technically possible that multiple hooks co-exist.

(In reply to Gabriele Svelto [:gsvelto] from comment #49)
> We're crashing deep into Microsoft DLLs. This seems to happen [here](https://searchfox.org/mozilla-central/rev/fa2df28a49883612bd7af4dacd80cdfedcccd2f6/mozglue/misc/TimeStamp_windows.cpp#517-519) when we're querying for `GetSystemTimePreciseAsFileTime()` in kernel32.dll. That's a perfectly valid call and it should simply yield NULL on the target machine because it's a function that's not available on Windows 7. This particular instance of COMODO injected a hook in Microsoft's KERNELBASE.dll and my guess is that since it's older than the method we're requesting it's breaking because it doesn't know what to do with that function. That idea is reinforced by the fact that the crash is a `NULL` pointer access.

Gabriele, could you share the dump file with me?  I'd like to analyze it, too.  I know the chance is really slim, but there might be something we can implement to mitigate the issue, or something we can improve for similar cases.","Thank you for your feedback, really appreciate it.

To help you finding a good solution and a better fix for this bug I did some debugging and things crash at the point when Firefox detours LdrLoadDll, guard64.dll is loaded into a child process and also detours LdrLoadDll and then when a call is made to LoadLibraryW the whole thing crashes (everything happens in the Launcher Process code part).

If I have read the Firefox source code well then detouring LdrLoadDll is not thread safe (as stated by a comment in the Firefox code) and in my opinion this is what's causing the crash.

Hopefully now you are able too come up with a real good fix for this bug (not by blocking the loading of ""guard64.dll"" I mean) .

If you need more help then ask me.

Thank you.","Management,

I would like to know how you follow up on this bug.
Should this bug be reopened or a new bug be created?
Or do you leave everything as it is?

Thank you.","This bug is fixed, so there's no point in re-opening it. 

Mr. Toshihito was interested in finding out what Comodo did wrong that they later fixed, so if this leads to something actionable that removes the need for the block, he'd either follow up here or make a new bug and link it to this one. We're reaching out to Comodo to get the exact version that you observed the problem with.","Thank you for your answer.

If you like I can send you the exact version as well, I still have the official and original setup file.
You can have it verified by Comodo if you don't trust.

I would like to follow Mr. Toshihito findings or analysis. Also when a new bug is made I would like to follow that as well. Can you arrange that please? It would be interesting to know why Firefox crashes in the way I explained earlier in comment#58.

Thanks.","Sorry for not responding promptly.  I spent some time on analyzing the dump Gabriele shared with me, and debugging the latest Comodo F/W on Win10 which works fine with the latest Firefox.

(In reply to nototheleft from comment #58)
> To help you finding a good solution and a better fix for this bug I did some debugging and things crash at the point when Firefox detours LdrLoadDll, guard64.dll is loaded into a child process and also detours LdrLoadDll and then when a call is made to LoadLibraryW the whole thing crashes (everything happens in the Launcher Process code part).

Yes, and as Gabriele mentioned, the crash happened [here](https://searchfox.org/mozilla-central/rev/2cd2d511c0d94a34fb7fa3b746f54170ee759e35/mozglue/misc/TimeStamp_windows.cpp#518) when Firefox called `LdrLoadDll` to load kernel32.dll to query [`GetSystemTimePreciseAsFileTime`](https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsystemtimepreciseasfiletime).  `GetSystemTimePreciseAsFileTime` does not exist in Win7, but it can't be a problem.

Unfortunately the hook planted on `LdrLoadDll` is not captured in the minidump, so it's impossible to tell what exactly happened.

Looking at the code adjacent to the crashing point, `mov r11, imm64` is found just before the crashing instruction as below.  This means something to us because the pattern of our hook is `mov r11, imm64; jmp r11`.  Plus, the crashing instruction `add` is syntactically ok, but I think it does not mean anything but just two zero bytes.

```
00000000`6fff0d1f cc              int     3
00000000`6fff0d20 49bbc0245c3fff251400 mov r11,1425FF3F5C24C0h <---- probably jumped here from `KERNELBASE!LoadLibraryExW` via `KERNELBASE!_imp_LdrLoadDll`
00000000`6fff0d2a 0000            add     byte ptr [rax],al  <---- crash here (invalid opcode)
00000000`6fff0d2c cc              int     3
```

The latest Comodo F/W coexists with our hook.  In that case, our hook comes first, and then their hook is planted on top of ours.  Given those, my guess is in the crash case, they failed to fully hook `LdrLoadDll` because their code could not fully recognize our hook's pattern.  To prove this, we need a local repro or a full dump of the crash.

> If I have read the Firefox source code well then detouring LdrLoadDll is not thread safe (as stated by a comment in the Firefox code) and in my opinion this is what's causing the crash.

In the minidump, there was only one thread causing AV.  So at least this crash is not a threading issue.

(In reply to nototheleft from comment #61)
> Thank you for your answer.
> 
> If you like I can send you the exact version as well, I still have the official and original setup file.
> You can have it verified by Comodo if you don't trust.

Thank you for offering that.  Yes, could you please share the setup files to get a repro on our end?  I cannot guarantee that I'll find the root cause, but it would be helpful.","I know that analyzing and debugging code can take a lot of time so your late reply is no problem at all. I'm glad that you did some analyzing and debugging so far so thank you for that.

If I have some time I will try to do some more in-depth debugging and collect more info around the crash point and share it with you.

The Comodo FW 5.12 setup file size is about 70 Mb. This is too large to send it as a whole via e-mail I believe. I could split it up in ten smaller zip-parts and then send those zip-parts via e-mail to you.
I don't know whether attaching to this bug is allowed or not by you or by Comodo as this bug is publicly.
Please let me know what way you prefer to get the setup file to you.

Thanks.","(In reply to nototheleft from comment #63)
> I don't know whether attaching to this bug is allowed or not by you or by Comodo as this bug is publicly.
> Please let me know what way you prefer to get the setup file to you.

I talked with my manager.  To avoid the risk to violate a license, let me discuss about our option within the company first.  Sorry that I was in a rush.","For your information:

The Comodo FW 5.12 software was free software back in the days. Same as it is now for the latest version 12 of Comodo software.
You don't need a license key to install or run the software.

Anyhow, when you reach agreement about sending the software to you then just let me know.","Hello and to all,

I was wondering if there is any news regarding getting the Comodo FW 5.12 software for your local repro?
Will there be any follow up on this bug so that this ""guard64.dll"" gets unblocked?
I can do more debugging and share the info with you if you want but that only makes sense when Firefox is willing to work on this too.

I see in the bug list that there are daily reported crashes related to ""guard64.dll"" even for the latest version of Firefox 75.
See this link:

https://crash-stats.mozilla.org/search/?release_channel=release&signature=%3Dguard64.dll&product=Firefox&version=73.0.1&version=74.0&version=74.0.1&version=75.0&date=%3E%3D2020-02-17T00%3A00%3A00.000Z&date=%3C2020-04-19T12%3A06%3A00.000Z&_facets=install_time&_facets=version&_facets=address&_facets=moz_crash_reason&_facets=reason&_facets=build_id&_facets=platform_pretty_version&_facets=signature&_facets=useragent_locale&_sort=-date&_columns=date&_columns=signature&_columns=product&_columns=version&_columns=build_id&_columns=platform#crash-reports

How does Firefox solve these crashes? Also by just blocking the ""offending"" dll?


If there is no interest from your side to fix this crash issue (or these crash issues from the link above) in a proper way (meaning not dll blocking) then I'll use Firefox 74 and above with a disabled Launcher Process setting as long as Firefox permits to disable it (I guess it won't take long before you block this disabling as well) as this gets back the FW 5.12 Defense+ functionality towards the Firefox browser.
Maybe disabling the Launcher Process is also a recommendation for other users who totally don't understand why certain functionality - which was working correctly in older Firefox versions - suddenly doesn't work anymore by crashing Firefox. 

Maybe you should start thinking of solving all other crashes related to injected dlls in a correct and proper way instead of just blocking them or building a ""wall"" around Firefox. Building this wall decreases the user experience and confidence in Firefox and as such taking away users from using Firefox...","(In reply to nototheleft from comment #66)
> I was wondering if there is any news regarding getting the Comodo FW 5.12 software for your local repro?

It's still under discussion.  Probably there is no problem that we get the setup files from you, but we need to be very careful.

> How does Firefox solve these crashes? Also by just blocking the ""offending"" dll?

It depends on root causes, and it's even not guaranteed that we can know root causes.  If we can understand a root cause and we can fix or bypass it on our side, we're really willing to implement it, but please understand it's possible that we technically cannot bypass it.  In such a case, blocking a module is the most reasonable mitigation for us and users.  Keeping Firefox's browsing functionality is more important than Firefox's crash even though a third-party application's functionality is lost.

> If there is no interest from your side to fix this crash issue (or these crash issues from the link above) in a proper way (meaning not dll blocking) then I'll use Firefox 74 and above with a disabled Launcher Process setting as long as Firefox permits to disable it (I guess it won't take long before you block this disabling as well) as this gets back the FW 5.12 Defense+ functionality towards the Firefox browser.
>
> Maybe disabling the Launcher Process is also a recommendation for other users who totally don't understand why certain functionality - which was working correctly in older Firefox versions - suddenly doesn't work anymore by crashing Firefox. 

It's hard to say what's a proper way.  From Firefox's perspective, injecting code into our processes is not a proper way to interact with us.  It's technically possible, but we basically don't expect such interaction because we think our process is our terriotory.

If a third-party application decides to inject code in our process, we want them to very careful because we can cover only a tiny part of their fault on our end.  In this Comodo's case, it's still possible that we cannot bypass their crash at all.  If so, a proper way is that Comodo provides a fix in their product.  Actually they did in a newer version because we confirmed their latest product works good with our latest product.

Therefore, our recommendation is always to upgrade Comodo.  Probably Comodo also recommends it.  If you want to keep an old version and Comodo does not provide a patch for that version, maybe disabling the launcher process is the only solution but please understand it's not our recommendation.",we also have a policy against any such dll injections in place: https://blog.mozilla.org/addons/2017/01/24/preventing-add-ons-third-party-software-from-loading-dlls-into-firefox/,"According to this policy the latest Comodo product is going to be blocked too.

And not only Comodo, all other security suits that use DLL injection will undergo the same fate.

I need security, I don't need Firefox...

Try to change my mind otherwise I say farewell to Firefox...","(In reply to nototheleft from comment #69)
> According to this policy the latest Comodo product is going to be blocked too.

That's not correct.  [This change](https://bugzilla.mozilla.org/show_bug.cgi?id=1624336#c56) blocks guard64.dll equals to or older than 5.12.59641.2599.  As of now, the latest Comodo FW contains gurad64.dll v12.2.2.7032, which coexists in Firefox keeping its functionality.

Have you tried the latest Comodo FW recently?  I confirmed it worked, but if it's blocked on your end, there's a different problem we need to look into.

> And not only Comodo, all other security suits that use DLL injection will undergo the same fate.

Why do you think so?  We block injected DLLs only when they affect our functionality.  As described [here](https://wiki.mozilla.org/Blocklisting/DLL), we respect third-party apps as much as possible.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1646887,"Intermittent PROCESS-CRASH | Main app process exited normally | application crashed [@ MergeState::ProcessItemFromNewList(nsDisplayItem*, mozilla::Maybe<Index<MergedListUnits> > const&)]",FIXED,"**Filed by:** ccoroiu [at] mozilla.com
**Parsed log:** https://treeherder.mozilla.org/logviewer.html#?job_id=306805380&repo=autoland
**Full log:** https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/NdhOeKWmR3CjYeSm1OIH7A/runs/1/artifacts/public/logs/live_backing.log
**Reftest URL:** https://hg.mozilla.org/mozilla-central/raw-file/tip/layout/tools/reftest/reftest-analyzer.xhtml#logurl=https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/NdhOeKWmR3CjYeSm1OIH7A/runs/1/artifacts/public/logs/live_backing.log&only_show_unexpected=1

---

[task 2020-06-18T17:27:17.641Z] 17:27:17     INFO - TEST-OK | accessible/tests/browser/bounds/browser_test_resolution.js | took 2684ms

[task 2020-06-18T17:27:19.031Z] 17:27:19     INFO - GECKO(4260) | [Child 4321: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7fc6be7229a0) [pid = 4321] [serial = 20] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.108Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 9 (0x7f7acd79c000) [pid = 4424] [serial = 34] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.110Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 8 (0x7f7acd73e800) [pid = 4424] [serial = 37] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.111Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 7 (0x7f7acd79b400) [pid = 4424] [serial = 26] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.112Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 6 (0x7f7ad4f63000) [pid = 4424] [serial = 32] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.113Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 5 (0x7f7acf8332b0) [pid = 4424] [serial = 33] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%0A%3Cp%20id%3D'p1'%20style%3D'font-family%3A%20monospace%3B'%3ETilimilitryamdiya%3C%2Fp%3E%0A%3Cp%20id%3D%22p2%22%3Epara%202%3C%2Fp%3E%0A%3Cbutton%20id%3D%22b1%22%3EHello%3C%2Fbutton%3E%0A%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.113Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 4 (0x7f7acf8329a0) [pid = 4424] [serial = 30] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.114Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 3 (0x7f7acf832260) [pid = 4424] [serial = 24] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.162Z] 17:27:19     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7f7ad504e400) [pid = 4424] [serial = 35] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%0A%3Cp%20id%3D'p1'%20style%3D'font-family%3A%20monospace%3B'%3ETilimilitryamdiya%3C%2Fp%3E%0A%3Cp%20id%3D%22p2%22%3Epara%202%3C%2Fp%3E%0A%3Cbutton%20id%3D%22b1%22%3EHello%3C%2Fbutton%3E%0A%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.179Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 7 (0x7f19bfaec000) [pid = 4453] [serial = 38] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.181Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 6 (0x7f19bfb4a800) [pid = 4453] [serial = 39] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Cbody%20id%3D%22default-iframe-body-id%22%3E%0A%3Cp%20id%3D'p1'%20style%3D'font-family%3A%20monospace%3B'%3ETilimilitryamdiya%3C%2Fp%3E%0A%3Cp%20id%3D%22p2%22%3Epara%202%3C%2Fp%3E%0A%3Cbutton%20id%3D%22b1%22%3EHello%3C%2Fbutton%3E%0A%3C%2Fbody%3E]
[task 2020-06-18T17:27:19.182Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 5 (0x7f19b8788400) [pid = 4453] [serial = 35] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.184Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 4 (0x7f19b871a7d0) [pid = 4453] [serial = 37] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Cbody%20id%3D%22default-iframe-body-id%22%3E%0A%3Cp%20id%3D'p1'%20style%3D'font-family%3A%20monospace%3B'%3ETilimilitryamdiya%3C%2Fp%3E%0A%3Cp%20id%3D%22p2%22%3Epara%202%3C%2Fp%3E%0A%3Cbutton%20id%3D%22b1%22%3EHello%3C%2Fbutton%3E%0A%3C%2Fbody%3E]
[task 2020-06-18T17:27:19.186Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 3 (0x7f19b871a090) [pid = 4453] [serial = 28] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.186Z] 17:27:19     INFO - GECKO(4260) | [Child 4321: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7fc6be722b70) [pid = 4321] [serial = 26] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.187Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7f19b8794800) [pid = 4453] [serial = 30] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.308Z] 17:27:19     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7f19b871ab70) [pid = 4453] [serial = 34] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:19.672Z] 17:27:19     INFO - GECKO(4260) | [Child 4686: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7f86e20b0800) [pid = 4686] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:19.854Z] 17:27:19     INFO - GECKO(4260) | [Child 4686: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7f86e782fc00 == 0 [pid = 4686] [id = {66bc8e96-9e25-4fc4-a3c4-af00370c3326}] [url = about:newtab]
[task 2020-06-18T17:27:19.856Z] 17:27:19     INFO - GECKO(4260) | [Child 4686: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7f86fd693520) [pid = 4686] [serial = 1] [outer = (nil)] [url = about:newtab]
[task 2020-06-18T17:27:21.100Z] 17:27:21     INFO - GECKO(4260) | [Child 4453: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7f19bfabcc00) [pid = 4453] [serial = 36] [outer = (nil)] [url = data:text/html;charset=utf-8,%3Chtml%3E%0A%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Ctitle%3EAccessibility%20Test%3C%2Ftitle%3E%0A%20%20%20%20%20%20%3C%2Fhead%3E%0A%20%20%20%20%20%20%3Cbody%20id%3D%22body%22%3E%3Ciframe%20id%3D%22default-iframe-id%22%20src%3D%22data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%253Cbody%2520id%253D%2522default-iframe-body-id%2522%253E%250A%253Cp%2520id%253D'p1'%2520style%253D'font-family%253A%2520monospace%253B'%253ETilimilitryamdiya%253C%252Fp%253E%250A%253Cp%2520id%253D%2522p2%2522%253Epara%25202%253C%252Fp%253E%250A%253Cbutton%2520id%253D%2522b1%2522%253EHello%253C%252Fbutton%253E%250A%253C%252Fbody%253E%22%2F%3E%3C%2Fbody%3E%0A%20%20%20%20%3C%2Fhtml%3E]
[task 2020-06-18T17:27:21.257Z] 17:27:21     INFO - GECKO(4260) | [Child 4321: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7fc6c59c3c00) [pid = 4321] [serial = 28] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:21.637Z] 17:27:21     INFO - GECKO(4260) | [Child 4686: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7f86e7855000) [pid = 4686] [serial = 3] [outer = (nil)] [url = about:newtab]
[task 2020-06-18T17:27:23.020Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4507
[task 2020-06-18T17:27:23.082Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4610
[task 2020-06-18T17:27:23.326Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4523
[task 2020-06-18T17:27:23.329Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4588
[task 2020-06-18T17:27:23.331Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4480
[task 2020-06-18T17:27:23.367Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4453
[task 2020-06-18T17:27:23.424Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4424
[task 2020-06-18T17:27:23.486Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4321
[task 2020-06-18T17:27:23.865Z] 17:27:23     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4686
[task 2020-06-18T17:27:24.144Z] 17:27:24     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4338
[task 2020-06-18T17:27:24.422Z] 17:27:24     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 11 (0x7facd1b04c00) [pid = 4260] [serial = 6] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:27.493Z] 17:27:27     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 10 (0x7faccd1ad800) [pid = 4260] [serial = 12] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:28.034Z] 17:27:28     INFO - GECKO(4260) | Completed ShutdownLeaks collections in process 4260
[task 2020-06-18T17:27:28.035Z] 17:27:28     INFO - TEST-START | Shutdown
[task 2020-06-18T17:27:28.036Z] 17:27:28     INFO - Browser Chrome Test Summary
[task 2020-06-18T17:27:28.038Z] 17:27:28     INFO - Passed:  1350
[task 2020-06-18T17:27:28.039Z] 17:27:28     INFO - Failed:  0
[task 2020-06-18T17:27:28.040Z] 17:27:28     INFO - Todo:    0
[task 2020-06-18T17:27:28.041Z] 17:27:28     INFO - Mode:    e10s
[task 2020-06-18T17:27:28.042Z] 17:27:28     INFO - *** End BrowserChrome Test Results ***
[task 2020-06-18T17:27:28.272Z] 17:27:28     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7facd38f4c00 == 4 [pid = 4260] [id = {fcc1fe0e-91fa-460d-8221-cdb4767cf3cc}] [url = chrome://extensions/content/dummy.xhtml]
[task 2020-06-18T17:27:28.583Z] 17:27:28     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7faccb11d000 == 3 [pid = 4260] [id = {6f30e88f-c715-4a9d-971e-869666d5a8ad}] [url = chrome://mochikit/content/browser-harness.xhtml]
[task 2020-06-18T17:27:28.585Z] 17:27:28     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7facd2259400 == 2 [pid = 4260] [id = {1e23061e-1bbb-4757-b3ef-bfd2da281324}] [url = about:blank]
[task 2020-06-18T17:27:28.586Z] 17:27:28     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7facdfd4c800 == 1 [pid = 4260] [id = {76c0bcaa-7f73-49c8-838c-dea1d2728924}] [url = resource://gre-resources/hiddenWindow.html]
[task 2020-06-18T17:27:28.593Z] 17:27:28     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:28.599Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fa604b50c00 == 3 [pid = 4338] [id = {7dc78dec-4078-4e67-8726-1fd36934219a}] [url = moz-extension://198e037a-1ac0-476b-9c16-cf7021e852bf/_generated_background_page.html]
[task 2020-06-18T17:27:28.600Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fa604b53000 == 2 [pid = 4338] [id = {83ec4d6d-af72-40db-b9b0-7697aab63f3e}] [url = moz-extension://f9b9c710-0015-4b9b-a208-283854ac3888/_generated_background_page.html]
[task 2020-06-18T17:27:28.601Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fa604b4e800 == 1 [pid = 4338] [id = {76daf9da-49c1-4e6a-b076-afc7e733e4ac}] [url = moz-extension://70a93769-38d8-46a2-b4b5-05bfc451f32b/_generated_background_page.html]
[task 2020-06-18T17:27:28.602Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fa5fe8adc00 == 0 [pid = 4338] [id = {7b37f1f3-6fa7-44d1-9b20-9d2306c50e6f}] [url = moz-extension://c20daf53-ce9d-4117-8e77-efc6b0ad196e/_generated_background_page.html]
[task 2020-06-18T17:27:28.623Z] 17:27:28     INFO - GECKO(4260) | [Parent 4260, Main Thread] WARNING: NS_ENSURE_SUCCESS(rv, rv) failed with result 0x80040111 (NS_ERROR_NOT_AVAILABLE): file /builds/worker/checkouts/gecko/netwerk/cache/nsApplicationCacheService.cpp, line 161
[task 2020-06-18T17:27:28.982Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 7 (0x7fa61a893a90) [pid = 4338] [serial = 7] [outer = (nil)] [url = moz-extension://198e037a-1ac0-476b-9c16-cf7021e852bf/_generated_background_page.html]
[task 2020-06-18T17:27:28.983Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 6 (0x7fa61a8938c0) [pid = 4338] [serial = 5] [outer = (nil)] [url = moz-extension://70a93769-38d8-46a2-b4b5-05bfc451f32b/_generated_background_page.html]
[task 2020-06-18T17:27:28.985Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 5 (0x7fa61a893c60) [pid = 4338] [serial = 9] [outer = (nil)] [url = moz-extension://f9b9c710-0015-4b9b-a208-283854ac3888/_generated_background_page.html]
[task 2020-06-18T17:27:28.986Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 4 (0x7fa61a893520) [pid = 4338] [serial = 1] [outer = (nil)] [url = moz-extension://c20daf53-ce9d-4117-8e77-efc6b0ad196e/_generated_background_page.html]
[task 2020-06-18T17:27:28.987Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 3 (0x7fa5fe84b000) [pid = 4338] [serial = 11] [outer = (nil)] [url = moz-extension://c20daf53-ce9d-4117-8e77-efc6b0ad196e/_generated_background_page.html]
[task 2020-06-18T17:27:28.988Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7fa5ff387000) [pid = 4338] [serial = 13] [outer = (nil)] [url = moz-extension://70a93769-38d8-46a2-b4b5-05bfc451f32b/_generated_background_page.html]
[task 2020-06-18T17:27:28.989Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7fa5ff38bc00) [pid = 4338] [serial = 15] [outer = (nil)] [url = moz-extension://f9b9c710-0015-4b9b-a208-283854ac3888/_generated_background_page.html]
[task 2020-06-18T17:27:28.990Z] 17:27:28     INFO - GECKO(4260) | [Child 4338: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7fa5ff389c00) [pid = 4338] [serial = 14] [outer = (nil)] [url = moz-extension://198e037a-1ac0-476b-9c16-cf7021e852bf/_generated_background_page.html]
[task 2020-06-18T17:27:29.019Z] 17:27:29     INFO - GECKO(4260) | [Child 4338, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.463Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.493Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.498Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.560Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.563Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.565Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.566Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.567Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.569Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.573Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.574Z] 17:27:29     INFO - GECKO(4260) | ###!!! [Parent][RunMessage] Error: Channel closing: too late to send/recv, messages will be lost
[task 2020-06-18T17:27:29.656Z] 17:27:29     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7facd5a4ec00 == 0 [pid = 4260] [id = {7d2b7908-5e04-438b-9ddf-2351e365f926}] [url = chrome://browser/content/browser.xhtml]
[task 2020-06-18T17:27:29.858Z] 17:27:29     INFO - GECKO(4260) | [Child 4507, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.860Z] 17:27:29     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7f7acd73dc00 == 0 [pid = 4424] [id = {b7ebe7a1-d515-4be4-ad03-6c6efc261409}] [url = about:blank]
[task 2020-06-18T17:27:29.877Z] 17:27:29     INFO - GECKO(4260) | [Child 4610, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.893Z] 17:27:29     INFO - GECKO(4260) | [Child 4480, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.930Z] 17:27:29     INFO - GECKO(4260) | [Child 4321, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.932Z] 17:27:29     INFO - GECKO(4260) | [Child 4588, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.941Z] 17:27:29     INFO - GECKO(4260) | [Child 4453, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:29.945Z] 17:27:29     INFO - GECKO(4260) | [Child 4523, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:30.047Z] 17:27:30     INFO - GECKO(4260) | [Child 4686, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:30.109Z] 17:27:30     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7f7acf832430) [pid = 4424] [serial = 36] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:30.111Z] 17:27:30     INFO - GECKO(4260) | [Child 4424: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7f7acedcdc00) [pid = 4424] [serial = 38] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:30.153Z] 17:27:30     INFO - GECKO(4260) | [Child 4424, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:30.332Z] 17:27:30     INFO - GECKO(4260) | 1592501250326	Marionette	TRACE	Received observer notification xpcom-will-shutdown
[task 2020-06-18T17:27:30.333Z] 17:27:30     INFO - GECKO(4260) | 1592501250326	Marionette	INFO	Stopped listening on port 2828
[task 2020-06-18T17:27:30.333Z] 17:27:30     INFO - GECKO(4260) | 1592501250327	Marionette	DEBUG	Marionette stopped listening
[task 2020-06-18T17:27:30.334Z] 17:27:30     INFO - GECKO(4260) | [2020-06-18T17:27:30Z WARN  xulstore::persist] tried to remove key that isn't in the store
[task 2020-06-18T17:27:30.334Z] 17:27:30     INFO - GECKO(4260) | [2020-06-18T17:27:30Z WARN  xulstore::persist] tried to remove key that isn't in the store
[task 2020-06-18T17:27:30.402Z] 17:27:30     INFO - GECKO(4260) | [2020-06-18T17:27:30Z ERROR xulstore::persist] removeDocument error: unavailable
[task 2020-06-18T17:27:30.458Z] 17:27:30     INFO - GECKO(4260) | [Parent 4260, Main Thread] WARNING: NS_ENSURE_SUCCESS(rv, rv) failed with result 0x80004005 (NS_ERROR_FAILURE): file /builds/worker/checkouts/gecko/js/xpconnect/loader/mozJSComponentLoader.cpp, line 227
[task 2020-06-18T17:27:30.459Z] 17:27:30     INFO - GECKO(4260) | [Parent 4260, Main Thread] WARNING: NS_ENSURE_SUCCESS(rv, rv) failed with result 0x80004005 (NS_ERROR_FAILURE): file /builds/worker/checkouts/gecko/js/xpconnect/loader/mozJSComponentLoader.cpp, line 254
[task 2020-06-18T17:27:31.328Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 9 (0x7facd5a51400) [pid = 4260] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:31.329Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 8 (0x7facf6597180) [pid = 4260] [serial = 1] [outer = (nil)] [url = chrome://browser/content/browser.xhtml]
[task 2020-06-18T17:27:31.330Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 7 (0x7facd7583a40) [pid = 4260] [serial = 10] [outer = (nil)] [url = chrome://mochikit/content/browser-harness.xhtml]
[task 2020-06-18T17:27:31.330Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 6 (0x7faccb119c00) [pid = 4260] [serial = 11] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:31.331Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 5 (0x7facd1b06400) [pid = 4260] [serial = 5] [outer = (nil)] [url = chrome://extensions/content/dummy.xhtml]
[task 2020-06-18T17:27:31.332Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 4 (0x7facf6597a90) [pid = 4260] [serial = 3] [outer = (nil)] [url = chrome://extensions/content/dummy.xhtml]
[task 2020-06-18T17:27:31.333Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 3 (0x7facf6597c60) [pid = 4260] [serial = 4] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:31.333Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7faccc188800) [pid = 4260] [serial = 13] [outer = (nil)] [url = about:blank]
[task 2020-06-18T17:27:31.334Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7facd75836a0) [pid = 4260] [serial = 7] [outer = (nil)] [url = resource://gre-resources/hiddenWindow.html]
[task 2020-06-18T17:27:31.336Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7facd1b04800) [pid = 4260] [serial = 9] [outer = (nil)] [url = resource://gre-resources/hiddenWindow.html]
[task 2020-06-18T17:27:31.373Z] 17:27:31     INFO - GECKO(4260) | [Parent 4260, Main Thread] WARNING: Extra shutdown CC: 'i < NORMAL_SHUTDOWN_COLLECTIONS', file /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp, line 3359
[task 2020-06-18T17:27:31.459Z] 17:27:31     INFO - TEST-INFO | Main app process: exit 0
[task 2020-06-18T17:27:31.460Z] 17:27:31     INFO - TEST-INFO | Confirming we saw 54 DOCSHELL created and 53 destroyed log strings.
[task 2020-06-18T17:27:31.461Z] 17:27:31     INFO - TEST-INFO | Confirming we saw 158 DOMWINDOW created and 156 destroyed log strings.
[task 2020-06-18T17:27:31.462Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.462Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.463Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.464Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.465Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.465Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.466Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.467Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.467Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.468Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.468Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.469Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.470Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.470Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.471Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.471Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.472Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.473Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.473Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden window(s)
[task 2020-06-18T17:27:31.474Z] 17:27:31     INFO - TEST-INFO | accessible/tests/browser/bounds/browser_test_resolution.js | This test created 1 hidden docshell(s)
[task 2020-06-18T17:27:31.474Z] 17:27:31     INFO - runtests.py | Application ran for: 0:00:51.641967
[task 2020-06-18T17:27:31.476Z] 17:27:31     INFO - zombiecheck | Reading PID log: /tmp/tmppwROdypidlog
[task 2020-06-18T17:27:31.476Z] 17:27:31     INFO - ==> process 4260 launched child process 4280
[task 2020-06-18T17:27:31.477Z] 17:27:31     INFO - ==> process 4260 launched child process 4321
[task 2020-06-18T17:27:31.478Z] 17:27:31     INFO - ==> process 4260 launched child process 4338
[task 2020-06-18T17:27:31.478Z] 17:27:31     INFO - ==> process 4260 launched child process 4399
[task 2020-06-18T17:27:31.479Z] 17:27:31     INFO - ==> process 4260 launched child process 4424
[task 2020-06-18T17:27:31.479Z] 17:27:31     INFO - ==> process 4260 launched child process 4453
[task 2020-06-18T17:27:31.480Z] 17:27:31     INFO - ==> process 4260 launched child process 4480
[task 2020-06-18T17:27:31.481Z] 17:27:31     INFO - ==> process 4260 launched child process 4507
[task 2020-06-18T17:27:31.481Z] 17:27:31     INFO - ==> process 4260 launched child process 4523
[task 2020-06-18T17:27:3",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1617796,Shutdown Crash in [@ ldap_abandon_ext] with Mac,FIXED,"#7 crash for Macs for 68.5.0.  In the past 6 months there are not crashes prior to 68.3.0, so regression?  Further, the earliest non-release crash is 71.0b1? buildid  20191113091023  bp-f4eae0cb-736f-43a5-af3e-b1e720191128
https://crash-stats.mozilla.com/signature/?product=Thunderbird&signature=ldap_abandon_ext&date=%3E%3D2019-08-25T03%3A02%3A00.000Z&date=%3C2020-02-25T03%3A02%3A00.000Z#graphs

This bug is for crash report bp-a72338e5-8aaa-456e-8ba9-4fa130200225. 75.0a1
```
Top 10 frames of crashing thread:

0 libldap60.dylib ldap_abandon_ext comm/ldap/c-sdk/libraries/libldap/abandon.c:96
1 XUL XUL@0x96f0 
2 XUL XUL@0x447d9e 
3 XUL XUL@0x44b558 
4 XUL XUL@0x54ced5 
5 XUL XUL@0x54dc5c 
6 XUL XUL@0x447d9e 
7 XUL XUL@0x44b558 
8 XUL XUL@0xa07cf3 
9 XUL XUL@0x9c0655 
```
This happened on shutdown, after I had attempted to delete the Mac OSX Address Book, which resulted in the following in the Error Console.

 NS_ERROR_UNEXPECTED: Unexpected error'Unexpected error' when calling method: [nsIAbManager::deleteAddressBook] abCommon.js:372
21:49:42.542
An error occurred executing the button_delete command: [Exception... ""Unexpected error'Unexpected error' when calling method: [nsIAbManager::deleteAddressBook]""  nsresult: ""0x8000ffff (NS_ERROR_UNEXPECTED)""  location: ""JS frame :: chrome://messenger/content/addressbook/abCommon.js :: AbDeleteDirectory :: line 372""  data: no] globalOverlay.js:104 

Whether this triggered the crash remains to be seen. I'll try to reproduce.

For good measure - bp-ae11c080-2fc2-4014-b4b5-5fcdb0200225 68.5.0","I wonder if bp-f81efff2-478a-41e4-92e2-119a10200224 has the same cause.  I hit this after doing search a couple times against All Address Books, then selecting a couple other address books, but not shutting down.
 XUL@0x2fbf435 | XUL@0x162036e | XUL@0x2c0a8b7 | XUL@0x2c0ab0c | XUL@0x3f14f7c | XUL@0x3e9fadb | XUL@0x3ea6537 | XUL@0x3ed790c | XUL@0x3ed4825 | XUL@0x3ed7449 | XUL@0x3ed4ddc | XUL@0x2ff876c | XUL@0x2fd1c50 | XUL@0x2fd5b5e | XUL@0x2fbec34 | XUL@0x2fda4c...","THere is also Mac crash and linux crash  ldap_memcache_abandon bp-67a5fa4c-0a99-4471-966f-0b6e10200328

Related to bug 1625677 ?  
Crash in [@ md_UnlockAndPostNotifies] (nss) via ldap_msgdelete (ldap60.dll)","https://searchfox.org/comm-central/rev/1e97b3c1f2224fbbf7c5479e2ec9f906d1949132/ldap/c-sdk/libraries/libldap/abandon.c#96
I have no idea.","Let's assume they are all shutdown crashes, and not so critical :)","I tried testing bug 1543183 with 76 beta and twice got the crash signature for this bug bp-3388ea5e-dff4-44ba-9491-332d80200504  Based solely on that I'd say this might be a duplicate of 1543183. It also fits with Bug 1543183's crash signature not having Mac crashes.  

Also, like bug 1543183, the crash rate for ldap_abandon_ext has increased since mid-March https://crash-stats.mozilla.org/signature/?signature=ldap_abandon_ext&date=%3E%3D2020-02-05T02%3A05%3A00.000Z&date=%3C2020-05-05T02%3A05%3A00.000Z#graphs","(In reply to Wayne Mery (:wsmwk) from comment #5)
> I tried testing bug 1543183 with 76 beta and twice got the crash signature for this bug bp-3388ea5e-dff4-44ba-9491-332d80200504  Based solely on that I'd say this might be a duplicate of 1543183. It also fits with Bug 1543183's crash signature not having Mac crashes.

I'm cautiously optimistic that it's the same issue as Bug 1625677 - after working on that one, I can see that the crash point on this one looks pretty similar. So I'm hoping the patch there will clear up both...","(In reply to Ben Campbell from comment #6)
> ...
> I'm cautiously optimistic that it's the same issue as Bug 1625677 - after working on that one, I can see that the crash point on this one looks pretty similar. So I'm hoping the patch there will clear up both...

As noted in bug 1625677, its uplift to 68.9.0 may also have had in impact on bug 1617786's ldap_memcache_abandon signature [1].  And it certainly impacted version 78.
68.3.1	4
68.4.1	2
68.5.0	5
68.6.0	6
68.8.0	6
68.8.1	33
68.9.0	2
68.10.0	5
68.11.0	2
78.3.1	1
78.4.0	1
[1] https://crash-stats.mozilla.org/signature/?signature=ldap_memcache_abandon&date=%3E%3D2020-06-05T16%3A22%3A00.000Z&date=%3C2020-12-05T16%3A22%3A00.000Z#summary",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1609668,Crash during download via ServiceWorker,FIXED,"User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36

Steps to reproduce:

Go to https://stat-info.cz/firefox-sw-readablestream.html and click Download button.


Actual results:

In background the page navigates to URL handled by ServiceWorker. SW responds with ReadableStream which is fetching data chunk by chunk (16MB) and download of 50GB file is initiated.

After downloading of 12-16GB tab crashes on my Mac. I have no problem to complete the download on Linux/Windows.

Unfortunately no crash report is generated but here are crash reports from another site which uses this technique for downloading:
https://crash-stats.mozilla.org/report/index/f023d407-4b56-4f59-8b12-5401b0200115
https://crash-stats.mozilla.org/report/index/abad85cc-6872-4bb5-87ad-ca10d0200115



Expected results:

The download should be completed without any crash.","Alternative steps to reproduce this issue:

1) Open https://mab.to/oOr1opalDOu0N
2) Right click on folder ""01_music ~ 2020-01-17"" and click ""Download as a ZIP archive""
3) Select location where to save the ~ 1.38GB file
4) If download is successful (no crash) click ""Close"" button in the left bottom corner and repeat from 2)

For me the tab crashed 4 times of 10 download attempts. Here are the crash reports:
https://crash-stats.mozilla.org/report/index/ca0f9218-f071-446c-9845-cd5500200117
https://crash-stats.mozilla.org/report/index/42086aa3-754c-400d-bb32-4d7d50200117
https://crash-stats.mozilla.org/report/index/5bc2db56-1f36-42e8-9b6c-76c380200117
https://crash-stats.mozilla.org/report/index/41ad6545-993f-4ff4-b48f-784940200117","Hi,

I tried reproducing the crash on my end but I'm able to download both files provided. I tried on Firefox Nightly 74.0a1 (2020-01-28) (64-bit) on macOS  10.14.

Indeed it's downloading chunk by chunk (16MB) for a download of 50GB file. It took several hours but it finally finished downloading successfully. FF didn't crash but I'm unable to open file or extract what's inside.

When trying the alternative steps within https://mab.to/oOr1opalDOu0N link provided, I managed to download the file without inconveniences as well.

I'm going to set a component so that the devs can take a look at the crash reports provided.

Does this issue occur with a fresh profile? You can find the steps here: https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles?redirectlocale=en-US&redirectslug=Managing-profiles#w_starting-the-profile-manager

Can you please download Firefox Nightly from here: https://nightly.mozilla.org/ and retest the problem and see if the issue still occurs there as well?

 

Best,
Clara","I use a fresh profile on the current stable Firefox 72.0.2 to reproduce this issue.

As you recommended I tried the Nightly 74.0a1 several times (hundreds of GB downloaded) and it didn't crash for me either.","The priority flag is not set for this bug.
:gsvelto, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","Martin, can you confirm that this issue is not happening for you anymore as per comment 3? I've looked at the crashes in comment 0 and in comment 1 but they point to at least two different causes, one of which (illegal instruction executed) is really odd.",I tried the current stable Firefox 73.0 and it crashed. See report here https://crash-stats.mozilla.org/report/index/51cc0b4b-8340-410f-85df-ed5710200213 . I will try beta and nightly versions later.,"Thanks Martin, the cause for that crash report is even different compared to the previous ones. I suspect there might be a problem with your machine and since it only shows up when downloading very large files it might be faulty memory. Could you run a diagnostic on your Mac's memory? You can use [memtest86](https://www.memtest86.com/) (which requires booting from an external USB stick) or macOS memory diagnostic tool (see [here](https://www.makeuseof.com/tag/check-memory-mac/) on how to launch it, under ""Check Your Memory Using Apple Diagnostics"" paragraph). memtest86 is preferable as it gives very detailed results but I never ran it on a Mac before so I don't know if it works there.",P4 since we couldn't confirm this yet.,"Since 81 this test is causing crashes even in Windows.

https://crash-stats.mozilla.org/report/index/2ef3d66f-0605-49bd-95d4-68cf90201002
https://crash-stats.mozilla.org/report/index/8d59ed91-d168-4db1-8f09-871b40201002
https://crash-stats.mozilla.org/report/index/28361a46-4fa7-49cf-92e0-ad9ac0201002

I ran the memtest86 and there were no issues with my memory.","Thanks, this is definitely actionable. I'll confirm the bug and attach the crash signature.","We're statically allocating a [32 KiB buffer on the stack](https://hg.mozilla.org/releases/mozilla-release/annotate/080f865dcb5a2427138f686afa8e72ba81936743/ipc/glue/IPCStreamSource.cpp#l183) and this seems to be causing stack overflows at least on Windows, but I suppose the issue affects all platforms.","bp-8d59ed91-d168-4db1-8f09-871b40201002 shows that there's some recursion making the problem worse: 7 activations of `DoRead` on the stack, including the one that overflowed.  I looked at a disassembly and there don't seem to be any other functions involved in that recursion that have large frame sizes, so it should be enough to move that one allocation to the heap.","Created attachment 9179764
Bug 1609668 - Move 32k buffer in IPCStreamSource::DoRead to the heap to avoid stack overflow.","Pushed by jedavis@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/19e5e9a8e377
Move 32k buffer in IPCStreamSource::DoRead to the heap to avoid stack overflow. r=asuth",I will test the change using nightly build. Is there any chance that this change will be backported to the current stable/beta version?,https://hg.mozilla.org/mozilla-central/rev/19e5e9a8e377,"Martin, could you please verify that the bug is fixed on Firefox 83 Beta 2 (https://archive.mozilla.org/pub/firefox/candidates/83.0b2-candidates/build1/)?",I have done many tests using nightly or the latest beta and I can confirm that the bug is fixed. Is there any chance that this change will be backported to the current stable version?,"Thank you, Martin! 
I will set the ""firefox83"" flag to verified.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1617774,"Untranslated string ""Submit All"" in about:crashes",FIXED,"Created attachment 9128670
Firefox (Αναφορές κατάρρευσης) - Αντίγραφο.jpg

User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0

Steps to reproduce:

Just opened ""about:crashes""...


Actual results:

The button displays <Submit All> as for the Greek localized version I currently use.


Expected results:

The button should display <Υποβολή Όλων> (or something similar to my language:GR/EL) though... -thx","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0
20200221211950

That string was updated 4 days ago:
https://pontoon.mozilla.org/el/firefox/all-resources/?string=206703

I started the latest en-US beta, switched the display language to Greek, then used the Inspector tool on about:crashes (because I have no unsubmitted crash reports). It's fixed:
`<button id=""submitAllUnsubmittedReports"" class=""submit-button wide-button"" data-l10n-id=""submit-all-button-label"">Υποβολή όλων</button>`","Thanks for reporting the bug. 

Bugs for incomplete localizations are normally closed as INVALID, since the work is managed by community. If you want to contribute, please head to Pontoon, and feel free to reach out if you have questions. I'm sure the Greek localizers will be happy to get help.","Hello & thank you both for your quick replies!
Well, to be honest, the *Pontoon* community was not to my knowledge at all (till you both informed me - thanx & sorry, my bad)...

So, just headed there and also suggested an update to the affected string [in order for the translation to match the original capitals-->Submit **A**ll].
Thanks again, and keep up the good work you guys :-)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1616790,Perma macOS jetstream2 runner.py | application crashed [@ mozilla::ipc::DuplicateDescriptor(mozilla::ipc::TransportDescriptor const&)],FIXED,"**Filed by:** archaeopteryx [at] coole-files.de
**Parsed log:** https://treeherder.mozilla.org/logviewer.html#?job_id=289509418&repo=mozilla-central
**Full log:** https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/cwcfVCJcQLa2LwgeOsLvoA/runs/0/artifacts/public/logs/live_backing.log

---

[task 2020-02-19T11:53:34.851Z] 11:53:34     INFO -  Application command: /Users/cltbld/tasks/task_1582113128/build/application/Firefox Nightly.app/Contents/MacOS/firefox -foreground -profile /var/folders/__/56y4sw851tv0348xrl89s9qh000017/T/tmp_A4kN7
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] Attaching event listener successful!""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] starting raptorRunner""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] test name is: raptor-jetstream2-firefox""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] test settings url is: http://127.0.0.1:50148/json/raptor-jetstream2-firefox.json""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] raptor runner.js is loaded!""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:53:37.191Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] raptor runner.js is loaded!""
[task 2020-02-19T11:53:37.216Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] testing on Firefox 75.0a1 20200219095352""
[task 2020-02-19T11:53:37.216Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] getting test settings from control server""
[task 2020-02-19T11:53:37.375Z] 11:53:37     INFO -  raptor-control-server Info: received webext_status: raptor runner.js is loaded!
[task 2020-02-19T11:53:37.398Z] 11:53:37     INFO -  raptor-control-server Info: reading test settings from json/raptor-jetstream2-firefox.json
[task 2020-02-19T11:53:37.399Z] 11:53:37     INFO -  raptor-control-server Info: sent test settings to webext runner
[task 2020-02-19T11:53:37.414Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:53:37.414Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] {\""raptor-options\"": {\""expected_browser_cycles\"": 1, \""subtest_unit\"": \""ms\"", \""alert_threshold\"": 2.0, \""type\"": \""benchmark\"", \""page_cycles\"": 4, \""subtest_lower_is_better\"": true, \""test_url\"": \""http://<host>:<port>/JetStream2/index.html?raptor\"", \""page_timeout\"": 2000000, \""host\"": \""127.0.0.1\"", \""cold\"": false, \""lower_is_better\"": true, \""unit\"": \""ms\""}}""
[task 2020-02-19T11:53:37.414Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] http://127.0.0.1:50149/JetStream2/index.html?raptor""
[task 2020-02-19T11:53:37.419Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] using page timeout: 2000000ms""
[task 2020-02-19T11:53:37.474Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] wrote settings to ext local storage""
[task 2020-02-19T11:53:37.474Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] benchmark test start""
[task 2020-02-19T11:53:37.474Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] * pausing 30 seconds to let browser settle... *""
[task 2020-02-19T11:53:37.474Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:53:37.474Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] * pausing 30 seconds to let browser settle... *""
[task 2020-02-19T11:53:37.525Z] 11:53:37     INFO -  raptor-control-server Info: received webext_status: * pausing 30 seconds to let browser settle... *
[task 2020-02-19T11:53:37.575Z] 11:53:37     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:07.525Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] running 4 pagecycles of http://127.0.0.1:50149/JetStream2/index.html?raptor""
[task 2020-02-19T11:54:07.525Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:54:07.525Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] running 4 pagecycles of http://127.0.0.1:50149/JetStream2/index.html?raptor""
[task 2020-02-19T11:54:07.552Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] opened new empty tab: 2""
[task 2020-02-19T11:54:07.552Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:54:07.552Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] opened new empty tab: 2""
[task 2020-02-19T11:54:07.585Z] 11:54:07     INFO -  raptor-control-server Info: received webext_status: running 4 pagecycles of http://127.0.0.1:50149/JetStream2/index.html?raptor
[task 2020-02-19T11:54:07.585Z] 11:54:07     INFO -  raptor-control-server Info: received webext_status: opened new empty tab: 2
[task 2020-02-19T11:54:07.598Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:07.598Z] 11:54:07     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:08.596Z] 11:54:08     INFO -  raptor-control-server Info: received webext_status: begin pagecycle 1
[task 2020-02-19T11:54:08.622Z] 11:54:08     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] begin pagecycle 1""
[task 2020-02-19T11:54:08.622Z] 11:54:08     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:54:08.622Z] 11:54:08     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] begin pagecycle 1""
[task 2020-02-19T11:54:08.622Z] 11:54:08     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] update tab: 2""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] update tab: 2""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  raptor-control-server Info: received webext_status: update tab: 2
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] test tab updated: 2""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] test tab updated: 2""
[task 2020-02-19T11:54:09.629Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] ready to poll for results; turning on page-timeout timer""
[task 2020-02-19T11:54:09.634Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] now is 1582113249626, set raptor alarm raptor-page-timeout to expire at 1582115249626""
[task 2020-02-19T11:54:09.634Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T11:54:09.634Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:09.638Z] 11:54:09     INFO -  raptor-control-server Info: received webext_status: test tab updated: 2
[task 2020-02-19T11:54:09.642Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T11:54:09.669Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-benchmarkjs] raptor benchmark content loaded""
[task 2020-02-19T11:54:09.790Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-benchmarkjs] raptor benchmark content loaded""
[task 2020-02-19T11:54:09.894Z] 11:54:09     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T11:54:10.175Z] 11:54:10     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T11:54:10.429Z] 11:54:10     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""


[task 2020-02-19T12:27:29.451Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T12:27:29.790Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T12:27:29.790Z] 12:27:29     INFO -  PID 1463 | console.error: ""raptor-page-timeout on http://127.0.0.1:50149/JetStream2/index.html?raptor""
[task 2020-02-19T12:27:29.790Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T12:27:29.790Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] raptor-jetstream2-firefox,http://127.0.0.1:50149/JetStream2/index.html?raptor""
[task 2020-02-19T12:27:29.791Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] capturing screenshot""
[task 2020-02-19T12:27:29.796Z] 12:27:29     INFO -  raptor-control-server Info: received webext_raptor-page-timeout: [u'raptor-jetstream2-firefox', u'http://127.0.0.1:50149/JetStream2/index.html?raptor']
[task 2020-02-19T12:27:29.835Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] closed tab 2""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] benchmark test finished""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] ""
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  raptor-control-server Info: received webext_screenshot
[task 2020-02-19T12:27:29.838Z] 12:27:29     INFO -  perftest-results-handler Info: received screenshot
[task 2020-02-19T12:27:29.859Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] Removed tab: 2""
[task 2020-02-19T12:27:29.859Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] posting to control server""
[task 2020-02-19T12:27:29.859Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] Removed tab: 2""
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  raptor-control-server Info: received request to shutdown the browser
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  raptor-control-server Info: shutting down browser (pid: 1463)
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  raptor-control-server Info: received webext_status: Removed tab: 2
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T12:27:29.904Z] 12:27:29     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] post success""
[task 2020-02-19T12:27:30.204Z] 12:27:30     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T12:27:30.560Z] 12:27:30     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T12:27:30.837Z] 12:27:30     INFO -  PID 1463 | console.log: ""[raptor-runnerjs] checking results...""
[task 2020-02-19T12:27:31.972Z] 12:27:31     INFO -  mozcrash Downloading symbols from: https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/bqqwfDY1S1-O7A9sf1h-8w/artifacts/public/build/target.crashreporter-symbols.zip
[task 2020-02-19T12:27:34.699Z] 12:27:34     INFO -  mozcrash Copy/paste: /Users/cltbld/tasks/task_1582113128/fetches/minidump_stackwalk/minidump_stackwalk /var/folders/__/56y4sw851tv0348xrl89s9qh000017/T/tmp_A4kN7/minidumps/EA491F8C-BC1C-4E37-9993-4D7B731EBBAF.dmp /var/folders/__/56y4sw851tv0348xrl89s9qh000017/T/tmpc41Mlc
[task 2020-02-19T12:27:40.141Z] 12:27:40     INFO -  mozcrash Saved minidump as /Users/cltbld/tasks/task_1582113128/build/blobber_upload_dir/EA491F8C-BC1C-4E37-9993-4D7B731EBBAF.dmp
[task 2020-02-19T12:27:40.142Z] 12:27:40     INFO -  mozcrash Saved app info as /Users/cltbld/tasks/task_1582113128/build/blobber_upload_dir/EA491F8C-BC1C-4E37-9993-4D7B731EBBAF.extra
[task 2020-02-19T12:27:40.143Z] 12:27:40    ERROR -  PROCESS-CRASH | runner.py | application crashed [@ mozilla::ipc::DuplicateDescriptor(mozilla::ipc::TransportDescriptor const&)]
[task 2020-02-19T12:27:40.143Z] 12:27:40     INFO -  Mozilla crash reason: MOZ_RELEASE_ASSERT(result.mFd.fd != -1) (DuplicateDescriptor failed)
[task 2020-02-19T12:27:40.143Z] 12:27:40     INFO -  Crash dump filename: /var/folders/__/56y4sw851tv0348xrl89s9qh000017/T/tmp_A4kN7/minidumps/EA491F8C-BC1C-4E37-9993-4D7B731EBBAF.dmp
[task 2020-02-19T12:27:40.143Z] 12:27:40     INFO -  Operating system: Mac OS X
[task 2020-02-19T12:27:40.143Z] 12:27:40     INFO -                    10.14.5 18F132
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  CPU: amd64
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -       family 6 model 69 stepping 1
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -       4 CPUs
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  GPU: UNKNOWN
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  Crash reason:  EXC_BAD_ACCESS / KERN_INVALID_ADDRESS
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  Crash address: 0x0
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  Process uptime: 289 seconds
[task 2020-02-19T12:27:40.144Z] 12:27:40     INFO -  Thread 0 (crashed)
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -   0  XUL!mozilla::ipc::DuplicateDescriptor(mozilla::ipc::TransportDescriptor const&) [Transport_posix.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 75 + 0x11]
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      rax = 0x000000011b43686a   rdx = 0x0000000000000000
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      rcx = 0x000000010cfba0b8   rbx = 0x0000000000000001
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      rsi = 0x000000014d893828   rdi = 0x00007ffee2fc1f1c
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc1f60   rsp = 0x00007ffee2fc1f50
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -       r8 = 0x0000000000000002    r9 = 0x000000011ae89222
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      r10 = 0x0000000000000000   r11 = 0xffffffffbf81788f
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      r12 = 0x00000000ffffffff   r13 = 0x0000000000000000
[task 2020-02-19T12:27:40.145Z] 12:27:40     INFO -      r14 = 0x000000016a9fdb38   r15 = 0x000000016a9fdb30
[task 2020-02-19T12:27:40.146Z] 12:27:40     INFO -      rip = 0x000000011613b43d
[task 2020-02-19T12:27:40.146Z] 12:27:40     INFO -      Found by: given as instruction pointer in context
[task 2020-02-19T12:27:40.150Z] 12:27:40     INFO -   1  XUL!IPC::ParamTraits<mozilla::ipc::Endpoint<mozilla::ipc::PBackgroundParent> >::Write(IPC::Message*, mozilla::ipc::Endpoint<mozilla::ipc::PBackgroundParent> const&) [ProtocolUtils.h:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 1010 + 0x9]
[task 2020-02-19T12:27:40.150Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc1fa0   rsp = 0x00007ffee2fc1f70
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      rip = 0x000000011622f609
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -   2  XUL!mozilla::dom::PContentChild::SendInitBackground(mozilla::ipc::Endpoint<mozilla::ipc::PBackgroundParent>&&) [PContentChild.cpp: : 1777 + 0xb]
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc1fe0   rsp = 0x00007ffee2fc1fb0
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      rip = 0x00000001161df655
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -   3  XUL!(anonymous namespace)::ChildImpl::SendInitBackgroundRunnable::Run() [BackgroundImpl.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 1776 + 0x1a]
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2030   rsp = 0x00007ffee2fc1ff0
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      rip = 0x000000011611e662
[task 2020-02-19T12:27:40.151Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -   4  XUL!nsThread::ProcessNextEvent(bool, bool*) [nsThread.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 1220 + 0x2]
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2550   rsp = 0x00007ffee2fc2040
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      rip = 0x0000000115b77fa4
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -   5  XUL!<name omitted> [nsThreadUtils.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 481 + 0x23]
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2580   rsp = 0x00007ffee2fc2560
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      rip = 0x0000000115b7bcb7
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.152Z] 12:27:40     INFO -   6  XUL!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) [MessagePump.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 87 + 0x7]
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc25d0   rsp = 0x00007ffee2fc2590
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      rip = 0x000000011612f354
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -   7  XUL!MessageLoop::Run() [message_loop.cc:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 290 + 0xc]
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2600   rsp = 0x00007ffee2fc25e0
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      rip = 0x00000001160e90b0
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -   8  XUL!nsBaseAppShell::Run() [nsBaseAppShell.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 137 + 0x19]
[task 2020-02-19T12:27:40.153Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2620   rsp = 0x00007ffee2fc2610
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      rip = 0x0000000118550ff5
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -   9  XUL!nsAppShell::Run() [nsAppShell.mm:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 705 + 0x8]
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2650   rsp = 0x00007ffee2fc2630
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      rip = 0x00000001185bbd58
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -  10  XUL!XRE_RunAppShell() [nsEmbedFunctions.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 943 + 0x6]
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2690   rsp = 0x00007ffee2fc2660
[task 2020-02-19T12:27:40.154Z] 12:27:40     INFO -      rip = 0x00000001197af3f2
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -  11  XUL!MessageLoop::Run() [message_loop.cc:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 290 + 0xc]
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc26c0   rsp = 0x00007ffee2fc26a0
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      rip = 0x00000001160e90b0
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -  12  XUL!XRE_InitChildProcess(int, char**, XREChildData const*) [nsEmbedFunctions.cpp:1effb11e8e178a9b1f25ba171f4d52f857ebb713 : 778 + 0x5]
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc29c0   rsp = 0x00007ffee2fc26d0
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      rip = 0x00000001197aeedd
[task 2020-02-19T12:27:40.155Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -  13  plugin-container + 0xf0b
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2a00   rsp = 0x00007ffee2fc29d0
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -      rip = 0x000000010cc3cf0b
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -      Found by: previous frame's frame pointer
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -  14  libdyld.dylib!start + 0x1
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -      rbp = 0x00007ffee2fc2a10   rsp = 0x00007ffee2fc2a10
[task 2020-02-19T12:27:40.156Z] 12:27:40     INFO -      rip = 0x00007fff639153d5
[task 2020-02-19T12:27:40.157Z] 12:27:40     INFO -      Found by: previous frame's frame pointer",Start of failure: https://treeherder.mozilla.org/#/jobs?repo=mozilla-central&tier=1%2C2%2C3&searchStr=10.14%2Cjetstream2&tochange=1effb11e8e178a9b1f25ba171f4d52f857ebb713&fromchange=fb59957df14467695b956a7614faa7720c36b4cf&selectedJob=289509418,"Created attachment 9128077
Bug 1616790 - Keep the hard limit for `ulimit -n` unchanged.

The hard limit prevents program to set a value higher than the soft
limit for themselves, and it turns out Firefox does that.

Also, keep the soft limit to its original value if it was already less
than 1024.","Pushed by mh@glandium.org:
https://hg.mozilla.org/integration/autoland/rev/78b5f561022a
Keep the hard limit for `ulimit -n` unchanged. r=froydnj",https://hg.mozilla.org/mozilla-central/rev/78b5f561022a,"1 failures in 4045 pushes (0.0 failures/push) were associated with this bug in the last 7 days.

Repository breakdown:
* mozilla-central: 1

Platform breakdown:
* macosx1014-64-shippable: 1

For more details, see:
https://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1616790&startday=2020-02-17&endday=2020-02-23&tree=all",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1617394,Windows 10 Firefox crashes using PDF print. No crash reports or logs created.,FIXED,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0

Steps to reproduce:

Open a PDF in a new tab.
Click the Print icon in the browser window.
Print either to a printer or save as PDF.


Actual results:

Clicking Print icon in browser window opens the print dialog. Upon clicking Print either to a printer or saving as a PDF leads to Firefox closing without logging a crash report or error-sync log.


Expected results:

The document should be sent to a printer or saved as a PDF and Firefox should say open.",This has been happening in the last 2 or 3 versions of Firefox for Windows.,My computer is a ThinkPad Carbon X1 3rd? 4th? gen.,"[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.","Thanks for taking the time to report this.

I can't reproduce this at the moment, is there a particular PDF that you are having trouble with?","Also, if there is an older version of Firefox that you know does not crash when printing the PDF, you can consider running mozregression to help us find the range of changes that might have introduced this bug:

https://blog.nightly.mozilla.org/2017/06/07/using-mozregression-on-windows/",Resolving as incomplete for the time being since we don't have a way to reproduce the crash. Please feel free to reopen the bug if you can get us an example testcase of the problem.,Printing is working in version 74.0. Thank you!,Thanks for letting us know!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1670545,"MOZ_X11_EGL: Startup crash without crash report when setting mesa_glthread=true env var (DRI3/X11 is not thread safe). Can PR_SetEnv(""mesa_glthread=false"") be added to the X11 EGL backend?",FIXED,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:82.0) Gecko/20100101 Firefox/82.0

Steps to reproduce:

have amdgpu(not amdgpu-pro) (idk about other gpu's situation)

1. export env
$ export mesa_glthread=""true""
$ export MOZ_X11_EGL=""1""

2. start firefox
$ firefox


Actual results:

Can't find symbol 'eglGetNativeClientBufferANDROID'.
Can't find symbol 'eglQuerySurfacePointerANGLE'.
Can't find symbol 'eglCreateStreamKHR'.
Can't find symbol 'eglDestroyStreamKHR'.
Can't find symbol 'eglQueryStreamKHR'.
Can't find symbol 'eglStreamConsumerGLTextureExternalKHR'.
Can't find symbol 'eglStreamConsumerAcquireKHR'.
Can't find symbol 'eglStreamConsumerReleaseKHR'.
Can't find symbol 'eglStreamConsumerGLTextureExternalAttribsNV'.
Can't find symbol 'eglCreateStreamProducerD3DTextureANGLE'.
Can't find symbol 'eglStreamPostD3DTextureANGLE'.
Exiting due to channel error.
Segmentation fault (core dumped)


Expected results:

just starting browser, it's problem in xorg only, on wayland (MOZ_ENABLE_WAYLAND=1 + mesa_glthread=true) works good

1 guy say me, it's looks like problem in mesa (idk true is or not)","I could not reproduce this issue on Ubuntu 20.04 and Firefox 81.0.2, but I do not have an AMD graphic card - tried on Intel(R) HD Graphics 530. I'm assigning the Graphics component, please move this issue to the right component if this is not the correct one. Thanks!","A crash reporter should open. Please report the crash, then open Firefox without mesa_glthread, type about:support into your address bar, press enter, click on ""Copy text to clipboard"" and paste it [here](https://bugzilla.mozilla.org/attachment.cgi?bugid=1670545&action=enter). Thanks!","Created attachment 9182753
about:support","> A crash reporter should open

not openning:(

in about:crashes i get ""No crash reports have been submitted.""","i try reproduce this on new profile, and i noticed for crash need enable webrender (gfx.webrender.all=true gfx.webrender.enabled=true)","hmmm, this bug works with dri3 only, if set LIBGL_DRI3_DISABLE=""true"" then firefox stopped crashing.","The severity field is not set for this bug.
:jimm, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).",*** Bug 1689426 has been marked as a duplicate of this bug. ***,"Debian Testing, Gnome Xwayland, Intel Iris Graphics 6100 (BDW GT3)

Regular Nightly: Same as comment 0. No crash reporter opens.

mesa_glthread=true MOZ_X11_EGL=1 mozregression --launch 2021-09-13 --pref gfx.webrender.all:true
> Process exited with code -11

---

Debug builds do not seem to crash.
mesa_glthread=true MOZ_X11_EGL=1 mozregression --launch 2021-09-13 --pref gfx.webrender.all:true  -P stdout -B debug
>  0:30.44 INFO: b'[GFX2-]: glXWaitVideoSync failed to increment the sync counter.'

---

[Last build before](https://hg.mozilla.org/integration/autoland/shortlog/20a6e3ad662f) reenabling GLX vsync for EGL did also crash. Therefore, GLX vsync does not seem to be the cause of the crash.
mesa_glthread=true MOZ_X11_EGL=1 mozregression --repo autoland --launch 8ec50232ea5541b34962a496abaff720ebd81a73 --pref gfx.webrender.all:true
>  0:28.19 WARNING: Process exited with code -11

---


It could also intermittently crash right after initial EGL support (bug 1640048 comment 14):
mesa_glthread=true MOZ_X11_EGL=1 mozregression --launch 2020-07-03 --pref gfx.webrender.all:true layers.gpu-process.enabled:false

With GPU process, WebRender/EGL was successful on second try:
mesa_glthread=true MOZ_X11_EGL=1 mozregression --launch 2020-07-03 --pref gfx.webrender.all:true -a about:support
> Compositing	WebRender
> Failure Log
> (#0) 	CP+[GFX1-]: Receive IPC close with reason=AbnormalShutdown
> (#1) Error	Receive IPC close with reason=AbnormalShutdown
> (#2) 	CP+[GFX1-]: Receive IPC close with reason=AbnormalShutdown

---

It seems like this crash is expected behavior. But it could be a problem for shipping EGL.

https://bugs.freedesktop.org/show_bug.cgi?id=104214#c25
> DRI3 is not really thread-safe, so basically any change however small can break that mode of operation

https://mesa-dev.freedesktop.narkive.com/Zg8OJdXK/patch-v3-0-4-disable-glthread-if-libx11-isn-t-thread-safe
> Disable glthread if libX11 isn't thread-safe 

GLX backend does already set a Mesa env var.
https://searchfox.org/mozilla-central/rev/5f81c5091d442d829120e19477ba869ae5219709/gfx/gl/GLContextProviderGLX.cpp#80
If possible, it might be good to add `PR_SetEnv(""mesa_glthread=false"");` to the X11 EGL backend to ensure it is disabled.","This bug has been reported two times (bug 1689426).
IMHO: If PR_SetEnv(""mesa_glthread=false"") could not be added to the X11 EGL backend, then MOZ_X11_EGL should depend on bug 1653444.","Thanks, can reproduce. Will create such a patch.","Created attachment 9240909
Bug 1670545 - Disable mesa_glthread on X11/EGL, r=aosmond


The combination currently triggers crashes - not on Wayland though.
Put the code into non-shared code to not clutter `GLContextProviderEGL`.",Try build: https://treeherder.mozilla.org/jobs?repo=try&revision=62d2a65f0384d3a237f79ef4674912b39644239a,"Thanks, confirmed, this patch works.

Without this patch (bug 1695933 comment 9): Crash.
mesa_glthread=true MOZ_X11_EGL=1 mozregression --repo try --launch 7eeab9fde139c8f1471c5d5cd1a8605464f15f19 --pref gfx.webrender.all:true

With this patch, it's not possible to enable mesa_glthread: No crash.
mesa_glthread=true MOZ_X11_EGL=1 mozregression --repo try --launch 62d2a65f0384d3a237f79ef4674912b39644239a --pref gfx.webrender.all:true","Pushed by robert.mader@posteo.de:
https://hg.mozilla.org/integration/autoland/rev/049d6ccbb9a5
Disable mesa_glthread on X11/EGL, r=aosmond",https://hg.mozilla.org/mozilla-central/rev/049d6ccbb9a5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1656675,Firefox 79.0 on Fedora 32 (64-bit) crashes on playing video,FIXED,"Created attachment 9167475
firefox_crash.zip

User Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0

Steps to reproduce:

Watched video https://www.bbc.co.uk/learningenglish/english/course/upper-intermediate/unit-1/session-2


Actual results:

Firefox crashed approximately at the end of the video but it does not reproduce each time. 

Logs from coredumpctl and Firefox about:support troubleshooting info are attached.


Expected results:

No crash","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.","Thanks for the report! Do you have the ability to use the Firefox crash reporter or doesn't show it up?
You might be able to submit unsent crash reports on `about:crashes` and to copy their ID (bp-xxxxxx) to Bugzilla.","`about:crashes` page is empty, but I see crash backtrace logs in applications logs and I have core dump file (~118 MB). I can provide core dump if it is necessary. Is there way to manually submit crash report even if there is nothing in `~/.mozilla/firefox/Crash\ Reports/` directory?",Does official Firefox (https://download.mozilla.org/?product=firefox-latest-ssl&os=linux64&lang=en-US) crash for you as well? A crash reporter window should show up after Firefox crashed.,"No, so far I was not able to reproduce the crash for official Firefox downloaded by the link above.","Does it crash if you start the official Firefox with experimental Wayland backend (which is on by default in Fedora's Firefox)?
`$ MOZ_ENABLE_WAYLAND=1 path/to/firefox/firefox`","No, official Firefox does not crash with Wayland enabled, at least I did not manage to reproduce it. Also Fedora's Firefox works good too, no crashes so far. I guess it is very sporadic.","Created attachment 9167563
firefox_backtrace.log

Backtrace from coredump after `dnf debuginfo-install firefox-79.0-3.fc32.x86_6`","From the callstrack in comment8, it shows the crash is related with ""audio-ipc"". So NI paul to see if he has any idea.","Matthew will know more, this is deep in tokio.",Fixed via bug 1726279.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1648423,ASSERTION: missing ordering entry: 'proposed' in DeadlockDetector.h,FIXED,"The 'proposed' cannot be found because it's not valid anymore:

```
Thread 4 received signal SIGSEGV, Segmentation fault.
[Switching to Thread 2869385.2869460]
0x0000561becf3feb0 in mozalloc_abort (
    msg=0x7fb0f3cf1428 ""[2869385, StreamTrans #18] ###!!! ASSERTION: missing ordering entry: 'proposed', file /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h, line 218"") at /mnt/work/opt/moz/hg-central-2/memory/mozalloc/mozalloc_abort.cpp:33
33	  MOZ_CRASH();

(rr) bt
#0  0x0000561becf3feb0 in mozalloc_abort(char const*)
    (msg=0x7fb0f3cf1428 ""[2869385, StreamTrans #18] ###!!! ASSERTION: missing ordering entry: 'proposed', file /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h, line 218"") at /mnt/work/opt/moz/hg-central-2/memory/mozalloc/mozalloc_abort.cpp:33
#1  0x00007fb1225da3b2 in Abort(char const*)
    (aMsg=0x7fb0f3cf1428 ""[2869385, StreamTrans #18] ###!!! ASSERTION: missing ordering entry: 'proposed', file /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h, line 218"") at /mnt/work/opt/moz/hg-central-2/xpcom/base/nsDebugImpl.cpp:445
#2  0x00007fb1225d9fb4 in NS_DebugBreak(uint32_t, char const*, char const*, char const*, int32_t)
    (aSeverity=1, aStr=0x7fb11d172376 ""missing ordering entry"", aExpr=0x7fb11d4561a1 ""proposed"", aFile=0x7fb11d0dc244 ""/mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h"", aLine=218) at /mnt/work/opt/moz/hg-central-2/xpcom/base/nsDebugImpl.cpp:433
#3  0x00007fb1227dfbe7 in mozilla::DeadlockDetector<mozilla::BlockingResourceBase>::CheckAcquisition(mozilla::BlockingResourceBase const*, mozilla::BlockingResourceBase const*) (this=0x7fb116b099a0, aLast=0x7fb0fbe14820, aProposed=0x7fb116bc9bb8)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h:218
#4  0x00007fb1227ce6a1 in mozilla::BlockingResourceBase::CheckAcquire() (this=0x7fb116bc9bb8)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/BlockingResourceBase.cpp:224
#5  0x00007fb1227ced56 in mozilla::OffTheBooksMutex::Lock() (this=0x7fb116bc9b90)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/BlockingResourceBase.cpp:317
#6  0x00007fb12254ab58 in mozilla::Monitor::Lock() (this=0x7fb116bc9b90)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/Monitor.h:31
#7  0x00007fb122549503 in mozilla::MonitorAutoLock::MonitorAutoLock(mozilla::Monitor&) (this=0x7fb0f3cf1a40, aMonitor=...)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/Monitor.h:66
#8  0x00007fb122806016 in TimerThread::RemoveTimer(nsTimerImpl*) (this=0x7fb116bc9b50, aTimer=0x7fb0fbe147c0)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/TimerThread.cpp:532
#9  0x00007fb12281b94b in nsTimerImpl::CancelImpl(bool) (this=0x7fb0fbe147c0, aClearITimer=false)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsTimerImpl.cpp:403
#10 0x00007fb122804c77 in nsTimerImpl::Cancel() (this=0x7fb0fbe147c0) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsTimerImpl.cpp:392
#11 0x00007fb12282fdea in nsTimer::Cancel() (this=0x7fb103740120) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsTimerImpl.h:235
#12 0x00007fb123679213 in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) (this=0x7fb10592f7c0, aDelegate=0x7fb0f3cf1d38)
    at /mnt/work/opt/moz/hg-central-2/ipc/glue/MessagePump.cpp:335
#13 0x00007fb123568e77 in MessageLoop::RunInternal() (this=0x7fb0f3cf1d38) at /mnt/work/opt/moz/hg-central-2/ipc/chromium/src/base/message_loop.cc:315
#14 0x00007fb123568df5 in MessageLoop::RunHandler() (this=0x7fb0f3cf1d38) at /mnt/work/opt/moz/hg-central-2/ipc/chromium/src/base/message_loop.cc:308
#15 0x00007fb123568db3 in MessageLoop::Run() (this=0x7fb0f3cf1d38) at /mnt/work/opt/moz/hg-central-2/ipc/chromium/src/base/message_loop.cc:290
#16 0x00007fb12280a609 in nsThread::ThreadFunc(void*) (aArg=0x7ffc230d0830) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThread.cpp:447
#17 0x00007fb13278945e in _pt_root (arg=0x7fb1037a4160) at /mnt/work/opt/moz/hg-central-2/nsprpub/pr/src/pthreads/ptthread.c:201
#18 0x00007fb1327994e2 in start_thread (arg=<optimized out>) at pthread_create.c:479
#19 0x00007fb117fbf6a3 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95

(rr) f 3
#3  0x00007fb1227dfbe7 in mozilla::DeadlockDetector<mozilla::BlockingResourceBase>::CheckAcquisition (this=0x7fb116b099a0, aLast=0x7fb0fbe14820, 
    aProposed=0x7fb116bc9bb8) at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/DeadlockDetector.h:218
218	    NS_ASSERTION(proposed, ""missing ordering entry"");
(rr) p aProposed
$9 = (const mozilla::BlockingResourceBase *) 0x7fb116bc9bb8
(rr) p *aProposed
$10 = {static kResourceTypeName = 0x7fb131d79490 <mozilla::BlockingResourceBase::kResourceTypeName>, mChainPrev = 0xe5e5e5e5e5e5e5e5, 
  mName = 0xe5e5e5e5e5e5e5e5 <error: Cannot access memory at address 0xe5e5e5e5e5e5e5e5>, mType = 3857049061, mAcquired = 229, static sCallOnce = {
    initialized = 1, inProgress = 1, status = PR_SUCCESS}, 
  static sResourceAcqnChainFront = {<mozilla::detail::ThreadLocalNativeStorage<mozilla::BlockingResourceBase*>> = {
      mValue = 0x7fb0fbe14820}, <No data fields>}, static sDeadlockDetector = 0x7fb116b099a0}
```

It was freed on main thread during shutdown:
```
(rr) reverse-continue 
Continuing.

Thread 1 hit Hardware watchpoint 1: -location mMonitor->mMutex.mName

Old value = 0xe5e5e5e5e5e5e5e5 <error: Cannot access memory at address 0xe5e5e5e5e5e5e5e5>
New value = 0x7fb11d330581 ""TimerThread.mMonitor""
__memset_avx2_unaligned_erms () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:207
207		VMOVU	%VEC(0), (VEC_SIZE * 3)(%rdi)

(rr) bt
#0  __memset_avx2_unaligned_erms () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:207
#1  0x0000561becf02368 in arena_t::DallocSmall(arena_chunk_t*, void*, arena_chunk_map_t*)
    (this=0x7fb116c00000, aChunk=0x7fb116b00000, aPtr=0x7fb116bc9b50, aMapElm=0x7fb116b012f8)
    at /mnt/work/opt/moz/hg-central-2/memory/build/mozjemalloc.cpp:3290
#2  0x0000561becef6f00 in arena_dalloc(void*, unsigned long, arena_t*) (aPtr=0x7fb116bc9b50, aOffset=826192, aArena=0x0)
    at /mnt/work/opt/moz/hg-central-2/memory/build/mozjemalloc.cpp:3376
#3  0x0000561becf07275 in BaseAllocator::free(void*) (this=0x7ffc230d0f70, aPtr=0x7fb116bc9b50)
    at /mnt/work/opt/moz/hg-central-2/memory/build/mozjemalloc.cpp:4148
#4  0x0000561becf04755 in Allocator<MozJemallocBase>::free(void*) (arg1=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/memory/build/malloc_decls.h:54
#5  0x0000561becf3b716 in PageFree(mozilla::Maybe<unsigned long> const&, void*) (aArenaId=..., aPtr=0x7fb116bc9b50)
    at /mnt/work/opt/moz/hg-central-2/memory/replace/phc/PHC.cpp:1276
#6  0x0000561becf3bee6 in replace_free(void*) (aPtr=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/memory/replace/phc/PHC.cpp:1312
#7  0x0000561becefa9a7 in Allocator<ReplaceMallocBase>::free(void*) (arg1=0x7fb116bc9b50)
    at /mnt/work/opt/moz/hg-central-2/memory/build/malloc_decls.h:54
#8  0x0000561becef54d5 in free(void*) (arg1=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/memory/build/malloc_decls.h:54
#9  0x00007fb12280337d in operator delete(void*) (ptr=0x7fb116bc9b50)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/mozilla/cxxalloc.h:51
#10 TimerThread::~TimerThread() (this=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/TimerThread.cpp:41
#11 0x00007fb1228025dc in mozilla::Runnable::Release() (this=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThreadUtils.cpp:64
#12 0x00007fb122803126 in TimerThread::Release() (this=0x7fb116bc9b50) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/TimerThread.cpp:29
#13 0x00007fb122614bbc in nsCOMPtr_base::~nsCOMPtr_base() (this=0x7fb10592fdd8) at /mnt/work/opt/moz/hg-central-2/xpcom/base/nsCOMPtr.h:329
#14 0x00007fb122614b58 in nsCOMPtr<nsISupports>::~nsCOMPtr() (this=0x7fb10592fdd8) at /mnt/work/opt/moz/hg-central-2/xpcom/base/nsCOMPtr.h:894
#15 0x00007fb1226d6585 in nsMaybeWeakPtr<nsIObserver>::~nsMaybeWeakPtr() (this=0x7fb10592fdd8)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsMaybeWeakPtr.h:19
#16 0x00007fb1226d6565 in nsTArrayElementTraits<nsMaybeWeakPtr<nsIObserver> >::Destruct(nsMaybeWeakPtr<nsIObserver>*) (aE=0x7fb10592fdd8)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:615
#17 0x00007fb1226d64c2 in nsTArray_Impl<nsMaybeWeakPtr<nsIObserver>, nsTArrayInfallibleAllocator>::DestructRange(unsigned long, unsigned long)
    (this=0x7fb108d9f848, aStart=0, aCount=2) at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:2327
#18 0x00007fb1226d679e in nsTArray_Impl<nsMaybeWeakPtr<nsIObserver>, nsTArrayInfallibleAllocator>::ClearAndRetainStorage() (this=0x7fb108d9f848)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:1420
#19 0x00007fb1226d6730 in nsTArray_Impl<nsMaybeWeakPtr<nsIObserver>, nsTArrayInfallibleAllocator>::~nsTArray_Impl() (this=0x7fb108d9f848)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:982
#20 0x00007fb1226d66f8 in nsTArray<nsMaybeWeakPtr<nsIObserver> >::~nsTArray() (this=0x7fb108d9f848)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:2587
#21 0x00007fb1226d66d8 in CopyableTArray<nsMaybeWeakPtr<nsIObserver> >::~CopyableTArray() (this=0x7fb108d9f848)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsTArray.h:2805
#22 0x00007fb1226d3f18 in nsMaybeWeakPtrArray<nsIObserver>::~nsMaybeWeakPtrArray() (this=0x7fb108d9f848)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsMaybeWeakPtr.h:57
#23 0x00007fb1226f6133 in nsObserverList::~nsObserverList() (this=0x7fb108d9f840) at /mnt/work/opt/moz/hg-central-2/xpcom/ds/nsObserverList.h:31
#24 0x00007fb1226f609c in nsTHashtable<nsObserverList>::s_ClearEntry(PLDHashTable*, PLDHashEntryHdr*) (aTable=0x7fb116b782b8, aEntry=0x7fb108d9f840)
    at /mnt/work/opt/moz/hg-central-2/xpcom/ds/nsTHashtable.h:512
#25 0x00007fb1226c7ef6 in PLDHashTable::~PLDHashTable()::$_0::operator()(PLDHashTable::Slot const&) const (this=0x7ffc230d1448, aSlot=...)
    at /mnt/work/opt/moz/hg-central-2/xpcom/ds/PLDHashTable.cpp:292
#26 0x00007fb1226c7e43 in PLDHashTable::EntryStore::ForEachSlot<PLDHashTable::~ForEachSlot()::$_0>(char*, unsigned int, unsigned int, PLDHashTable::~ForEachSlot()::$_0&&) (aStore=0x7fb108d9f000 ""\237\244"", <incomplete sequence \335>, aCapacity=128, aEntrySize=16, aFunc=...)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/PLDHashTable.h:357
#27 0x00007fb1226ba1da in PLDHashTable::EntryStore::ForEachSlot<PLDHashTable::~ForEachSlot()::$_0>(unsigned int, unsigned int, PLDHashTable::~ForEachSlot()::$_0&&) (this=0x7fb116b782c0, aCapacity=128, aEntrySize=16, aFunc=...)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/PLDHashTable.h:347
#28 0x00007fb1226ba12c in PLDHashTable::~PLDHashTable() (this=0x7fb116b782b8) at /mnt/work/opt/moz/hg-central-2/xpcom/ds/PLDHashTable.cpp:290
#29 0x00007fb1226ba222 in PLDHashTable::ClearAndPrepareForLength(unsigned int) (this=0x7fb116b782b8, aLength=4)
    at /mnt/work/opt/moz/hg-central-2/xpcom/ds/PLDHashTable.cpp:304
#30 0x00007fb1226ba26a in PLDHashTable::Clear() (this=0x7fb116b782b8) at /mnt/work/opt/moz/hg-central-2/xpcom/ds/PLDHashTable.cpp:308
#31 0x00007fb1226f2ea5 in nsTHashtable<nsObserverList>::Clear() (this=0x7fb116b782b8) at /mnt/work/opt/moz/hg-central-2/xpcom/ds/nsTHashtable.h:349
#32 0x00007fb1226dd87f in nsObserverService::Shutdown() (this=0x7fb116b78290) at /mnt/work/opt/moz/hg-central-2/xpcom/ds/nsObserverService.cpp:149
#33 0x00007fb122894e3b in mozilla::ShutdownXPCOM(nsIServiceManager*) (aServMgr=0x0) at /mnt/work/opt/moz/hg-central-2/xpcom/build/XPCOMInit.cpp:655
#34 0x00007fb122894ae5 in NS_ShutdownXPCOM(nsIServiceManager*) (aServMgr=0x0) at /mnt/work/opt/moz/hg-central-2/xpcom/build/XPCOMInit.cpp:568
#35 0x00007fb12413870b in XRE_XPCShellMain(int, char**, char**, XREShellData const*)
    (argc=23, argv=0x7ffc230d1de0, envp=0x7fb116b38800, aShellData=0x7ffc230d1ca0)
    at /mnt/work/opt/moz/hg-central-2/js/xpconnect/src/XPCShellImpl.cpp:1377
#36 0x00007fb12be8c1ff in mozilla::BootstrapImpl::XRE_XPCShellMain(int, char**, char**, XREShellData const*)
    (this=0x7fb116b02730, argc=30, argv=0x7ffc230d1da8, envp=0x7fb116b38800, aShellData=0x7ffc230d1ca0)
    at /mnt/work/opt/moz/hg-central-2/toolkit/xre/Bootstrap.cpp:54
#37 0x0000561beceef1b1 in main(int, char**, char**) (argc=30, argv=0x7ffc230d1da8, envp=0x7fb116b38800)
    at /mnt/work/opt/moz/hg-central-2/js/xpconnect/shell/xpcshell.cpp:66
```

And callstack of the main thread in the time of the crash is:
```
(rr) bt
#0  0x0000000070000002 in  ()
#1  0x00007fb1328045c7 in _raw_syscall () at /opt/moz/rr/rr/src/preload/raw_syscall.S:120
#2  0x00007fb1328004de in traced_raw_syscall (call=call@entry=0x681fffa0) at /opt/moz/rr/rr/src/preload/syscallbuf.c:229
#3  0x00007fb132801b88 in sys_fcntl (call=<optimized out>) at /opt/moz/rr/rr/src/preload/syscallbuf.c:1286
#4  syscall_hook_internal (call=0x681fffa0) at /opt/moz/rr/rr/src/preload/syscallbuf.c:2845
#5  syscall_hook (call=0x681fffa0) at /opt/moz/rr/rr/src/preload/syscallbuf.c:2977
#6  0x00007fb1328003ba in _syscall_hook_trampoline () at /opt/moz/rr/rr/src/preload/syscall_hook.S:282
#7  0x00007fb1328003ea in __morestack () at /opt/moz/rr/rr/src/preload/syscall_hook.S:417
#8  0x00007fb132800405 in _syscall_hook_trampoline_48_3d_00_f0_ff_ff () at /opt/moz/rr/rr/src/preload/syscall_hook.S:428
#9  0x00007fb13279fd4b in futex_wait_cancelable (private=0, expected=0, futex_word=0x7fb116b70100) at ../sysdeps/unix/sysv/linux/futex-internal.h:80
#10 __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0x7fb116b70070, cond=0x7fb116b700d8) at pthread_cond_wait.c:508
#11 __pthread_cond_wait (cond=0x7fb116b700d8, mutex=0x7fb116b70070) at pthread_cond_wait.c:638
#12 0x0000561becfe710a in mozilla::detail::ConditionVariableImpl::wait(mozilla::detail::MutexImpl&) (this=0x7fb116b700d8, lock=...)
    at /mnt/work/opt/moz/hg-central-2/mozglue/misc/ConditionVariable_posix.cpp:108
#13 0x0000561becfe71e0 in mozilla::detail::ConditionVariableImpl::wait_for(mozilla::detail::MutexImpl&, mozilla::BaseTimeDuration<mozilla::TimeDurationValueCalculator> const&) (this=0x7fb116b700d8, lock=..., a_rel_time=...) at /mnt/work/opt/moz/hg-central-2/mozglue/misc/ConditionVariable_posix.cpp:115
#14 0x00007fb1227cfb5b in mozilla::OffTheBooksCondVar::Wait(mozilla::BaseTimeDuration<mozilla::TimeDurationValueCalculator>)
    (this=0x7fb116b700b8, aDuration=...) at /mnt/work/opt/moz/hg-central-2/xpcom/threads/BlockingResourceBase.cpp:529
#15 0x00007fb1227cfa01 in mozilla::OffTheBooksCondVar::Wait() (this=0x7fb116b700b8)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/BlockingResourceBase.cpp:508
#16 0x00007fb1228248f2 in mozilla::ThreadEventQueue<mozilla::PrioritizedEventQueue>::GetEvent(bool, mozilla::EventQueuePriority*, mozilla::BaseTimeDuration<mozilla::TimeDurationValueCalculator>*) (this=0x7fb116b70040, aMayWait=true, aPriority=0x7ffc230d0d4c, aLastEventDelay=0x7fb116b9d0d0)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/ThreadEventQueue.cpp:213
#17 0x00007fb12280debc in nsThread::ProcessNextEvent(bool, bool*) (this=0x7fb116b9d030, aMayWait=true, aResult=0x7ffc230d1307)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThread.cpp:1150
#18 0x00007fb122814407 in NS_ProcessNextEvent(nsIThread*, bool) (aThread=0x7fb116b9d030, aMayWait=true)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThreadUtils.cpp:501
#19 0x00007fb12280cb73 in mozilla::SpinEventLoopUntil<(mozilla::ProcessFailureBehavior)0, nsThread::WaitForAllAsynchronousShutdowns()::$_1>(nsThread::WaitForAllAsynchronousShutdowns()::$_1&&, nsIThread*) (aPredicate=..., aThread=0x7fb116b9d030)
    at /mnt/work/opt/moz/hg-central-2/_obj-browser-release-tb-fp-dbg/dist/include/nsThreadUtils.h:360
#20 0x00007fb12280acad in nsThread::WaitForAllAsynchronousShutdowns() (this=0x7fb116b9d030)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThread.cpp:881
#21 0x00007fb122813118 in nsThreadManager::Shutdown() (this=0x7fb1326462f8 <nsThreadManager::get()::sInstance>)
    at /mnt/work/opt/moz/hg-central-2/xpcom/threads/nsThreadManager.cpp:478
#22 0x00007fb122894e52 in mozilla::ShutdownXPCOM(nsIServiceManager*) (aServMgr=0x0) at /mnt/work/opt/moz/hg-central-2/xpcom/build/XPCOMInit.cpp:667
#23 0x00007fb122894ae5 in NS_ShutdownXPCOM(nsIServiceManager*) (aServMgr=0x0) at /mnt/work/opt/moz/hg-central-2/xpcom/build/XPCOMInit.cpp:568
#24 0x00007fb12413870b in XRE_XPCShellMain(int, char**, char**, XREShellData const*)
    (argc=23, argv=0x7ffc230d1de0, envp=0x7fb116b38800, aShellData=0x7ffc230d1ca0)
    at /mnt/work/opt/moz/hg-central-2/js/xpconnect/src/XPCShellImpl.cpp:1377
#25 0x00007fb12be8c1ff in mozilla::BootstrapImpl::XRE_XPCShellMain(int, char**, char**, XREShellData const*)
    (this=0x7fb116b02730, argc=30, argv=0x7ffc230d1da8, envp=0x7fb116b38800, aShellData=0x7ffc230d1ca0)
    at /mnt/work/opt/moz/hg-central-2/toolkit/xre/Bootstrap.cpp:54
#26 0x0000561beceef1b1 in main(int, char**, char**) (argc=30, argv=0x7ffc230d1da8, envp=0x7fb116b38800)
    at /mnt/work/opt/moz/hg-central-2/js/xpconnect/shell/xpcshell.cpp:66
```","I hit this while trying to reproduce another issue. Marking s-s because of the poison value in the report above.

A Pernosco session is available here: https://pernos.co/debug/PCn2eI28L8b513M0YqhaCg/index.html",*** Bug 1712841 has been marked as a duplicate of this bug. ***,This may be related to bug 1683404.,"Getting a better look at this, I see what's happening now:
- A call to `RemoveTimer` comes from `nsTimerImpl::CancelImpl`
- At the same time, we've shut down the timer thread from the main thread and cleared it. If this happened at any other point `nsTimerImpl` would have noticed that there's nothing in `gThread`.
- We get stuck waiting for `nsTimerImpl::RemoveTimer` on a shutdown timer thread, where DeadlockDetector seems to catch it.

This was able to happen because shutting down the timer thread at the time wasn't thread safe. We've since fixed this, so I can't see any way this issue is going to happen anymore. Marking this as resolved unless we come across the issue again.",Was bug 1683404 what fixed this?,"(In reply to Ryan VanderMeulen [:RyanVM] from comment #5)
> Was bug 1683404 what fixed this?

Yes, bug 1683404 fixed it :)","Is sec-high an appropriate severity rating for this bug? If so, we're probably going to need to do something for ESR78 here still...","If this is purely a thread shutdown issue, it could be sec-moderate.","(In reply to Andrew McCreight [:mccr8] from comment #8)
> If this is purely a thread shutdown issue, it could be sec-moderate.

This race only happens during timer thread shutdown, so I agree. Personally I don't think we need to put the changes on ESR78 but if we do need to then it wouldn't affect any of the browser's behavior (except patch out the occasional shutdown hang that caused this bug)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1752466,firefox not opening after KB5008353 was installed (Deadlock caused by WebRoot SecureAnywhere),FIXED,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0

Steps to reproduce:

installed windows 11 update KB5008353. After that firefox might open on first power up, then would hang and would not open. Removed and reloaded FireFox, same problem. Remove KB5008353. Fire fox is now working

 


Actual results:

Information and suggestions are @
""https://support.mozilla.org/en-US/questions/1365962?utm_campaign=questions-reply&utm_source=notification&utm_medium=email#answer-1478688""


Expected results:

DUH ... should work with Windows 11 KB5008353","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Core::Widget: Win32' component, and is moving the bug to that component. Please revert this change in case you think the bot is wrong.","I have not been able to reproduce this. Could you clarify what you mean by ""hang and would not open""? Does Firefox start hanging after a while of being open? Or does it not even start in the first place?","Desktop-911651B HP all in one 24-df0xxx
Windows 11 Don't know the build 
these updates were install KB5008353 (1/26/22)/KB5009566(1/26/22)/KB5008880(1/12/22)/KB4023057(1/12/22)/KB5008295(1/12/22)/
KB5007040(1/12/22) had the problem on 1/26/22. Uninstalled /KB5008353(1/28)  now OK
After the initial power up and perhaps firefox opens then I close it. When I clicked on shortcut or went to program files and clicked on the firefox.exe, Task manager showed Firefox 0% CPU/about 2.1 MB memory and did not change. No window opened and if I clicked firefox again I would get another task with 0% and about the same memory. Each time I clicked shortcut I got another task, but no window. Shortcut showed a check mark and then for a short time the rotating icon. 

as an aside, It might have opened a blank window once or twice, but no address bar to enter a URL  (I did not check task manager)

Hope this helps,
Tom",Would you be willing to reinstall KB5008353 to further investigate? I'm afraid without a system that can reproduce this issue we have very little to go on.,"Not tonight, it is 12:30 AM. I have commitment today till noon. After noon I can do it. 

Tom","Tell me what you want, like a dump or file ( and instructions), and If I can, I'll do it in the morning EST. Otherwise it will be the afternoon","A good first start would be to work through the suggestions in this article:

https://support.mozilla.org/en-US/kb/firefox-hangs-or-not-responding

Depending on whether or not any of those suggestions work, we may have to investigate further.","I reinstalled KB5008353 and the problem is back. If I restart windows and use the shortcut, the firefox window opens, but will not go to yahoo/bing/google or other book marks. Task manager shows firefox(5) in the Apps  section. I closed Firefox (FF) and restart using the shortcut. Shortcut has a checkmark and rotating icon then they disappear. Task manager shows FF in background process 0%/2.1MB, no window. If I try to activate FF again FF tasks are added to background processes. I tried a crash dump to collect the status for you, but after 30 minutes the progress never left 0%, so I restarted windows.

Regarding your suggestions ""https://support.mozilla.org/en-US/kb/firefox-hangs-or-not-responding"" none are my symptoms and after spending all day yesterday doing unrelated suggestion, I think I'll pass on these. My fix is to remove the update.

Perhaps BestBuy or HP  has the same configuration as mine , probably for less than I paid. That might help recreate the problem. If you want a file or dump, let me know before 11:30 EST, because I will remove the update at that time.

Regards,
Tom",Could you collect a minidump of the hanging Firefox processes via Task Manager and attach them to this bug before you uninstall the Windows update?,"WOW, I just came back and FF opened all the way and update is still installed. Closed it and it now does not open again.

Tell me how to do the dump you request","1. Open Task Manager
2. Expand Firefox in the list of processes
3. For each process, right click and select  ""Create dump file""
4. Attach each dump file to this bug

Thanks!","I have noticed FF responds different if I login after my wife has logged out. one time FF opened and then went to my home setting, my yahoo mail. Another time it opened, but did not open mail and I could not get to the internet.

Got  files, but don't see how to attach them.",scroll up and look for the Attach New File button on this page.,found how to attach. getting file size error they are 171 MB only 10 allowed. do you have an email I can send to or an ftp site (if ftp still exist)?,I have just sent you a file request to your email address. Let me know if that doesn't work. Thanks!,"Sent 3 dumps all static 0% CPU/about 2.1MB Memory.

I have another dump that was changing its memory usage but it is 470 MB and your account does not have enough space right now. Let me know when you clear it and I will forward this one to you. No obvious FF operation differences, but it was using resources differently than the other three.

Tom",There should be enough space now for the fourth one. Thanks!,What info do you need?,Do you have WebRoot SecureAnywhere installed? Would you be able to temporarily uninstall it and see if this resolves this issue for you?,"I do have it installed. I did not install it. It was done by Geek Squad as part of my support contract. If I uninstall it, will I need to contact them to reinstall it? 

If not, give me detailed instruction on how to uninstall it and then reinstall it.","It may be sufficient to disable it. I'm not familiar with this software myself, but it should give you an option to temporarily disable it.",removing the webroot protection resolved the problem.,"(In reply to anew_phase from comment #22)
> removing the webroot protection resolved the problem.

Thanks for confirming!

Toshi, :handyman mentioned that this was in your wheelhouse. Could you take a look at this bug? I'm also going to share the minidumps with you so you can take a look. Thank you!","The provided dumps indicate the process was in deadlock.  Our main thread called `GetShellFolderPath`, which started delayloading shcore.dll in a different thread, which was hooked by Webroot (wrusr.dll), which called `SHGetFolderPathW`, which eventually hit a lock that is owned by our main thread.  We can at least block wrusr.dll, but let's see what else we can do.  I've never seen delayload spawned a new thread like this.  This might be a new behavior in Win11.","I installed WebRoot and analyzed its behavior.  WRusr.dll is injected via `CreateRemoteThread` + `LoadLibrary`.

My earlier analysis was a bit wrong.  Our main thread, which tried to load shcore.dll, was waiting for a loader lock.  The other thread was spawned by WebRoot to load WRusr.dll.  There was no hook.  This deadlock was caused by a race between our main thread, which owns a lock in windows.storage.dll and waits for a loader lock, and WebRoot's thread, which owns a loader lock first and then waits for the lock in windows.storage.dll.  The problem is in WRusr.dll.  Calling `SHGetFolderPathW` in `DllMain` is not a good idea.

```
.  0  Id: bac.4c0 Suspend: 0 Teb: 00000069`be4f2000 Unfrozen """"
 # Child-SP          RetAddr               Call Site
00 00000069`bedfe1b8 00007ffe`21c7145e     ntdll!NtWaitForSingleObject+0x14
01 00000069`bedfe1c0 00007ffe`21c5b931     ntdll!LdrpDrainWorkQueue+0x15e
...
07 00000069`bedfed30 00007ffe`1d46b641     windows_storage!_delayLoadHelper2+0x32
08 00000069`bedfed70 00007ffe`1d35442d     windows_storage!_tailMerge_shcore_dll+0x3f
09 00000069`bedfede0 00007ffe`1d3538e2     windows_storage!kfapi::CFolderCache::GetPath+0x91d
0a 00000069`bedfefc0 00007ffe`1d348109     windows_storage!kfapi::CKFFacade::GetFolderPath+0xc2
0b 00000069`bedff070 00007ffd`cdc5ce93     windows_storage!SHGetKnownFolderPath+0x99
0c 00000069`bedff240 00007ffd`cdc5cd56     xul!GetShellFolderPath+0x33
0d 00000069`bedff2a0 00007ffd`cca6b289     xul!nsXREDirProvider::GetUserDataDirectoryHome+0x86
0e 00000069`bedff330 00007ffd`cdc556ba     xul!nsXREDirProvider::GetUserDataDirectory+0x99
0f (Inline Function) --------`--------     xul!nsXREDirProvider::GetUserAppDataDirectory+0x7
10 00000069`bedff4a0 00007ffd`d0e71a7d     xul!XREMain::XRE_mainInit+0x44a

   4  Id: bac.75c Suspend: 0 Teb: 00000069`be4fc000 Unfrozen
 # Child-SP          RetAddr               Call Site
00 00000069`bfdfeee8 00007ffe`21c8a2da     ntdll!NtWaitForAlertByThreadId+0x14
01 00000069`bfdfeef0 00007ffe`1f20d449     ntdll!RtlSleepConditionVariableCS+0x10a
02 00000069`bfdfef60 00007ffe`1d46d89a     KERNELBASE!SleepConditionVariableCS+0x29
03 00000069`bfdfef90 00007ffe`1d354408     windows_storage!Init_thread_header+0x2a
04 00000069`bfdfefc0 00007ffe`1d3538e2     windows_storage!kfapi::CFolderCache::GetPath+0x8f8
05 00000069`bfdff1a0 00007ffe`1d41b715     windows_storage!kfapi::CKFFacade::GetFolderPath+0xc2
06 00000069`bfdff250 00007ffe`0aafdf36     windows_storage!SHGetFolderPathW+0x1e5
07 00000069`bfdff440 00007ffe`0aafedcf     WRusr!DllRegisterServer+0x476
08 00000069`bfdff570 00007ffe`0aaff5db     WRusr!SynExp+0x3f
09 00000069`bfdff5c0 00007ffe`21c5fd17     WRusr!SynExp+0x84b
0a 00000069`bfdff620 00007ffe`21c92bce     ntdll!LdrpCallInitRoutine+0x6b
...
10 00000069`bfdffab0 00007ff6`37af8abe     ntdll!LdrLoadDll+0x106
11 (Inline Function) --------`--------     firefox!mozilla::interceptor::FuncHookCrossProcess<mozilla::interceptor::WindowsDllInterceptor<mozilla::interceptor::VMSharingPolicyUnique<mozilla::interceptor::MMPolicyOutOfProcess> >,long (*)(wchar_t *, unsigned long *, _UNICODE_STRING *, void **)>::operator()+0x19
12 00000069`bfdffba0 00007ffe`1f1e3f02     firefox!mozilla::freestanding::patched_LdrLoadDll+0x1ae
13 00000069`bfdffc80 00000218`65c0002f     KERNELBASE!LoadLibraryExW+0x172 <<<< Spawned by WebRoot to load WRusr.dll
14 00000069`bfdffcf0 00000000`00000000     0x00000218`65c0002f
```

I'm not sure why installing KB5008353 triggered this.  I could not reproduce the deadlock on my Win11 + KB5008353 + WebRoot.  I think this is a timing issue and not limited to Win11 + KB5008353.","Firefox already contains a logic to prevent this injection technique for years, but it's been enabled only in Nightly.  This case is a good reason to enable it for all channels.  We already have Bug 1481454.  I confirmed WRusr.dll was not injected into Nightly on my end.  So I believe Nightly does not have this problem.

Tom,  glad to hear removing WebRoot resolved the problem.  If you reinstall WebRoot, could you install Nightly and see if it can coexist with WebRoot?  I'll get Bug 1481454 done anyway.","The product::component has been changed since the backlog priority was decided, so we're resetting it.
For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#prod_comp_changed_with_priority.py).","Not sure what you want, but I have spent a lot of time getting Mozilla the information to resolve the situation. 

""I'm not sure why installing KB5008353 triggered this. I could not reproduce the deadlock on my Win11 + KB5008353 + WebRoot. I think this is a timing issue and not limited to Win11 + KB5008353."" 

I have provided my configuration, so why not go out and purchase one or borrow one from HP.


I have no idea what nightly is and the amount of work that goes into installing it.","(In reply to anew_phase from comment #28)
> Not sure what you want, but I have spent a lot of time getting Mozilla the information to resolve the situation. 
> 
> ""I'm not sure why installing KB5008353 triggered this. I could not reproduce the deadlock on my Win11 + KB5008353 + WebRoot. I think this is a timing issue and not limited to Win11 + KB5008353."" 
> 
> I have provided my configuration, so why not go out and purchase one or borrow one from HP.
> 
> 
> I have no idea what nightly is and the amount of work that goes into installing it.

We appreciate your help here. As I'm sure you will understand, we can't possibly ""go out and purchase"" every system that shows an issue.

Installing Nightly is very easy. You can download it here and install/uninstall it just like regular Firefox: https://www.mozilla.org/en-US/firefox/channel/desktop/#nightly

""Nightly"" simply refers to Firefox that gets updates on a nightly basis, as opposed to the stable version of Firefox that is updated less frequently.

If you could install Nightly and verify that it runs normally with Win11 + KB5008353, it would help confirm Toshi's analysis. Thanks again for your help!","OK I downloaded it and before I reinstall the update, is there any thing I have to do (like reboot or stop FF and restart)? Is there a way to make sure I am using nightly and not my standard edition? Reinstalling testing and uninstalling is time consuming, so I want to have the correct configuration before I go through the test. If it doesn't work do you want dumps? PLEASE cover all the bases.","if you want dumps, make sure your  storage site is clear","Yes, go ahead and install Nightly. When you launch it, you will see a different icon in your task bar so you can identify if you're running Nightly or stable Firefox.

1. You can install Nightly before or after installing the Windows update, it shouldn't make a difference.
2. Make sure you have WebRoot installed and enabled as before when you reported the issue.
3. Once you have KB5008353 and Nightly installed, start regular Firefox and try to reproduce the hang. Hopefully, it will hang as before when you first reported this bug.
4. Then, close Firefox and start Nightly. Check whether or not the issue reproduces.

If, for whatever reason, you can reproduce the hang in Nightly, please collect the minidumps as before for Nightly. The storage is cleared and should have plenty of space to upload the minidumps.

Thank you!","I down loaded it, But the ICON looks the same. so I guess I didn't do it correctly",DO I have to close FF,"(In reply to anew_phase from comment #34)
> DO I have to close FF

No, you don't have to close the current version.  You can open Firefox and Nightly at the same time.

Can you please download Nightly installer from https://download-origin.cdn.mozilla.net/pub/firefox/nightly/latest-mozilla-central/firefox-98.0a1.en-US.win64.installer.exe and try it again?","OK got it and it seems to correct the problem, but it is poker night and I didn't have much time to check it out. IT looks like I have to set up  the bookmarks and see if they work. 

I am in the dog house because I left the system with the update in and my wife's FF hung. I am now on the *&^%* list.","Installed update and tested Nightly, it opened and accessed the internet. I tried it a couple of time. Remove the update and back to using original FF.",Thank you for testing Nightly!  It's really good news that you didn't hit this issue with Nightly.  I updated bug 1481454 with a patch.,"You're welcome. Let me know when the fix get into the release, so that I can install the update.","On SUMO, Windows 10/11 users are reporting Webroot problems with 64-bit Firefox 97 release:

* https://support.mozilla.org/questions/1367248
* https://support.mozilla.org/questions/1367301

We might need an uplift to release on bug 1481454 if it's deemed safe enough.",*** Bug 1754433 has been marked as a duplicate of this bug. ***,Closing this as fixed in 98 since that's where bug 1481454 landed. Firefox 98 is scheduled to be released on 3/8. Adding RyanVM for awareness in the event that we'd want to roll this into a possible dot release.,"Does this mean we need to download Firefox 98 beta manually or will there be a plan to release a Firefox 97.0.1 patch that includes whatever version 98 includes to fix the issue with Webroot?

Is the issue with Webroot or with Firefox? Thank you.",The issue is with WebRoot (see comment 24 and comment 25 for the technical background). Firefox 98 Beta has a patch that prevents the problem that you are welcome to download for now. Ryan will be able to give input on whether or not there are plans to release a dot release for Firefox 97.," > I think this is a timing issue and not limited to Win11 + KB5008353.

I can confirm that this is not a Windows 11 issue nor a windows update issue as our machines are Windows 10 and get their updates from WSUS which has not had any updates applied in the last week or two. The problem apparently also started last night.

I will wait to hear back from Webroot and see what they have to say as well. But if necessary I can deploy Firefox 98 beta if there is no plans to release a dot version for 97. Thank you.","Yeah, this sounds tied to an update pushed out by Webroot. Unfortunately, bug 1481454 seems like a really scary change to take into a dot release with minimal testing on Beta first given the unknowns around what other fallout it may incur with other programs that hook into Firefox. I think we should try to get in touch with Webroot first to see if they can roll back whatever change they shipped to their software which is interacting badly with Firefox.

Johnny, are you still involved with Webroot and if so, would you be able to help get this in front of the right people?","I will add that the issue seems to affect only Firefox 97. Downgrading to Firefox 96.0.3 fixed the issue when I was troubleshooting the problem. It appears to be specific to Firefox 97, especially given that other users in the posts that I linked report issues with version 97. I believe that something in Firefox 97 and Webroot don't work well together.

I wonder if the original OP only experienced the problem in FF 96 because he is running Windows 11? On our W10 machines that are affected, either running FF 97 in compatibility mode (win 8) or reverting to FF 96.0.3 or uninstalling webroot resolved the issue. I have no users reporting problems running the previous version of Firefox. Our problems only started with version 97. But I do agree that Webroot is the cause but linked to Windows 11 for the OP and in our case linked to version FF 97 which has W11 functionality?

But not all our machines running FF 97 are affected. Only some. No idea why. I have posted this topic with Webroot and I will advise you of their response.",I've left a comment in the Webroot support thread too.,Let's reopen this while we continue to investigate a fix for this from the Webroot end.,"Added to the Fx97 release notes as a known issue.
> Users running WebRoot SecureAnywhere Antivirus may experience impaired functionality when upgrading to Firefox 97. Closing WebRoot will allow Firefox to resume normal operation.",Sorry Ryan I no longer work for Webroot. But I will forward this thread to someone who still work there.,"My 2c, WRusr should avoid calling APIs from DllMain that could conflict with initialization. Anything in the context of DllMain that could conflict with the loader is risky - in this case it's triggering a wait on a resolving an import in a delayed load. Which won't occur since the loader is currently servicing the WRusr loading.","I have received a reply from Webroot.

> Thank you for your reply and for providing the logging. This issue was presented in Firefox's v97 and there appears to be a fix that will be in place for version 98. At this time, we are monitoring and tracking this issue. For some customers, doing an uninstall and reinstall has worked and for others disabling the Web Shield with a reboot has also worked as a temporary workaround.

I have provided them with Webroot logs and provided them with this bug report and the post on their forum relating to this issue. They seem to be still be at the stage of thinking this is a Firefox 97 problem despite the fact that uninstalling and re-installing Webroot seems to fix the problem - which obviously points to Webroot being the cause.

I have also said to them that Firefox 98 is a beta version, not meant to be released to the public and will only actually be released as stable in four weeks time.

I will update you when I get more information from Webroot. Thanks","Johnny's comment 52 is right.  I made a PoC to prove calling `SHGetFolderPathW` in `DllMain` can cause a deadlock.  This proves this is not a problem on Firefox side.

The reason is that `windows_storage!kfapi::CFolderCache::GetPath` owns a critical section and then starts delayloading shcore.dll as shown below.  Preloading shcore.dll may resolve this deadlock, but in general, `DllMain` should not call this kind of expensive APIs.

Here's the flow of this deadlock.

1. FF's main thread calls `GetShellFolderPath` and owns the critical section
2. FF's main thread starts delayloading shcore.dll
3. WebRoot spawns a thread in FF that loads WRusr.dll
4. WRusr.dll's `DllMain` calls `SHGetFolderPathW`
5. WRusr.dll's `DllMain` waits for the critical section that is owned by FF's main thread
6. FF's main thread waits until loading shcore.dll is completed, but it's never completed because WRusr.dll's DllMain is running

```
windows_storage!kfapi::CFolderCache::GetPath+0xd0:
00007ffc`4d68f6c0 89542440        mov     dword ptr [rsp+40h],edx
00007ffc`4d68f6c4 498d742458      lea     rsi,[r12+58h]
00007ffc`4d68f6c9 488bce          mov     rcx,rsi
00007ffc`4d68f6cc 48ff155ddc5000  call    qword ptr [windows_storage!_imp_EnterCriticalSection (00007ffc`4db9d330)]
    ----> probably this is to protect a global counter below
00007ffc`4d68f6d3 0f1f440000      nop     dword ptr [rax+rax]
00007ffc`4d68f6d8 418b4c2418      mov     ecx,dword ptr [r12+18h]
00007ffc`4d68f6dd 48ff152cf06600  call    qword ptr [windows_storage!_imp_SHGlobalCounterGetValue (00007ffc`4dcfe710)]
    ----> delayloads shcore.dll
00007ffc`4d68f6e4 0f1f440000      nop     dword ptr [rax+rax]
00007ffc`4d68f6e9 413944241c      cmp     dword ptr [r12+1Ch],eax
00007ffc`4d68f6ee 0f85a10a0000    jne     windows_storage!kfapi::CFolderCache::GetPath+0xba5 (00007ffc`4d690195)

windows_storage!kfapi::CFolderCache::GetPath+0x104:
00007ffc`4d68f6f4 4032ff          xor     dil,dil

windows_storage!kfapi::CFolderCache::GetPath+0x107:
00007ffc`4d68f6f7 418944241c      mov     dword ptr [r12+1Ch],eax
00007ffc`4d68f6fc 418b4c2420      mov     ecx,dword ptr [r12+20h]
00007ffc`4d68f701 48ff1508f06600  call    qword ptr [windows_storage!_imp_SHGlobalCounterGetValue (00007ffc`4dcfe710)]
...
windows_storage!kfapi::CFolderCache::GetPath+0xba5:
00007ffc`4d690195 40b701          mov     dil,1
00007ffc`4d690198 e95af5ffff      jmp     windows_storage!kfapi::CFolderCache::GetPath+0x107 (00007ffc`4d68f6f7)
```","Created attachment 9263423
PoC - DLL's code","Created attachment 9263424
PoC - EXE's code","It's possible that one of our recent patches changed the time when we load shcore.dll, but even if so, it's not a regression from that change.",Greetings all.  The engineering team at Webroot is actively investigating this issue and putting together a plan of action to address this as quickly as possible.  I greatly appreciate all the context given in this discussion as it gives us a clear path to reproduction and has highlighted the areas of concern for us to address in future releases.  I will post updates to this thread as things progress on our side.,*** Bug 1754584 has been marked as a duplicate of this bug. ***,*** Bug 1755145 has been marked as a duplicate of this bug. ***,*** Bug 1755236 has been marked as a duplicate of this bug. ***,*** Bug 1755015 has been marked as a duplicate of this bug. ***,"Created attachment 9263762
bug1752466-block-webroot-secureanywhere","Created attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik","looks like you have a conflict with the latest update ""2022-02 Cumulative Update for Windows 11 for x64-based Systems (KB5010386)""

This is a security update and I am leaving firefox and going to edge and reinstall the updates.

Firefox opened but could not access the web","(In reply to anew_phase from comment #65)
> looks like you have a conflict with the latest update ""2022-02 Cumulative Update for Windows 11 for x64-based Systems (KB5010386)""
> 
> This is a security update and I am leaving firefox and going to edge and reinstall the updates.
> 
> Firefox opened but could not access the web

Are you referring to a new issue that you're encountering? Are you still running WebRoot? If so, note that a fix for this issue hasn't landed yet, so you are quite likely running into the same problem as reported here.",New window's update ... same issue.  KB5008353 not installed and have the same conflict with KB5010386,"(In reply to anew_phase from comment #67)
> New window's update ... same issue.  KB5008353 not installed and have the same conflict with KB5010386

Right, we've determined that this issue is not related to a particular Windows update. WebRoot is working on a fix and based on the patch in this bug, it appears that we will be rolling out a preventative workaround as well.","Pushed by tkikuchi@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/6ad3fd5a6da6
Block WRusr.dll to stop the deadlock issue.  r=haik",https://hg.mozilla.org/mozilla-central/rev/6ad3fd5a6da6,Please nominate this for Beta and Release approval.,"Comment on attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik

### Beta/Release Uplift Approval Request
* **User impact if declined**: If WebRoot SecureAnywhere is installed, Firefox may enter a deadlock.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**: 
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is a config-only change, adding a new entry to the blocklist we've been using for years.  The risk is low.
* **String changes made/needed**:","Comment on attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik

Dot release driver, approved for 98.0b5.",https://hg.mozilla.org/releases/mozilla-beta/rev/f91f2c4a17a5,"Comment on attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik

Approved for 97.0.1 to stop the bleeding for now. For the WebRoot people following this bug, this block only applies to the current version of WRusr.dll. Newer releases (presumably containing whatever fix y'all end up shipping) should be unaffected by this change.",https://hg.mozilla.org/releases/mozilla-release/rev/b881a697c484,"Added to the 97.0.1 release notes.
> Works around problems with WebRoot SecureAnywhere antivirus rendering Firefox unusable in some situations","Thank you to the Mozilla team for releasing an update to address the issue. Looking forward to Firefox 97.0.1 coming out. Much appreciated.

I must admit I am a bit surprised at the very slow response and lack of communication from Webroot in addressing this issue given the severity of the impact on Firefox and as result the Internet. It has been over a week since this was reported to Webroot. I would have thought that they would have made this a priority to address.

Anyway thanks to the Mozilla guys for releasing a Firefox version that works round the issue. You are stars.","Yes, good job indeed ! Everyone using Webroot should open tickets, this is what I just did, if they get zillion tickets on the same subjets, they might put a bit more efffort in handing their product. Cheers !","We've started the rollout of the 97.0.1. If you have automatic updates enabled, you should receive it automatically within the next couple days. Otherwise, you can manually check for updates via the steps below. We'd love some confirmation from affected users that the workaround is effective!
https://support.mozilla.org/kb/update-firefox-latest-release","I had the issue on my main machine, I just updated to the new version and everything runs well. Congrat to the dev team !","On the test machine that I left unfixed for troubleshooting purposes, I have updated to Firefox 97.0.1 and am pleased to report that this definitely fixes the issue. Firefox runs snappily after updating! Well done.",97.0.1 Worked for me.,"Marking as verified based on comment 81, comment 82 and comment 83. Thanks, all, for confirming.",Thanks to all for surfacing this issue and providing such great details for the Webroot team to analyze.  We have identified a fix for this issue and will be including the changes as part of the next agent release.  Thank you for your patience as we worked through the problem.,"I have opened a new bug report - https://bugzilla.mozilla.org/show_bug.cgi?id=1763683 as I am now using Firefox ESR version. Unfortunately this problem has occurred again with Firefox 91.8.0 ESR. As advised in the new bug post, I have uninstalled Webroot and this seems to fix the issue. Not sure why the ESR is affected as I assume that whatever fixes you applied to Firefox 97.0.1 would apply to 91.8.0 ESR?

I have filed a report with Webroot as it's very concerning that Webroot is continuing to cause problems with Firefox. I don't know if the cause is the same as this specific bug report, but I have uploaded a Firefox dump file on the new bug report. Thank you.",">Not sure why the ESR is affected as I assume that whatever fixes you applied to Firefox 97.0.1 would apply to 91.8.0 ESR?

Only security fixes get backported to ESR.

In this case in particular, a more fundamental mitigation for third-party applications causing Firefox to crash like this, that we shipped in Firefox 99, actually caused an issue for enterprise installations that were doing this intentionally: https://bugzilla.mozilla.org/show_bug.cgi?id=1757487

When dealing with third-party stuff unfortunately fixing the breakage of one product sometimes makes another start crashing Firefox. It's very messy.",*** Bug 1763683 has been marked as a duplicate of this bug. ***,"[Tracking Requested - why for this release]:
Report of the bug likely causing ESR startup issues on bug 1763683.","(In reply to James Morgheim from comment #85)
> Thanks to all for surfacing this issue and providing such great details for the Webroot team to analyze.  We have identified a fix for this issue and will be including the changes as part of the next agent release.  Thank you for your patience as we worked through the problem.

Hi James, do you have an estimate for when the fix will be available?","(In reply to Haik Aftandilian [:haik] from comment #90)
> (In reply to James Morgheim from comment #85)
> > Thanks to all for surfacing this issue and providing such great details for the Webroot team to analyze.  We have identified a fix for this issue and will be including the changes as part of the next agent release.  Thank you for your patience as we worked through the problem.
> 
> Hi James, do you have an estimate for when the fix will be available?

Hello Haik, we have a fix going out with our next agent release version which will begin slow distribution to our consumer customers on Monday April 25th.  We expect this slow distribution process to take approximately six weeks before it will be live to all consumer customers.  Hope this helps, and thanks to all for their patience while we worked through the issue.",Happy to take this on ESR also if we get an uplift request.,"Comment on attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik

### ESR Uplift Approval Request
* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: The issue is causing Firefox ESR to fail to launch for users that have the WebRoot anti-virus product. WebRoot is rolling out a fix (but we have not verified it at this time) and they estimate it will take about 6 weeks to reach all users.
* **User impact if declined**: Users running ESR with the WebRoot anti-virus product installed may not be able to launch Firefox until they uninstall WebRoot. (Alternatively, users could use Release.)
* **Fix Landed on Version**: 97
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change is a DLL blocklist change only.","Comment on attachment 9263763
Bug 1752466 - Block WRusr.dll to stop the deadlock issue.  r=haik

Approved for 91.9esr.",https://hg.mozilla.org/releases/mozilla-esr91/rev/118a67d861fc,"Dalacor, can you please confirm that the 91.9esr RC build is working better for you? Thanks in advance!
https://archive.mozilla.org/pub/firefox/candidates/91.9.0esr-candidates/build1/win64/en-GB/","Unfortunately I am unable to test the issue. If you uninstall Webroot and re-install it, this seems to fix the problem. I had to do that as Firefox was unusable. For some reason none of my clients have reported having this issue, which is odd as many of them had this issue when we were using Firefox Rapid Release 97. But if I come across another machine experiencing the issue, I will test it out and let you know.

However, I can confirm that whatever fix you applied in Firefox 97.0.1 worked for us on a machine experiencing the issue. So if it's the same fix as in mainstream version, then it will definitely fix the issue for ESR. Thank you.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1659907,"""N sheets of paper"" badge subtly influences the layout of the whole print dialog",FIXED,"Created attachment 9170864
screencast of bug (watch the positions of the ""Print"" title, etc. as the N Sheets badge disappears & reappears)

STR:
 1. Do something that causes the ""n sheets of paper"" badge to disappear.  (I'm assuming this is a thing that is expected to happen sometimes.)

(For example: if you're in a local build with bug 1653389's patches applied, you can get the badge to hide by entering an invalid value for the Scale or the Page Range fields. Otherwise, e.g. if you're in today's nightly which doesn't have bug 1653389's patches, you might have to use Browser Toolbox or something else to hide this badge.)

 2. Watch how the UI changes when you do that.

ACTUAL RESULTS:
When the badge disappears, the position of **everything in the dialog** (the ""Print"" title, the ""Destination"" title & dropdown, etc) **shifts upwards slightly**.

EXPECTED RESULTS:
Layout should remain the same. Positions should not shift.

It seems the badge is propping up the positions of everything below it, by virtue of being the largest thing in its container/line/whatever.  Or something like that.

Screencast attached.  Note: as mentioned in the STR, I'm assuming that this badge is something that's actually meant to be occasionally hidden -- but if for some reason the hiding here is accidental & the badge is really meant to remain visible all the time, then perhaps this is a non-issue.","(I marked this as depending on bug 1653389, simply because its patches are the only way that I know of to get this ""N sheets of paper"" badge to disappear right now.)","(Emma, do you know if the badge appearing/disappearing here is the expected/intended behavior? And do we need to have the layout be stable in the presence/absence of that badge?)","The badge disappearing is the expected behavior for when there is an invalid field. The reasoning behind that would be if you had a 3 page paper and specified a page range 1-2, it should update that field to 2 pages. If you then typed in an invalid input at the end range, there wasn't really a great way to keep track of paper count. Should it be the full 3 pages, or the 2 we were printing when it was valid?
Since the user can't print anyways (the button is disabled), we opted to hide the div entirely.

The layout shift shouldn't happen though, so let's try fixing that in this bug.","bug 1653389 is using `visibility: hidden;` now, so I think this should be fixed.","Oh great! Yeah, that should fix this. I'll speculatively close this as fixed, but we can reopen if it turns out to still be an issue.",(confirmed that this is fixed with patches grabbed from bug 1653389 this morning.),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1670410,layout glitch of anchor of Bookmarks Menu arrow panel,FIXED,"Created attachment 9180850
screenshot

Reproducible: always

Steps To Reproduce:
1. Put ""Bookmarks Menu"" widget on Navbar
2. Click the widget

Actual Results:
Layout glitch of arrow panel. (Anchor seems broken).

Expected Results:
Anchor should be the widget.

Regression window:
https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=c8ec11711bb0981f6eb3fe8b95d1d49a41931efd&tochange=98c09e82b3e9728fbfa9204a8b5e3cef676dce76","Created attachment 9180984
Bug 1670410 - Bookmarks popup should have type=""arrow"" so that it receives popuppositioned events. r=Gijs


Otherwise it won't position its arrow properly.","Pushed by ealvarez@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/02c9f9e97558
Bookmarks popup should have type=""arrow"" so that it receives popuppositioned events. r=Gijs",https://hg.mozilla.org/mozilla-central/rev/02c9f9e97558,"Reproduced the issue with Firefox 83.0a1 (20201010213537) on Windows 10x64.
The issue is verified fixed with Firefox 83.0b10 (20201108174701) on Windows 10x64, macOS 10.12 and Ubuntu 18.04.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1676568,Pocket layout is bad for printed media,FIXED,"Created attachment 9187072
screenshot 1 (Chrome)

**STEPS TO REPRODUCE**
1. load https://getpocket.com/explore/item/the-hidden-signs-that-can-reveal-a-fake-photo
2. Print (or Print Preview) the page

**ACTUAL RESULTS**
There are several layout errors that can be easily avoided with a print stylesheet.

The first problem is that pretty much the entire content of the page is put inside as CSS grid container with a single row, which currently doesn't fragment very well in Firefox.  We're working on implementing a fallback mechanism for edge cases like this in bug 1640197 and bug 1665214.  However, there are good reasons for why you should try to avoid triggering that edge case even after we fix those bugs.

Consider for example ""screenshot 1"" which is from Print Preview **in Chrome**.  The text on the last line are split vertically halfway through on some pages.  This is because Chrome also falls back to ""slicing"" rather than using [proper CSS fragmentation](https://drafts.csswg.org/css-break/#breaking-rules). (Firefox will have similar layout (slicing) after we fix the aforementioned bugs.)

The second problem can also be seen in ""screenshot 1"": the ""sign up for Pocket newsletter"" box (which has `position:fixed`) is replicated on every single page, which is [correct per CSS](https://drafts.csswg.org/css-position/#fixed-position), but pretty much always undesirable.  In this case you can see that is overlaps the article content on page 2 and forward.

The third problem is that the navigation/login bar at the top is printed, which should usually be avoided.

The fourth problem is that the advertisement at the top is printed, which should usually be avoided.

The fifth problem is that the ""Discover More Topics"" and ""Products/Company info"" footer(s) at the bottom is printed, which should usually be avoided.

**EXPECTED RESULTS**
Problem 2 to 5 can be fixed with a simple `@media print { selector { display:none } }` rule with a selector that matches those elements.

Problem 1 can be avoided by not using a grid container in print mode.  Currently it's a 3-column grid layout, with ""share toolbar"" in the left column, the article itself in the second column, and advertisements in the third column.  It appears that the content in the first and third column are suppressed when printed, which is good.  This means that the top `<article>` element can be made a `display:block` instead of `display:grid` in the print stylesheet.  This will make it fragment much nicer since it will use the natural break opportunities in the article contents (i.e. between lines, blocks etc).","Hi there! Thanks for filing this.

We've updated our web app to improve the printing format. Though not an official feature per-se, you can now print in a much cleaner format.

Thanks again for this report!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1585009,Support playout-delay RTP header extension,FIXED,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36

Steps to reproduce:

A WebRTC client offers to send video media and enables the following RTP header extension, by setting the following SDP attribute in its offer:

a=extmap:6 http://www.webrtc.org/experiments/rtp-hdrext/playout-delay


Actual results:

The FireFox client removes this attribute in the answer sent back.



Expected results:

Expectation is for the playout-delay attribute to not be removed from the answer and for the browser to honor this extension.

This extension is confirmed to work properly in Chrome and Safari. Therefore the Chromium based WebRTC stack fully supports it.

Inspecting the Gecko repository confirms that the WebRTC stack itself appears to support this RTP header extension. However, the separate signaling library used to conduct the SDP handshake currently does not include support for it.

I have personally tested a simple patch to the signaling code in Gecko to confirm that when enabled, the extension actually performs as expected. I would be happy to productize and submit this patch.

This is a bit difficult to test because to my knowledge there currently are no WebRTC products out there relying on this extension. We are in the process of adding this to our own solution (PhenixRTS), which is how we discovered this issue, and would like to be able to include Gecko based browsers to our list of supported platforms.","Thanks for offering to submit a patch! You'll need to get phabricator set up to submit a patch for review (see https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html). I can handle running the CI testing for your change when you are ready, just needinfo me.","Created attachment 9097502
Bug 1585009: Support playout-delay RTP header extension

Added playout-delay RTP header extension for video to JsepSessionImpl::SetupDefaultRtpExtensions.
This ensures that this extension will be preserved when generating an answer to an offer (by a sending peer) containing it.
Also updated JsepSessionTest to include a test verifying that the expected default audio and video extensions are set.",https://treeherder.mozilla.org/#/jobs?repo=try&revision=5c5c0e9a8b34c39ce0ffa8368547f519bcde940e,Windows builds are busted on that try push due to some infrastructure issue. Will re-try later today.,https://treeherder.mozilla.org/#/jobs?repo=try&revision=152e588e9cf9406c3569f7d6a3649aaab666decf,Check back on try.,"Ok, it looks like some more tests need to be updated:

https://treeherder.mozilla.org/#/jobs?repo=try&revision=152e588e9cf9406c3569f7d6a3649aaab666decf&selectedJob=269651372","Thank you for running, sorry for missing this.

Could you tell me how to run these tests locally? I am running on macOS.","You can run the webrtc mochitests like this:

./mach mochitest dom/media/tests/mochitest","I have been able to run and reproduce the issue.

One of the tests actually verifies the presence of those extensions on incoming RTP packets.

Since there is currently no need for the browser to send packets with this playout-delay extension, I did not bother adding them (since it only adds overhead if they are not actually used). The problem is though that this extension is being announced in the SDP, which is why the test fails (referring to test_peerConnection_basicVideoVerifyRtpHeaderExtensions.html).

Basically: I want the browser to accept offers from other sending peers, which are producing RTP packets with this extension in it (i.e. the browser should not remove the extension from its answer). If the browser is sending however, there is no need to include this extension in the offer as it will not actually produce any.

I will have to go over this code some more to make sure it behaves in this manner, then I am confident it will also pass this test.","So if you want Firefox to only use this as a recv extension, you'll want to pass kRecvonly to AddVideoRtpExtension instead of kSendrecv.","I have made the change as you suggested and retested everything locally: The behavior is now as desired.
I also updated a couple mochitest files and ensured those were running without failures.",https://treeherder.mozilla.org/#/jobs?repo=try&revision=3b708c4f59b81bfd8d410b53087505199db681c4,Check on try.,Try looks good. Is there any change you would like to make before landing?,"I am good with it as is. I have tested the browser with our WebRTC server (in development), and the playout-delay header extension is now handled as expected. Thank you for all your help.","Pushed by bcampen@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/258c68e01345
Support playout-delay RTP header extension r=bwc",https://hg.mozilla.org/mozilla-central/rev/258c68e01345,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1573876,"Perma dom/base/test/test_viewport_metrics_on_landscape_content.html | The root element's scrollHeight should be the layout viewport height - got 966, expected 1932 when Gecko 70 merges to Beta on 2019-08-26",FIXED,"[Tracking Requested - why for this release]:

Central as beta simulation

Treeherder link: https://treeherder.mozilla.org/#/jobs?repo=try&selectedJob=261570727&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel%2Crunnable&revision=5f75676f21240dbf0fbf1cb1d8d5c1d05cf7e100&searchStr=linux%2Cx64%2Casan%2Cmochitests%2Ctest-linux64-asan%2Fopt-mochitest-e10s-2%2Cm%282%29

Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=261570727&repo=try&lineNumber=4117

[task 2019-08-14T12:15:00.409Z] 12:15:00     INFO - TEST-START | dom/base/test/test_viewport_metrics_on_landscape_content.html
[task 2019-08-14T12:15:00.646Z] 12:15:00     INFO - TEST-INFO | started process screentopng
[task 2019-08-14T12:15:00.784Z] 12:15:00     INFO -  JavaScript error: /builds/worker/workspace/build/tests/bin/components/httpd.js, line 3731: NS_ERROR_NOT_AVAILABLE:
[task 2019-08-14T12:15:00.882Z] 12:15:00     INFO -  JavaScript error: /builds/worker/workspace/build/tests/bin/components/httpd.js, line 3731: NS_ERROR_NOT_AVAILABLE:
[task 2019-08-14T12:15:01.128Z] 12:15:01     INFO - TEST-INFO | screentopng: exit 0
[task 2019-08-14T12:15:01.129Z] 12:15:01     INFO - Buffered messages logged at 12:15:00
[task 2019-08-14T12:15:01.129Z] 12:15:01     INFO - add_task | Entering test 
[task 2019-08-14T12:15:01.130Z] 12:15:01     INFO - TEST-PASS | dom/base/test/test_viewport_metrics_on_landscape_content.html | The content should be scaled by 0.5x 
[task 2019-08-14T12:15:01.130Z] 12:15:01     INFO - TEST-PASS | dom/base/test/test_viewport_metrics_on_landscape_content.html | window.innerHeight should reflect the layout viewport 
[task 2019-08-14T12:15:01.131Z] 12:15:01     INFO - Buffered messages finished
[task 2019-08-14T12:15:01.132Z] 12:15:01     INFO - TEST-UNEXPECTED-FAIL | dom/base/test/test_viewport_metrics_on_landscape_content.html | The root element's scrollHeight should be the layout viewport height - got 966, expected 1932
[task 2019-08-14T12:15:01.132Z] 12:15:01     INFO -     SimpleTest.is@SimpleTest/SimpleTest.js:320:16
[task 2019-08-14T12:15:01.133Z] 12:15:01     INFO -     @dom/base/test/file_viewport_metrics_on_landscape_content.html:46:5
[task 2019-08-14T12:15:01.133Z] 12:15:01     INFO -     nextTick/<@SimpleTest/SimpleTest.js:1793:34
[task 2019-08-14T12:15:01.133Z] 12:15:01     INFO -     nextTick@SimpleTest/SimpleTest.js:1809:11
[task 2019-08-14T12:15:01.134Z] 12:15:01     INFO - TEST-PASS | dom/base/test/test_viewport_metrics_on_landscape_content.html | The content height should be half of the layout viewport height 
[task 2019-08-14T12:15:01.134Z] 12:15:01     INFO - TEST-PASS | dom/base/test/test_viewport_metrics_on_landscape_content.html | The content should be scaled by 1.0x 
[task 2019-08-14T12:15:01.135Z] 12:15:01     INFO - TEST-PASS | dom/base/test/test_viewport_metrics_on_landscape_content.html | Now the visual viewport height should be changed to half of the layout viewport height 
[task 2019-08-14T12:15:01.135Z] 12:15:01     INFO - TEST-FAIL | dom/base/test/test_viewport_metrics_on_landscape_content.html | window.innerHeight shouldn't be changed (Bug 1514429) - got 966, expected 1932
[task 2019-08-14T12:15:01.135Z] 12:15:01     INFO - Not taking screenshot here: see the one that was previously logged
[task 2019-08-14T12:15:01.136Z] 12:15:01     INFO - TEST-UNEXPECTED-FAIL | dom/base/test/test_viewport_metrics_on_landscape_content.html | The root element's scrollHeight shouldn't be changed - got 966, expected 1932
[task 2019-08-14T12:15:01.136Z] 12:15:01     INFO -     SimpleTest.is@SimpleTest/SimpleTest.js:320:16
[task 2019-08-14T12:15:01.137Z] 12:15:01     INFO -     @dom/base/test/file_viewport_metrics_on_landscape_content.html:61:5
[task 2019-08-14T12:15:01.137Z] 12:15:01     INFO -     nextTick/<@SimpleTest/SimpleTest.js:1793:34
[task 2019-08-14T12:15:01.137Z] 12:15:01     INFO -     nextTick@SimpleTest/SimpleTest.js:1809:11
[task 2019-08-14T12:15:01.137Z] 12:15:01     INFO - add_task | Leaving test 
[task 2019-08-14T12:15:01.138Z] 12:15:01     INFO - GECKO(1090) | MEMORY STAT | vsize 20975105MB | residentFast 1678MB",Test got added in bug 1508177.,"Created attachment 9085624
Bug 1573876 - Enable layout.viewport_contains_no_contents_area on test_viewport_metrics_on_landscape_content.html. r?botond","Pushed by hikezoe.birchill@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/5d6185ef02c7
Enable layout.viewport_contains_no_contents_area on test_viewport_metrics_on_landscape_content.html. r=botond",https://hg.mozilla.org/mozilla-central/rev/5d6185ef02c7,Verified fixed: https://treeherder.mozilla.org/#/jobs?repo=try&revision=112f5a1ba3d6239018f396c9c10d95b292d19580&searchStr=linux%2Cx64%2Casan%2Cmochitests%2Ctest-linux64-asan%2Fopt-mochitest-e10s-2%2Cm%282%29&selectedJob=262172799,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1517818,[de-XBL] Ensure custom elements clean up on DOM reinsertions (example: RSS mail-urlfield URLs opens twice due to stacked onclick event listener on layout change),FIXED,"Created attachment 9034463
Thunderbird v65.0b1 build 20181222205702.png

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0

Steps to reproduce:

One (1) click on the source URL (a link provided by Thunderbird graphic user interface) of any RSS news  


Actual results:

opens twice (2 identical tabs) in Firefox if Firefox is open, or random crash Firefox there was no instance of Firefox running.

Thunderbird v65.0b1 build 20181222205702, Windows 10, Firefox 64 x64bits
Ctrl+F and Ctrl+G stopped working, all bugs appeared at the same time 3 updates ago.


Expected results:

open only one tab in Firefox.","I can't reproduce this on win7 and clean Fx66 and Tb66, it works as expected, along with ctrl-f and g. Make sure no extension is a variable.","(In reply to alta88 from comment #1)
> I can't reproduce this on win7 and clean Fx66 and Tb66, it works as
> expected, along with ctrl-f and g. Make sure no extension is a variable.

Thanks for your testing, I found out you need is to change the layout:
Menu > Options > Layout > Vertical View
Tested in a clean installed VirtualBox Win7 x86, and Thunderbird Beta Version 65.0b1 and RSS feed:
http://blog.mozilla.org/

Tested restarting in safe mode (no extensions available), same bug.
I can't test in Thunderbird 66, where did you get it?. The current download Thunderbird Beta button link is:
https://download.mozilla.org/?product=thunderbird-65.0b1-SSL&os=win&lang=en-US

Here is the video recording of the test in windows 7 32bis and internet explorer.
https://youtu.be/POT2jLd_Jb0","(In reply to fernicar from comment #2)
> (In reply to alta88 from comment #1)
> > I can't reproduce this on win7 and clean Fx66 and Tb66, it works as
> > expected, along with ctrl-f and g. Make sure no extension is a variable.
> 
> Thanks for your testing, I found out you need is to change the layout:
> Menu > Options > Layout > Vertical View

that's pretty key (nice video too). this is a regression from Bug 1489748, an onlick event listener is getting stacked on each layout change.","(In reply to alta88 from comment #3)
> that's pretty key (nice video too). this is a regression from Bug 1489748,
> an onlick event listener is getting stacked on each layout change.

I forgot to show/mention Ctrl+F and Ctrl+G in the video, it stop working as soon as the layout is changed.","there are a lot of issues after a layout change without a restart. they have all been fixed (not this new event listener stacking one) in the MoreLayouts extension, but I have not yet updated it for Tb 64+.

https://bitbucket.org/alta8888/morelayouts","After updating MoreLayouts for 64, the problem is even more manifest: the tree-col image element is duplicated/reinserted on each layout change.

Anway, something like this needs to be implemented for custom elements generically to handle DOM reinsertions,  otherwise there will be future pain. The code below fixes the bug here.

 class MozMailUrlfield extends MozMailHeaderfield {
+  constructor() {
+    super();
+    this.destroy = this.destroy.bind(this);
+  }
   connectedCallback() {
     super.connectedCallback();
     this.setAttribute(""context"", ""copyUrlPopup"");
     this.classList.add(""text-link"", ""headerValueUrl"");
-    this.addEventListener(""click"", (event) => {
-      if (event.button != 2) {
-        openUILink(encodeURI(event.target.textContent), event);
-      }
-    });
+
+    this.addEventListener(""click"", this.onClickListener);
+    this.addEventListener(""unload"", this.destroy);
+    this._initialized = true;
+  }
+  onClickListener(event) {
+    if (event.button != 2) {
+      openUILink(encodeURI(event.target.textContent), event);
+    }
+  }
+  destroy() {
+    if (this._initialized) {
+      this._initialized = false;
+      this.removeEventListener(""click"", this.onClickListener);
+      this.removeEventListener(""unload"", this.destroy);
+    }
   }
 }","Created attachment 9034799
code

ouch, since when is markdown a thing in bugzilla.","
This will fix the duplicated treecol images. We need to review custom elements and keep DOM changes in mind...

```diff
class MozTreecolImage extends customElements.get(""treecol"") {
   static get observedAttributes() {
     return [""src""];
   }
 
   connectedCallback() {
+    if (this._initialized)
+      return;
+
     this.image = document.createElement(""image"");
     this.image.classList.add(""treecol-icon"");
 
     this.appendChild(this.image);
     this._updateAttributes();
+    this._initialized = true;
   }
 
   attributeChangedCallback() {
     this._updateAttributes();
   }
 
   _updateAttributes() {
     if (!this.isConnected || !this.image) {
```","(In reply to fernicar from comment #4)
> (In reply to alta88 from comment #3)
> > that's pretty key (nice video too). this is a regression from Bug 1489748,
> > an onlick event listener is getting stacked on each layout change.
> 
> I forgot to show/mention Ctrl+F and Ctrl+G in the video, it stop working as
> soon as the layout is changed.

This is a regression from Bug 1499617, for some reason a .destroy() method was added to the Findbar, without realizing that on some layout changes the findbar.destroy() already runs in the custom element, so messagepane browser docShell is already destroyed, causing a throw. Further, the findbar needs to be reset after the layout change.

Please file a separate bug for this and reference this comment/regressing bug.","(In reply to alta88 from comment #9)

> This is a regression from Bug 1499617, for some reason a .destroy() method was added to the Findbar, without realizing that on some layout changes the findbar.destroy() already runs in the custom element, so messagepane browser docShell is already destroyed, causing a throw. Further, the findbar needs to be reset after the layout change.
> 
> Please file a separate bug for this and reference this comment/regressing bug.

Yes, here is the new link: Bug 1519416 comment #1","Created attachment 9053588
bug1517818_dom_reinsert.patch

https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&revision=cfc97fb44474847ac02b8c10f50bed2cd7b6d86d","(In reply to alta88 from comment #6)
AFAIK, removing internal event listeners is not needed. They will go away automatically when the object goes away.","Comment on attachment 9053588
bug1517818_dom_reinsert.patch

Review of attachment 9053588:
-----------------------------------------------------------------

::: mail/base/content/mailWidgets.js
@@ +38,5 @@
>          openUILink(encodeURI(event.target.textContent), event);
>        }
>      });
>    }
> +  connectedCallback() {

need empty line before connectedCB","Created attachment 9054178
bug1517818_dom_reinsert.patch

The eventDialog.js try failure should be unrealated. The test works fine locally too with 
make mozmill-one -C comm/calendar/test/mozmill SOLO_TEST=eventDialog/testAlarmDialog.js","Pushed by mozilla@jorgk.com:
https://hg.mozilla.org/comm-central/rev/044047050f11
add some guards against adding children and event listeners more than once since connectedCallback() can run many times. r=arshad","It says ""regression"", does this need to go into the beta?","Wouldn't say it's a super visible problem, but it might as well go into beta.","TB 67 beta:
https://hg.mozilla.org/releases/comm-beta/rev/1599c84ad552ea0ba55cc708a72cbdee25ccecb9",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1639999,"Perma layout/style/test/test_pseudoelement_state.html | hover subtest #7, number of different pixels - got 202, expected 0 when Gecko 78 merges to Beta on 2020-05-21",FIXED,"central-as-beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&group_state=expanded&selectedTaskRun=Ahi1GKqERwS2Y3d0xy4oJg-0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=49ea038a588c25d575a555e74c45c2a23eb3fd57

Log: https://treeherder.mozilla.org/logviewer.html#?job_id=303229567&repo=try

[task 2020-05-21T12:30:30.580Z] 12:30:30     INFO - TEST-PASS | layout/style/test/test_pseudoelement_state.html | hover subtest #7, canvas sizes equal 
[task 2020-05-21T12:30:30.580Z] 12:30:30     INFO - Buffered messages finished
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO - TEST-UNEXPECTED-FAIL | layout/style/test/test_pseudoelement_state.html | hover subtest #7, number of different pixels - got 202, expected 0
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO -     SimpleTest.is@SimpleTest/SimpleTest.js:383:14
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO -     runTestPart3@layout/style/test/test_pseudoelement_state.html:142:7
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO - TEST-PASS | layout/style/test/test_pseudoelement_state.html | hover subtest #7, computed style 
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO - TEST-PASS | layout/style/test/test_pseudoelement_state.html | active subtest #7, canvas sizes equal 
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO - Not taking screenshot here: see the one that was previously logged
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO - TEST-UNEXPECTED-FAIL | layout/style/test/test_pseudoelement_state.html | active subtest #7, number of different pixels - got 202, expected 0
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO -     SimpleTest.is@SimpleTest/SimpleTest.js:383:14
[task 2020-05-21T12:30:30.581Z] 12:30:30     INFO -     runTestPart5@layout/style/test/test_pseudoelement_state.html:165:9","Bug 1632646 will fix this, and it should be about to reach central.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1652228,Perma layout/style/test/test_flexbox_reflow_counts.html | bug in test; 'childToPreserve' should be child of 'parent' when Gecko 80 switches to late beta on 2020-08-07,FIXED,"central-as-late-beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=911887fd1f3b6f8ab1a5caf5ddc991ec5c7bbb09&selectedTaskRun=AJ7DtxzqSsSP9_aWFbxWQA.0

Log: https://treeherder.mozilla.org/logviewer.html#?job_id=309301573&repo=try

TEST-UNEXPECTED-FAIL | layout/style/test/test_flexbox_reflow_counts.html | bug in test; 'childToPreserve' should be child of 'parent'
TEST-UNEXPECTED-FAIL | layout/style/test/test_flexbox_reflow_counts.html | uncaught exception - TypeError: parent.appendChild is not a function at removeChildrenExcept@http://mochi.test:8888/tests/layout/style/test/test_flexbox_reflow_counts.html:79:12 

`layout.dynamic-reflow-roots.enabled` is [only enabled for EARLY_BETA_OR_EARLIER](https://searchfox.org/mozilla-central/rev/622dbd3409610ad3f71b56c9a6a92da905dab0aa/modules/libpref/init/StaticPrefList.yaml#6203).","Interesting! This wasn't intended to depend on `layout.dynamic-reflow-roots.enabled`.  Do we know for sure that that's the pref involved here?

(I just tried running this mochitest manually, with that pref set to false, and it passed without issues. So I suspect there might be something else involved instead/also.)

In any case, I'll take a look here.","It looks like the problem is that the automatically-defined varialble `content` is actually a pointer to `window`, in Firefox release & late-beta (but not in Firefox Nightly or in Chrome).

Whereas, the test is **expecting** it to be a pointer to the `<div id=""content"">` node.

I don't know what the explanation is for this magic `window` behavior, but maybe it's a quirk that we're getting rid of? (hence the maybe-new  nightly-specific behavior that happens to match Chrome)

In any case, we can easily fix this by just explicitly declaring the `content` variable, instead of relying on the automagic behavior.","(In reply to Daniel Holbert [:dholbert] from comment #2)
> I don't know what the explanation is for this magic `window` behavior, but maybe it's a quirk that we're getting rid of? (hence the maybe-new  nightly-specific behavior that happens to match Chrome)

Yeah, looks like this is the thing in bug 1632116. The relevant pref that changes behavior here (in the late beta simulation) is `dom.window.content.untrusted.enabled`.","Not that we need it, but just to illustrate for anyone curious: here's a minimized testcase for demonstrating the problem here -- load this data URI, with web console (ctrl+shift+k) open:
```
data:text/html,<div id=""content""></div><script>console.log(content)</script>
```

In Nightly, this logs the `<div>` (as the mochitest expects that it would).
In Firefox release (v78), this logs the `Window`, and then it prints the following warning about this behavior being deprecated:
`The ‘content’ attribute of Window objects is deprecated.  Please use ‘window.top’ instead.`","(In reply to Daniel Holbert [:dholbert] from comment #1)
> Interesting! This wasn't intended to depend on `layout.dynamic-reflow-roots.enabled`.  Do we know for sure that that's the pref involved here?
> 
> (I just tried running this mochitest manually, with that pref set to false, and it passed without issues. So I suspect there might be something else involved instead/also.)

No. Thank you for identifying the related pref.","Created attachment 9163041
Bug 1652228: In test_flexbox_reflow_counts.html, don't bother pruning (nonexistent) children from 'content' node, and use consistent vars. r?TYLin


Before this patch, the test tries to remove all children from the 'content'
node except for one, as part of cleaning up. This is unnecessary, because none
of the subtests ever add any additional children to the 'content' element.
(It's also problematic because in late beta & release, 'content' is a special
variable name by default.)

While we're at it, this patch also makes us address the other nodes more
consistently, using the explicit variable declarations at the top of the
script section rather than their implicit ID-granted variable names.","Pushed by dholbert@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/afca8223767c
In test_flexbox_reflow_counts.html, don't bother pruning (nonexistent) children from 'content' node, and use consistent vars. r=TYLin",https://hg.mozilla.org/mozilla-central/rev/afca8223767c,Verified fix in latest beta sim: https://treeherder.mozilla.org/#/jobs?repo=try&group_state=expanded&resultStatus=success%2Ctestfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=d9ddb487dc8fd97c1d64b4e386bcf4ee0690dda1&searchStr=mochitest%2Cplain,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1644127,Turn the layout side pane into a document for screen readers.,FIXED,"That will make it more navigable.*Thank you for helping make Firefox better. If you are reporting a defect, please complete the following:* 

## What were you doing?

*Please tell us what site you were on, and what steps led to the error you are reporting* 

1. *First step*
2. *Second step*
3. *…*

## What happened?

*What, if any, error messages did you see? Did the browser crash? Screenshots or screen recordings can be attached to this report and are helpful in isolating and replicating the bug.*

## What should have happened?

 *Was was the expected result? (""Not crashing"" may be a valid answer.)*

## Anything else we should know? 

*Do you have extensions installed? You can also go to `about:support` in another window or tab and attach the report it generates to this bug.*","Created attachment 9154922
Bug 1644127 - Turn the layout side pane into a document for screen readers, r?yzen


This will make it navigable with screen reader commands.

Depends on D78674","Pushed by mzehe@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/3d1e9c77a42d
Turn the layout side pane into a document for screen readers, r=yzen",https://hg.mozilla.org/mozilla-central/rev/3d1e9c77a42d,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1252870,Unveiled failing assertions uncovered bug in plugin blocking,FIXED,"As explained in https://bugzilla.mozilla.org/show_bug.cgi?id=1241930#c11:

https://hg.mozilla.org/mozilla-central/diff/103700d6b355/browser/base/content/test/plugins/browser_blocking.js#l1.354

Which Jim introduced in bug 1129040: the return value of ContentTask.spawn is _always_ true-ish, because it returns a Promise; a `yield` was omitted.
`result` is expected to be `true`, but it's not.

See https://treeherder.mozilla.org/#/jobs?repo=try&revision=266edacc9b37",*** Bug 1252681 has been marked as a duplicate of this bug. ***,Are you going to take this? I filed bug 1252870 and was planning on doing the touch up there.,"(In reply to Jim Mathies [:jimm] from comment #2)
> Are you going to take this? I filed bug 1252870 and was planning on doing
> the touch up there.

s/bug 1252870/bug 1252681","(In reply to Jim Mathies [:jimm] from comment #3)
> (In reply to Jim Mathies [:jimm] from comment #2)
> > Are you going to take this? I filed bug 1252870 and was planning on doing
> > the touch up there.
> 
> s/bug 1252870/bug 1252681

Ah sorry, I didn't see you filed it! I don't think it'd be as efficient if I took this...","Created attachment 8725733
MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser chrome tests. r=mikedeboer

Review commit: https://reviewboard.mozilla.org/r/37611/diff/#index_header
See other reviews: https://reviewboard.mozilla.org/r/37611/","Comment on attachment 8725733
MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser chrome tests. r=mikedeboer

hmm, there a mismatch in what one of these checks looks for and a comment.","Comment on attachment 8725733
MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser chrome tests. r=mikedeboer

Review request updated; see interdiff: https://reviewboard.mozilla.org/r/37611/diff/1-2/","Comment on attachment 8725733
MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser chrome tests. r=mikedeboer

https://reviewboard.mozilla.org/r/37611/#review34177

Thanks, that was quick! :) Almost there...

::: browser/base/content/test/plugins/browser_blocking.js:350
(Diff revision 2)
> -  ok(result, ""Plugin should be activated."");
> +  ok(!result, ""Plugin should be activated."");

The big question here is that I'd expect this be `true` analogous to `objectLoadingContent.activated`. Can you explain this discrepency? If this really is correct, can you add a comment here with the explanation?","(In reply to Mike de Boer [:mikedeboer] from comment #8)
> Comment on attachment 8725733
> MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser
> chrome tests. r?mikedeboer
> 
> https://reviewboard.mozilla.org/r/37611/#review34177
> 
> Thanks, that was quick! :) Almost there...
> 
> ::: browser/base/content/test/plugins/browser_blocking.js:350
> (Diff revision 2)
> > -  ok(result, ""Plugin should be activated."");
> > +  ok(!result, ""Plugin should be activated."");
> 
> The big question here is that I'd expect this be `true` analogous to
> `objectLoadingContent.activated`. Can you explain this discrepency? If this
> really is correct, can you add a comment here with the explanation?

It should be false, the plugin was blocklisted in this particular test case. I can update that text message to reflect that.","(In reply to Jim Mathies [:jimm] from comment #9)
> It should be false, the plugin was blocklisted in this particular test case.
> I can update that text message to reflect that.

Pfew! That'd be nice. r=me with that change!","Comment on attachment 8725733
MozReview Request: Bug 1252870 - Fixup a couple buggy plugin related browser chrome tests. r=mikedeboer

Review request updated; see interdiff: https://reviewboard.mozilla.org/r/37611/diff/2-3/",https://hg.mozilla.org/integration/mozilla-inbound/rev/dc9c31033281,https://hg.mozilla.org/mozilla-central/rev/dc9c31033281,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1280451,Email Support lists blocking based solely on SORBS listing,FIXED,"User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0
Build ID: 20160604131506

Steps to reproduce:

Sent email to support-thunderbird@lists.mozilla.org


Actual results:

Email was blocked based solely on my shared dreamhost server IP being listed by dnsbl.sorbs.net:

Reporting-MTA: dns; homiemail-a56.g.dreamhost.com
X-Postfix-Queue-ID: 557E7FE069
X-Postfix-Sender: rfc822; tanstaafl@libertytrek.org
Arrival-Date: Thu, 16 Jun 2016 05:26:49 -0700 (PDT)

Final-Recipient: rfc822; support-thunderbird@lists.mozilla.org
Original-Recipient: rfc822;support-thunderbird@lists.mozilla.org
Action: failed
Status: 5.7.1
Remote-MTA: dns; lists.mozilla.org
Diagnostic-Code: smtp; 554 5.7.1 Service unavailable; Client host
    [208.113.200.129] blocked using dnsbl.sorbs.net; Currently Sending Spam
    See: http://www.sorbs.net/lookup.shtml?208.113.200.129


Expected results:

Email should have been at worst scored a little higher (best case, stop using SORBS), and further anti-spam tests run to make final spam/ham determination.

Being listed by SORBS should never be used as a decision to BLOCK - scoring, maybe, but SORBS is notoriously unreliable.

The SORBS Wikipedia page describes my exact problem precisely:

""Problem
Some ISPs use a shared SMTP server to onsend their customers email. If any of those customers send emails which the system identifies as spam, then the legitimate traffic from all the other users that use that SMTP server is blocked by the system. As at May 2016, the system was flagging the Telstra Australia (Australia's largest and most reputable internet service provider) SMTP servers as a spam source, thereby blocking legitimate emails from Telstra customers being delivered to any ISP's that use the SORBS system. It is highly likely that among Telstra's hundreds of thousands of customers, there are some virus infected computers acting as zombies and relying spam emails. The SORBS system is based on a faulty analysis of the spam problem and should not be used because it blocks large quantities of legitimate emails.""

https://en.wikipedia.org/wiki/Spam_and_Open_Relay_Blocking_System#Problem

There are ton more just like this one:

https://wordtothewise.com/2010/12/gfi-sorbs-considered-harmful-part-4/

Please, at a minimum, change decisions from SORBS queries to only score a little higher - or better, stop using it altogether and use something reliable like zen.spamhaus.org",Even emails to the list owner are blocked...,"SORBS is an RBL service we use, and generally when you get listed its actually for a reason and usually we push back and have the ISP to request a delisting since you are placed on this list for a reason. Looks like what you are sending is from a dreamhost IP range, are you sending directly from a host? I would recommend using a mail relay or you could talk to dreamhost about asking them to get delisted","As my comment 0 clearly stated, yes, I am  using a dreamhost shared account.

SORBS is notoriously unreliable They are constantly blocking entire IP ranges based solely on unreliable evidence that someone on that range may have spammed someone once. I have had this problem with your lists for YEARS. I just finally decided to try to do something about it.

Please change your spam rules to only use it for scoring purposes (most who do this only give it a weight of '1')..

Did you even bother to do any research at all or read the links I provided?

Outright BLOCKING based solely on a SORBS listing is really, really, REALLY bad, and absolutely will result in false positives (like my case).

Please read the evidence I provided, and feel free to google some more to read all of the complaints.

Or even better, do as most of us mail admins have a long time ago and stop using SORBS altogether, and use something that is actually reliable, like zen.spamhaus.","Oh, one more thing...

I participate in about 50 email lists, mostly tech related, some political, etc...

NONE of them - not ONE - have ever blocked me based on a SORBS listing.

So, Mozilla is sortof of out there on their own using this list to make blocking decisions.

I beg you to reconsider.",I've disabled dnsb.sorbs for now,"Thank you VERY much Ed!

As long as you're using zen's rbl (and you should be if you can), I don't think you'll notice any change - except no more complains from me... ;)

Anyway, much appreciated!",We are using spamhaus RBL's so yeah we are actually using zen,"While the server I managed was pretty low volume (less than a thousand emails per day), I found zen to be all I needed - and I did experiment with others, which is when I learned not to rely on SORBS for anything other than scoring, but I eventually dropped it altogether when examining the logs revealed it only ever scored emails that were legit anyway.

Anyway, again, thanks very much for doing this!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1293066,firefox: URL scheme bypasses localhost navigation blocking,FIXED,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7

Steps to reproduce:

Firefox for iOS runs its chrome: features on application local web server and it can be accessed through http://localhost:6571.
Navigation to localhost from any http(s): websites leads to security issues like Bug 1279787 so it has been blocked by Bug 1281204.
But this block can be bypassed by using firefox: URL scheme and it allows to launch chrome: features from any other apps e.g., Safari, on a device.



Actual results:

PoC: Open reader-view
firefox://?url=http://localhost:6571/reader-mode/page?url=https://tools.ietf.org/html/rfc6797

PoC: Exploit an open redirect in localhost
firefox://?url=http://localhost:6571/errors/error.html?url=http://a.csrf.jp/


Expected results:

The localhost navigation should be blocked even when it is opened through firefox: scheme.",*** Bug 1290714 has been marked as a duplicate of this bug. ***,Paying bounty for the combined attacks in bug 1290714,"Created attachment 8785451
Pull request","Comment on attachment 8785451
Pull request

Looks good!","master: https://github.com/mozilla/firefox-ios/commit/b86215912f6a8abeab670adfa15ccde3406bdbc8
v5.x: 9b5da75",*** Bug 1296941 has been marked as a duplicate of this bug. ***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1317366,webRequest throws when a blocking listener returns undefined,FIXED,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0
Build ID: 20161028133011

Steps to reproduce:

Tested the WebExtensions version of uBlock Origin 1.9.17b9:
https://github.com/gorhill/uBlock/releases/tag/1.9.17b9



Actual results:

When loading any web page, the browser console is filled with entries like:

result is undefined WebRequest.jsm:752
	HttpObserverManager.applyChanges< resource://gre/modules/WebRequest.jsm:752:1
	next self-hosted:1120:9
	TaskImpl_run resource://gre/modules/Task.jsm:319:42
	bound TaskImpl_run self-hosted:957:17

This is because the code at WebRequest.jsm:752 does not 1st check whether the returned value from a webRequest.onBeforeRequest listener is undefined, it assumes an Object is always returned.

However, the documentation regarding listeners for chrome.webRequest.onBeforeRequest et al says[1]:

> the callback can return a webRequest.BlockingResponse that determines
> the further life cycle of the request.

So as per documentation, a callback CAN return a BlockingResponse object for when a request has to be canceled or redirected. However, when no cancellation of redirection is needed, it is ok to return nothing, i.e. `undefined`.

[1] https://developer.chrome.com/extensions/webRequest


Expected results:

No such error in the browser console.","Created attachment 8810721
Bug 1317366: Handle blocking WebRequest listeners returning non-object values.

Review commit: https://reviewboard.mozilla.org/r/93030/diff/#index_header
See other reviews: https://reviewboard.mozilla.org/r/93030/","Comment on attachment 8810721
Bug 1317366: Handle blocking WebRequest listeners returning non-object values.

https://reviewboard.mozilla.org/r/93030/#review92938","Pushed by maglione.k@gmail.com:
https://hg.mozilla.org/integration/autoland/rev/69cd55731647
Handle blocking WebRequest listeners returning non-object values. r=mixedpuppy",https://hg.mozilla.org/mozilla-central/rev/69cd55731647,"Comment on attachment 8810721
Bug 1317366: Handle blocking WebRequest listeners returning non-object values.

Approval Request Comment
[Feature/regressing bug #]: But 1305217
[User impact if declined]: This bug prevents certain WebExtension request listeners from modifying or canceling requests.
[Describe test coverage new/current, TreeHerder]: The feature in question is extensively tested, and new tests have been added for this feature.
[Risks and why]: Very low. This patch simply adds an additional null check to promise resolution values which we previously performed only for non-promise values.
[String/UUID change made/needed]: None.","Comment on attachment 8810721
Bug 1317366: Handle blocking WebRequest listeners returning non-object values.

let's fix this regression from a couple of days ago in 52 aurora",https://hg.mozilla.org/releases/mozilla-aurora/rev/3375fcac31eb,"I can reproduce this issue on Firefox 53.0a1 (20161114043454) under Windows 7 64-bit and Ubuntu 16.04 LTS 32-bit,here is a video: http://screencast.com/t/3QbgwyDsED 

This issue is verified as fixed on Firefox 53.0a1 (20161123030208) and Firefox 52.0a2 (20161123004021) under Windows 7 64-bit and Ubuntu 16.04 LTS 32-bit, there is no WebRequest error in the Browser Console. Here is a video: http://screencast.com/t/IFHOL3TC0EAa",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1530050,Extend Content Blocking API to provide sensible anti-tracking defaults,FIXED,"STR:
 1. Install Android Reference Browser
  (https://groups.google.com/forum/#!forum/mozilla-reference-browser)

 2. In its settings, turn on tracking protection ""in normal browsing""

 3. Visit https://anightatthegarden.com/

EXPECTED RESULTS:
There should be an embedded video from vimeo.com at the top of the page.

ACTUAL RESULTS:
The embedded video is blocked.


I get ""expected results"" from:
 - Firefox Nightly on Android (with tracking protection)
 - Firefox Focus on Android (with all possible blocking enabled, including ""other content trackers"" which weren't blocked by default)
 - Firefox Nightly on Desktop (with content blocking bumped up to ""strict, may break pages"")
 - Reference browser **if I don't have tracking protection turned on**.

I only get ""actual results"" in Reference-Browser-with-tracking-protection-enabled.",Can Gecko View team please take a look at this?,"FWIW, I can reproduce this issue on default-configured Fenix as well (which I believe has tracking protection enabled by default and uses geckoview, so it's functionally equivalent to Reference-Browser-with-Tracking-Protection, from this bug's perspective).","Eugen, can you take a look?","The video is blocked by `ContentBlocking.AT_CONTENT` which should not be enabled by default (it's not enabled in GeckoView by default).
I assume that the apps use `ContentBlocking.AT_ALL` to set up tracking protection, which is not advisable since the content category will cause issues on some sites. `ContentBlocking.AT_CONTENT` can be added optionally through a more strict, non-default, setting.",Maybe it's worth splitting the catch-all `AT_ALL` into `AT_DEFAULT` and `AT_STRICT` or similar to prevent that issue and increase awareness for potential issues at the API level.,"In bug 1536488, I'm working on something similar where, AT_CONTENT is always enabled, but it's not notified and it's not considered as a tracking resource if privacy.trackingprotection.strict_list.enabled is set to false.","(In reply to Andrea Marchesini [:baku] from comment #6)

> In bug 1536488, I'm working on something similar where, AT_CONTENT is always enabled, but it's not notified and it's not considered as a tracking resource if privacy.trackingprotection.strict_list.enabled is set to false.

This might break and limit the options of the current GV API. Please make sure that we can still combine arbitrary tracker options in the GV [Content Blocking API](https://searchfox.org/mozilla-central/source/mobile/android/geckoview/src/main/java/org/mozilla/geckoview/ContentBlocking.java).","To clarify, this bug is not an API issue, it's an app configuration issue and doesn't require GV changes for the fix.

The proposed API change from comment 5 would just make the API clearer to the app developer, as it seems that `AT_ALL` is used as the default configuration by convenience and/or lack of a warning the in the `AT_CONTENT` documentation.

I'll re-purpose this bug to address the API improvement.","Created attachment 9053731
Bug 1530050 - [1.0] Add recommended and strict content blocking categories selections for safer app defaults.","Pushed by esawin@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/2ce7f6ee895d
[1.0] Add recommended and strict content blocking categories selections for safer app defaults. r=snorp,geckoview-reviewers",https://hg.mozilla.org/mozilla-central/rev/2ce7f6ee895d,67=wontfix because these new blocklist categories are experimental and not needed for Fenix MVP.,"(In reply to Chris Peterson [:cpeterson] from comment #12)

> 67=wontfix because these new blocklist categories are experimental and not needed for Fenix MVP.

I think you mean bug 1538337, but this bug is wontfix, too, because it's a non-essential change.
I've marked bug 1538337 67=wontfix.",*** Bug 1541632 has been marked as a duplicate of this bug. ***,*** Bug 1528585 has been marked as a duplicate of this bug. ***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1590067,Fingerprinting blocking and TP breaks nudatasecurity captcha on AARP,FIXED,"Created attachment 9102927
2019-10-21_14h15_41.png

Precondition: Go to Menu > Options > Privacy > Select Custom > Check ""Fingerprinters"" checkbox

Steps to reproduce:
1. Open Firefox
2. Access a site with captcha: https://secure.aarp.org/applications/user/login?request_locale=&referrer=https%3A%2F%2Fsecure.aarp.org%2Fapplications%2Facct%2FmyAccount.action

Actual result:
Captcha is not displayed.

Expected result:
Captcha should be displayed even if ""Fingerprinters"" is on.","This is due to fingerprinting protection blocking the captcha image from `nudatasecurity.com`. Note that no active content is loaded from `nudatasecurity.com`, only this image. If we allow images to load from `nudatasecurity.com` the captcha succeeds.

This is the same breakage we observe in Bug 1534922.

Specifically `https://api-us-east-1.nd.nudatasecurity.com/1.0/w/3.74.119619/w-712739/captcha?type=VIDEO&lang=eng&index=0&token=1.w-712739.1.2.hKmfMQBPtaSc5Ozz3V29Sg,,.9mMWHlHCrTASi0Q4r_2ITaViKNS-8gCJSrfC8htlWLunz-lN53vRTETi873iOCxGtPsemUk4BHC0ME7bbmgd5Ga0hR4y5PTnl9-xJYbVm7nOoJFXS7PnLuyuqXzqsLF9gVNUhDRnPIe9rT6po04Q0vWhBAYWy0ZVcINPFCHhXY9z4VvevDttvCKTVpkMAgjVyx6g81C66UddNRiPKXNO6ykLKlDqpF_SrinVLa3MzuDe0vtds_ko2PhOgUpn6boWkX_cr_-aV5gldrjWYkSDrVpoR6E7FGJmPpVWhCqu48NVO-wf2MMvEAjJZ9YMhyj-QyS6M04czhCs_furZ9LzEDeqPTygZ7KP1bBhdY9u5mySShre2EcBrXe-KUcglrcvXZ1ITEjDejQLqFLFLR1l1vKxexQbyeFMIusEanYIBrfWVc-PxS1UTyvB2gQa-m9E&r=rs-WzxaKLmsmFsmHtxsB8xjGgxx&ptype=SCRIPT`",I am not able to reproduce. Should we close this issue?,"(In reply to Youssef from comment #2)
> I am not able to reproduce. Should we close this issue?

Similar to Bug 1534922 it looks like AARP has updated the captcha subresource to be served from a subdomain of the first party rather than their third-party domain. i.e., (`https://nudata.aarp.org/1.0/w/3.74.119619/w-712739/captcha?type=VIDEO&...`). Thus, AARP is likely no longer broken.

I am able to successfully register for an account on Nightly, where the `nudatasecurity.com` blocklist rule is still active",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1507223,"The ""Allow"" argument for the PopupBlocking policy is not working",FIXED,"Created attachment 9025102
policies.json

[Affected versions]:
Firefox 65.0a1 (BuildId:20181114100226)
Firefox 64.0b9 (BuildId:20181112164519)
Firefox 63.0.1 (BuildId:20181030165643)
Firefox 60.3.0esr (BuildId:20181017185317)

[Affected platforms]:
Windows 10 64bit.
macOS 10.14.
Ubuntu 16.04 64bit.

[Preconditions]:
Place the attached .json file inside the ""distribution"" folder or allow PopupBlocking on several websites via GPO.

[Steps to reproduce]:
1. Launch Firefox.
2. Access the about:policies page.
3. Access the allowed websites specified inside the policy.

[Expected result]:
2. The policy is successfully displayed inside the about:policies page.
3. The following message is not being displayed :""Firefox prevented this site from opening pop-up windows"".

[Actual result]:
2. The PopupBlocking policy is not being displayed inside the about:policies page.
3. The ""Firefox prevented this site from opening pop-up windows"" string is displayed.

[Regression range]:
I don't think this is a regression.","The PopupBlocking schema only accepts an origin (i.e. http/https:// + domain), it can be used with a full page URL like in this file.

Was there any error displayed in about:policies?","The PopupBlocking policy only accepts an origin (i.e. http/https:// + domain), it _can't_ be used with a full page URL like in this file.

Was there any error displayed in about:policies?","(In reply to :Felipe Gomes (needinfo me!) from comment #2)
> The PopupBlocking policy only accepts an origin (i.e. http/https:// +
> domain), it _can't_ be used with a full page URL like in this file.

Indeed, it works only if the origin is specified.

> Was there any error displayed in about:policies?

There are no errors displayed inside the about:policies page if the full page URL is specified.","So should we trim the URL and use just the origin?

Is this a bug in the permissions manager?","If you put a URL into preferences, it automatically gets truncated to the origin before being sent to permissions manager...","I think we should trim and log a warning saying that only the origin should be used.

It's not a bug in the permissions manager, it's the intended behavior. It actually supports both origin-only or full paths, and it depends on the specific permission. The popup permission works with origins.","The schemas all say origin, so this is just getting ignored.

Since this is a pretty common thing to do, I think we should update the schema to allow origin and URL and then truncate URLs.","The intention of the ""origin"" type is to avoid any confusion here, because it might be dangerous that someone think it's just granting the permission for one unique URL, but it's actually granting the permission for the entire origin.

This used to cause a warning before, as any wrong item in an array type would cause the entire policy to fail validation. Now that is no longer true, this actually doesn't trigger the ""Invalid Policy"" error msg anymore.

So I don't think we should add a URL to the schema. What we can do is in make the origin validator [1] to emit a warning about it. And the `origin` validator itself could do the truncation together with this warning. (I'd prefer that it didn't truncate, only logged the error, but I could be convinced otherwise if you think it's very important)


[1] https://searchfox.org/mozilla-central/source/toolkit/components/utils/JsonSchemaValidator.jsm#189","Created attachment 9025799
Bug 1507223 - Show an error when full URL is used for permissions.","Pushed by mozilla@kaply.com:
https://hg.mozilla.org/integration/autoland/rev/b3787ede5d7b
Show an error when full URL is used for permissions. r=Felipe",https://hg.mozilla.org/mozilla-central/rev/b3787ede5d7b,"This is verified fixed using Firefox 65.0a1 (BuildId:20181120220133) on Windows 10 64bit, macOS 10.14 and Ubuntu 16.04 64bit.",Is this something that needs uplift consideration?,"Yes for 64, no for ESR.","Comment on attachment 9025799
Bug 1507223 - Show an error when full URL is used for permissions.

[Beta/Release Uplift Approval Request]

Feature/Bug causing the regression: None

User impact if declined: Admins don't know why popup errors weren't correct.

Is this code covered by automated tests?: No

Has the fix been verified in Nightly?: No

Needs manual test from QE?: No

If yes, steps to reproduce: 

List of other uplifts needed: None

Risk to taking this patch: Low

Why is the change risky/not risky? (and alternatives if risky): This is extremely low risk. Just adding an error message for this case.

String changes made/needed:","Comment on attachment 9025799
Bug 1507223 - Show an error when full URL is used for permissions.

better diagnostics for policy config issue, approved for 64.0b14",https://hg.mozilla.org/releases/mozilla-beta/rev/ec33377dad65,"This is verified fixed using Firefox 64.0 (BuildId:20181206201918) on Windows 10 64bit, macOS 10.14 and Ubuntu 16.04 64bit.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1530132,Whitelisted site allows all cookies requested by site to be saved when blocking all cookies,FIXED,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36

Steps to reproduce:

Versions tested:  65.0.1, 67.0a1

1.  Create new profile
2.  In 'Privacy & Security', select custom option to block all cookies
3.  Set site 'https://microsoft.com' to 'Allow' in 'Manage Permissions...'
4.  Visit site 'https://microsoft.com/'
5.  Open privacy options again and open 'Manage Data...' to view sites with saved data



Actual results:

Cookies are saved for websites not in whitelist.  eg.  In the case above, cookies from live.com & bing.com (plus others) are saved when these have not been explicitly allowed.


Expected results:

Only the cookies from microsoft.com should've been saved.  This was the behavior of the 'block all cookies' setting prior to version 65.0.",It seems by design. ni? ehsan to confirm,"Hi David,

Is it possible to get a regression range on this bug to see which changeset regressed it please?  Thanks!","I can reproduce the issue on Firefox65 and Nightly67.0a1 windows10 as well.

Regression Window:
https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=591fefb0f99c9d50325fe8e4b151aab7e1ba8691&tochange=bec76d96700206177d42ca13e789519bc7eb313a

Regressed By:
bec76d967002	Ehsan Akhgari — Bug 1502240 - Ensure that Content Blocking allow list is applied to all cookie policies r=baku","Thanks a lot for the regression range, Alice!

So we start here: https://searchfox.org/mozilla-central/rev/2a6f3dde00801374d3b2a704232de54a132af389/netwerk/cookie/nsCookieService.cpp#2087 and try to do an anti-tracking check.  That results in us taking this early return path from this branch <https://searchfox.org/mozilla-central/rev/2a6f3dde00801374d3b2a704232de54a132af389/toolkit/components/antitracking/AntiTrackingCommon.cpp#1336> because there is a cookie permission for the top-level domain (microsoft.com).

Then we get to this check: https://searchfox.org/mozilla-central/rev/2a6f3dde00801374d3b2a704232de54a132af389/netwerk/cookie/nsCookieService.cpp#4046.  But here we have the wrong information.  We accept the cookie but we should actually reject it because the result of the anti-tracking check should be a failure.

I think this shows a bug in the anti-tracking backend...  It seems to me that we shouldn't be calling CheckCookiePermissionForPrincipal() on the top-level principal, since that means performing a cookie permission check on the origin of the top-level page rather than the channel performing the load.  Andrea, what do you think?",Thank you Alice!,Ehsan is this something you might work on? I can keep tracking it into the 66 release. Since it is a privacy issue we could potentially consider including a fix in late beta or even in a dot release.,"I'm waiting on Andrea to respond to my question in comment 4, I'm not yet sure how to proceed here...  Let me email him to remind him.","Created attachment 9049088
Bug 1530132 - Consider the cookie permission for the current request, ignoring the top-level one, r?ehsan",This regression was introduced by bug 1480780. I think it's resoneable to consider just the current cookie permission and not the top-level one.,"Great, yes, this is exactly what I had in mind too.  Thanks for confirming.

I actually posted your patch to try yesterday and it's green.  :-)

https://treeherder.mozilla.org/#/jobs?repo=try&revision=9912c7022822c8efdf4f1c72e8c90a7396c681b2",I'm gonna land this on inbound to expedite things.  Can you please ask for approval for beta?,"Pushed by eakhgari@mozilla.com:
https://hg.mozilla.org/integration/mozilla-inbound/rev/7619b9307278
Consider the cookie permission for the current request, ignoring the top-level one; r=ehsan","Comment on attachment 9049088
Bug 1530132 - Consider the cookie permission for the current request, ignoring the top-level one, r?ehsan

### Beta/Release Uplift Approval Request
* **Feature/Bug causing the regression**: Bug 1480780
* **User impact if declined**: More cookies are stored then what we should if the user has custom cookie permissions
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: There is a STR on the bug descritpion
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch removes a cookie permission check. That was introduced wrongly and it's about Anti-Tracking only. Low risk.
* **String changes made/needed**: none","Pushed by amarchesini@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/12d0f0ba867a
Consider the cookie permission for the current request, ignoring the top-level one, r=Ehsan",https://hg.mozilla.org/mozilla-central/rev/7619b9307278,https://hg.mozilla.org/mozilla-central/rev/12d0f0ba867a,"Comment on attachment 9049088
Bug 1530132 - Consider the cookie permission for the current request, ignoring the top-level one, r?ehsan

I'd like this in the RC, and it's the last minute, 
so let's uplift now and verify after.",https://hg.mozilla.org/releases/mozilla-beta/rev/9374f09f9b17,"I managed to reproduce the issue using an older version on Nightly (2019-02-23)  on Windows 10 x63.
I verified the fix using latest Nightly on macOS 10.13 and Ubuntu 18.04 x64 and the bug is not reproducing.

HOwever on Windows 10 x64 I can still reproduce the issue using the latest Nightly 67.0a1.",This isn't a platform specific regression but rather an intermittent one.  I'll file another bug on it.,"BTW that's a regression from bug 1525245 not this one, so it doesn't affect beta.",Bug 1535380 is the said bug.,I will take out the qe-verify + flag from this bug and I will follow the Bug 1535380.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1544904,"Content blocking preferences have bad contrast, drab colors in dark mode",FIXED,"Created attachment 9058723
preferences-content-blocking.png

STR:

1. enable browser.in-content.dark-mode
2. Enable dark mode in OS 
3. Navigate to about:preferences#privacy

What happens:

* Description text near ""Standard"" is black instead of a color with more contrast. 
* borders and fill around accordions are drab - my feeling is that both should be brighter.

Expected result:

Nicer colors/contrast for text and fills in dark mode.","Created attachment 9058863
Bug 1544904 - Fix privacy section colors in dark mode. r=johannh","Created attachment 9058864
Screenshot of patch","Pushed by ntim.bugs@gmail.com:
https://hg.mozilla.org/integration/autoland/rev/be19414dbe25
Fix privacy section colors in dark mode. r=johannh",https://hg.mozilla.org/mozilla-central/rev/be19414dbe25,"I managed to reproduce the issue using an older version of Nightly (2019-05-07) on Windows 10 x64.
I retested everything using latest Nightly 69.0a1 and Firefox 68.0b12 on Windows 10 x64 and the bug is not reproducing anymore.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1543001,Content Blocking Exceptions not honored on initial load,FIXED,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0

Steps to reproduce:

I've reproduced this on Firefox Nightly 68.0a1 (2019-04-08) 64-bit on Windows 10.

Fresh install -> Options -> Privacy & Security -> Content Blocking ""Custom"" -> Cookies  => ""All cookies""

Go to any web page that have login and rely on cookies for you to log in and ""Turn off blocking for this site"" proceed to log in. Try to open some of their links when you're logged in in a new tab. Go to tab and see you're not logged in, proceed to hi F5 to resolve the issue and you are logged in. You can also revisit a site you know you're logged in to and you will also notice your not logged in when the site initially load, and you have to refresh to be logged in. 


Actual results:

The initial load of a site in the content blocking exception list does not seem to be honored in initial load. 


Expected results:

I would expect sites I've added to the content blocking exception list to send their cookies on the initial load of the website.","Baku, can you take a look at this, please? Thanks!","Created attachment 9056961
Bug 1543001 - ContentBlocking exception should cover top-level domain too, r?ehsan","Pushed by amarchesini@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/df1a7989c777
ContentBlocking exception should cover top-level domain too, r=Ehsan","Backed out changeset df1a7989c777 (Bug 1543001) on baku's request

Backout link: https://hg.mozilla.org/integration/autoland/rev/48bd7508a9b0345274f93b5eed2e02df3bce9803","Pushed by amarchesini@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/de4994d56894
ContentBlocking exception should cover top-level domain too, r=Ehsan","Backed out changeset de4994d56894 (Bug 1543001) on baku's request

Backout link: https://hg.mozilla.org/integration/autoland/rev/807c9b44e7acd076782bf986766ee9f64b1e06df","Pushed by amarchesini@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/3c05054698e1
ContentBlocking exception should cover top-level domain too, r=Ehsan",https://hg.mozilla.org/mozilla-central/rev/3c05054698e1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1496375,The toggle off behavior of Content Blocking is inconsistent between the Burger menu and about:Preferences,FIXED,"Created attachment 9014345
Inconsistency between burger menu toggle and preferences toggle.gif

[Affected versions]:

- 63.0b11
- 64.0a1 (2018-10-03)
- 63.0b1 DevEd 

[Affected platforms]:
- Windows 10x64
- macOS 10.13.6
- Ubuntu 16.04

[Steps to reproduce]:

Precondition: Content Blocking must be enabled (set browser.contentblocking.ui.enabled to true and restart the browser) if isn't already.

1. Launch Firefox

2. Visit any website (ex: imdb.com).

3. Open the URL bar site information doorhanger.

4. Click to Add Blocking for Slow-Loading Trackers.

5. Check the Slow-Loading Trackers option from about:preferences#privacy from the Content Blocking section

6.Return to the visited website tab and check the URL bar site information doorhanger.(The Slow-Loading Trakers now appear as Blocked)

7.Go to the Burger Menu and disable the Content Blocking feature from the toggle button.

8.Return to the URL doorhanger, notice the red Disabled tag and the fact that Slow-Loading Trackers appear as blocked.

9.Return to the Burger menu and re-activate the Content Blocking feature from the toggle button.

10.Visit about:preferences#privacy ,Content Blocking section, and disable the feature from there.

11.Return to the visited website tab, check the URL doorhanger.
  
[Expected result]:

- The doorhanger information for Content blocking should be displayed in the same manner like in Step 8.

[Actual result]:

- The doorhanger information for Content blocking is inconsistent when disabling the feature from ""about:preferences#privacy"" vs the ""Burger Menu"" .
This time , the Disabled red tag is displayed, however none of the previously saved blocking options will be saved.(""Add blocking..."" option will be displayed instead of ""Blocked""

[Regression range]:

-This seems to be a recent regression: 
https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=ba7f9ff7e4c528f35042ca72cc345353d655e560&tochange=bcdbc281a48d53c76737abd2ab776deefaf59338

[Additional notes]:

- Keeping in mind that both toggle buttons of the Content Blocking ,that are found in ""about:preferences#privacy"" & ""Burger Menu"" ,have the same(On/Off)function it makes sense that both must render the same information in the URL doorhanger for both cases.

My suggestion would be that the most useful way to the user to display this information when disabling the feature would be with the Red Disabled tag alongside with the previously blocked options marked with the grey Blocked text.","So in one case it says ""Add Blocking..."" and in the other ""Blocked""? Huh, interesting bug but it seems like an edge case.","Hello Johann,

Please take your time and re-visit the issue carefully.

The fact that the user has 2 different behaviors of the Content Blocking doorhanger information with the action of basically the same Off button (just in two different locations) is a huge inconsistency issue.

And it is not at all an Edge case; All the user has to do is simply set up the types of blocks he is interested in, and disable the Content blocker feature from about:preferences#privacy, then re-visit the URL site information doorhanger.

Reading the STR carefully ,it can be noticed that it is a description comparison between disabling the feature from the Hamburger Menu vs from about about:preferences#privacy.

The fact still remains that the user simply has to disable (toggle off)  the feature from about:preferences#privacy and all the block types will be lost (and will only return when turning the feature back ON, from the same section,not from the burger menu) ;not even a page refresh will fix this problem.","I'm not sure why this is happening.  In both cases (whether you disable from hamburger menu or from the Preferences menu, the browser.fastblock.enabled is still true, so we are preserving the global state.  I'm not sure why it is propogating differently when you turn off Content Blocking from the hamburger menu.  The Control Center doesn't seem to update in the case when you make the change from the hamburger menu.

But note, when I refresh or even just switch tabs for a second and come back, the Control Center is up to date with the ""Add Blocking..."" text.  Given this, it may just be a short delay in control center updating.

But Vlad reports that the issue persists after refresh.  I cannot reproduce that.

Either way, this seems like a P3.  Also, note that in Firefox 63 we will not be exposing the global toggle.  This was recently decided.  The global toggle probably won't be available until 65.","The hamburger toggle button is turned off on beta, adjusting 63 status accordingly.","Created attachment 9015956
Bug 1496375 - Update the blocker category states when the content blocking pref value changes","Pushed by eakhgari@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/0abcb61b9fc1
Update the blocker category states when the content blocking pref value changes r=johannh",https://hg.mozilla.org/mozilla-central/rev/0abcb61b9fc1,"Hello all,

There are several issues here that need to be addressed before I can leave a resolution for this ticket.

This ticket has been marked as fixed in 64. But as you can see in Comment 3 and Comment 4 , it states that the toggle buttons will not be present at all for that beta. I can confirm this as the toggle buttons are not present at all in all of the 64 betas released so far.

And as you can see in Comment 3, Tanvi stated that ""The global toggle probably won't be available until 65."" . I can also confirm that the buttons were present in Nightly, but only from the first 65.0a1 (2018-10-22) build until 65.0a1 (2018-10-27). All of the other nightly releases after that (including the latest 65.0a1 (2018-10-30)) are without the toggle buttons.

If someone has the time, could you please help me clarify these issues? 
Thank you in advance.",The toggle buttons were removed for good and I don't think needs any further verification :),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1403421,mips64 performance tools profiler,FIXED,"User Agent: Mozilla/5.0 (X11; Linux mips64; rv:57.0) Gecko/20100101 Firefox/57.0
Build ID: 20170925180245

Steps to reproduce:

on mips64-linux platform,
./mach configure
./mach build


Actual results:

error ""Unsupported platform""


Expected results:

can build sucessfully.","Created attachment 8912498
Bug-1403421-supporting-mips64-linux-performance, tools-profiler","Comment on attachment 8912498
Bug-1403421-supporting-mips64-linux-performance, tools-profiler

Thanks for the patch, but I would cancel the request since I am not the right person to review mips64 support of the gecko profiler.

Also please include 8 lines of context in the patch. See https://developer.mozilla.org/en-US/docs/Mercurial/Using_Mercurial#How_can_I...","Comment on attachment 8912498
Bug-1403421-supporting-mips64-linux-performance, tools-profiler

Review of attachment 8912498:
-----------------------------------------------------------------

I don't know anything about MIPS, but this all looks reasonable. I assume you have actually run the profiler on MIPS64/Linux and confirmed that it works?

You haven't defined HAVE_NATIVE_UNWIND, so you will get pseudostacks but no native stack traces.

MIPS qualifies as a tier 3 platform (see https://developer.mozilla.org/en-US/docs/Supported_build_configurations for an explanation) so it's possible that this code will get broken and you'll be responsible for maintaining it. Having said that, this patch is little enough code that it's unlikely to get broken.

Can I ask why you are interested in running the profiler on MIPS/Linux?

::: tools/profiler/core/PlatformMacros.h
@@ +62,5 @@
>  
> +#elif defined(__linux__) && defined(__mips64)
> +# define GP_PLAT_mips64_linux 1
> +# define GP_ARCH_mips64 1
> +# define GP_OS_linux 1

Please add GP_PLAT_mips64_linux and define GP_ARCH_mips64 to the list of #undef'd constants at the top of this file.

::: tools/profiler/core/platform-linux-android.cpp
@@ +104,5 @@
>    aRegs.mLR = reinterpret_cast<Address>(mcontext.regs[30]);
> +#elif defined(GP_ARCH_mips64)
> +  aRegs.mPC = reinterpret_cast<Address>(mcontext.pc);
> +  aRegs.mSP = reinterpret_cast<Address>(mcontext.gregs[29]);
> +  aRegs.mFP = reinterpret_cast<Address>(mcontext.gregs[30]);

Are the MIPS registers really the same names as the ARM ones? Interesting.","(In reply to Nicholas Nethercote [:njn] from comment #3)
> Comment on attachment 8912498
> Bug-1403421-supporting-mips64-linux-performance, tools-profiler
> 
> Review of attachment 8912498:
> -----------------------------------------------------------------

> 
> ::: tools/profiler/core/platform-linux-android.cpp
> @@ +104,5 @@
> >    aRegs.mLR = reinterpret_cast<Address>(mcontext.regs[30]);
> > +#elif defined(GP_ARCH_mips64)
> > +  aRegs.mPC = reinterpret_cast<Address>(mcontext.pc);
> > +  aRegs.mSP = reinterpret_cast<Address>(mcontext.gregs[29]);
> > +  aRegs.mFP = reinterpret_cast<Address>(mcontext.gregs[30]);
> 
> Are the MIPS registers really the same names as the ARM ones? Interesting.



This is right. 
ARM's is ""mcontext.regs""  while MIPS is  ""mcontext.gregs"".
You can identify it in mips-linux OS ,usually path ""/usr/include/sys/ucontext.h"".

My PC is mips64 Fedora21.
qiao:~/work_qiao/linux-3.10$ uname -a
Linux localhost.localdomain 3.10.84-16.fc21.loongson.mips64el #1 SMP PREEMPT Fri Jul 21 15:36:21 CST 2017 mips64 mips64 mips64 GNU/Linux

firefox is
57.0a1 (2017-09-27) (64-bit)

and the menu ---> Web Developer ---> Performance, be used normally under safemode.

Also working in firefox52 and firefox45 sucessfully, while the codes of firefox52 and firefox45 are only in our opensource git respository.


Why we are interested in running the profiler on MIPS/Linux?
Because we are working in a Chinese CPU designing company while CPU arch is mips64.
We have to porting the opensource softwares related mips64.


We also realized that mips64-linux desktop-PC is popular, like our mozilla community.","Created attachment 8913089
ucontext.h","Hi Nicholas.

the attach file ""ucontext.h"" has been uploaded.","(In reply to Nicholas Nethercote [:njn] from comment #3)
> Comment on attachment 8912498
> Bug-1403421-supporting-mips64-linux-performance, tools-profiler
> 
> Review of attachment 8912498:
> -----------------------------------------------------------------
> 
> I don't know anything about MIPS, but this all looks reasonable. I assume
> you have actually run the profiler on MIPS64/Linux and confirmed that it
> works?
> 
> You haven't defined HAVE_NATIVE_UNWIND, so you will get pseudostacks but no
> native stack traces.
> 
> MIPS qualifies as a tier 3 platform (see
> https://developer.mozilla.org/en-US/docs/Supported_build_configurations for
> an explanation) so it's possible that this code will get broken and you'll
> be responsible for maintaining it. Having said that, this patch is little
> enough code that it's unlikely to get broken.
> 
>

HAVE_NATIVE_UNWIND
 Bug-1403438-add-profiler-lul-on-mips64-linux for https://bugzilla.mozilla.org/show_bug.cgi?id=1403438","Created attachment 8913112
Bug-1403421-supporting-mips64-linux-performance.patch","Comment on attachment 8913112
Bug-1403421-supporting-mips64-linux-performance.patch

Review of attachment 8913112:
-----------------------------------------------------------------

As mentioned elsewhere, you only need to ask one person to review each change.

Just one small thing to fix, see below. Thanks.

::: tools/profiler/core/PlatformMacros.h
@@ +20,5 @@
>  #undef GP_PLAT_amd64_linux
>  #undef GP_PLAT_amd64_darwin
>  #undef GP_PLAT_x86_windows
>  #undef GP_PLAT_amd64_windows
> +#undef GP_PLAT_mips64_linux

These are grouped by OS, so please move the new entry just below GP_PLAT_amd64_linux.","Created attachment 8913493
Bug-1403421-supporting-mips64-linux-performance.patch","Created attachment 8913495
Bug-1403421-supporting-mips64-linux-performance.patch","Comment on attachment 8913495
Bug-1403421-supporting-mips64-linux-performance.patch

Review of attachment 8913495:
-----------------------------------------------------------------

Looks good! Thank you for the changes.

Have you done a try push to make sure it builds on all Tier-1 platforms? I'm not sure if you are familiar with try pushes; if not, https://wiki.mozilla.org/ReleaseEngineering/TryServer has the details. A run with the configuration of ""try: -b do -p all -u none -t none"" will be fine for that patch.

If you don't have Level 1 access required to do a try push, I can do it for you, but I won't get to it until Monday next week.","(In reply to Nicholas Nethercote [:njn] from comment #12)
> Comment on attachment 8913495
> Bug-1403421-supporting-mips64-linux-performance.patch
> 
> Review of attachment 8913495:
> -----------------------------------------------------------------
> 
> Looks good! Thank you for the changes.
> 
> Have you done a try push to make sure it builds on all Tier-1 platforms? I'm
> not sure if you are familiar with try pushes; if not,
> https://wiki.mozilla.org/ReleaseEngineering/TryServer has the details. A run
> with the configuration of ""try: -b do -p all -u none -t none"" will be fine
> for that patch.
> 
> If you don't have Level 1 access required to do a try push, I can do it for
> you, but I won't get to it until Monday next week.


Hi,Nicholas!
Should I reupload the patch ?
I pulled down the inbound code yesterday, and tested the performance is OK after adding the patch.","If you have an updated version, please attach it to this bug.","Created attachment 8924814
inbound_58.0a1.png","(In reply to Nicholas Nethercote [:njn] from comment #14)
> If you have an updated version, please attach it to this bug.

This is the newest patch.
I have tested on firefox-Nightly-58.0a1 (2017-11-03) (64-bit) with this patch.","Pushed by ryanvm@gmail.com:
https://hg.mozilla.org/integration/mozilla-inbound/rev/9bbac53ac792
Support mips64-linux performance. r=njn",https://hg.mozilla.org/mozilla-central/rev/9bbac53ac792,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1447655,Permafailing dom/tests/browser/browser_test_performance_metrics.js when Gecko 61 merges to Beta on 2018-04-26,FIXED,"central-as-beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&revision=fa433fbdb02587a62348fd0b517e856648a9ce90&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable&selectedJob=169406062

Log: https://treeherder.mozilla.org/logviewer.html#?job_id=169406062&repo=try

TEST-UNEXPECTED-FAIL | dom/tests/browser/browser_test_performance_metrics.js | This test contains no passes, no fails and no todos. Maybe it threw a silent exception? Make sure you use waitForExplicitFinish() if you need it. -","Created attachment 8960942
Bug 1447655 - Only run dom/tests/browser/browser_test_performance_metrics.js on Nightly.

Review commit: https://reviewboard.mozilla.org/r/229694/diff/#index_header
See other reviews: https://reviewboard.mozilla.org/r/229694/","r+ from my side

sorry, I have used if (!AppConstants.RELEASE_OR_BETA) and thought it was enough...","Comment on attachment 8960942
Bug 1447655 - Only run dom/tests/browser/browser_test_performance_metrics.js on Nightly.

https://reviewboard.mozilla.org/r/229694/#review235534","Pushed by archaeopteryx@coole-files.de:
https://hg.mozilla.org/integration/autoland/rev/39cbb31ba54c
Only run dom/tests/browser/browser_test_performance_metrics.js on Nightly. r=baku",https://hg.mozilla.org/mozilla-central/rev/39cbb31ba54c,Verified fixed with latest uplift simulation: https://treeherder.mozilla.org/#/jobs?repo=try&revision=811e2ea438a88cb9e407f4ab66387bc2c18d0f35&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable&group_state=expanded,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1448446,browser/base/content/test/performance/browser_windowopen.js will permfail for DevEdition when Gecko 61 merges to Beta on 2018-04-26,FIXED,"central-as-beta simulations (also covers DevEditions) have revealed that browser/base/content/test/performance/browser_windowopen.js permafails for OS X DevEdition opt:

https://treeherder.mozilla.org/#/jobs?repo=try&revision=fcada7dffac6f3f6ec64d86d00a565495d781996&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable&group_state=expanded&selectedJob=169841889

Log: https://treeherder.mozilla.org/logviewer.html#?job_id=169841889&repo=try

TEST-UNEXPECTED-FAIL | browser/base/content/test/performance/browser_windowopen.js | unexpected changed rect: ({x1:110, x2:124, y1:46, y2:59, w:15, h:14}), window width: 1280 -
TEST-UNEXPECTED-FAIL | browser/base/content/test/performance/browser_windowopen.js | should have 0 unknown flickering areas - Got 1, expected 0","Created attachment 8962106
Patch

I don't think this is related to bug 1443578, it's just that somehow the reload icon height is now identified as taking 14px rather than 13px in devedition.","Created attachment 8962107
remove unused browser_windowopen_flicker.js test file

Somehow when rebasing the merge of browser_windowopen_reflows.js and browser_windowopen_flicker.js, the deletion of browser_windowopen_flicker.js got lost. This file is already removed from the browser.ini manifest.","Comment on attachment 8962107
remove unused browser_windowopen_flicker.js test file

Review of attachment 8962107:
-----------------------------------------------------------------

Whoops - yeah, thanks for removing this.","Comment on attachment 8962106
Patch

Review of attachment 8962106:
-----------------------------------------------------------------

Thanks!","Pushed by florian@queze.net:
https://hg.mozilla.org/integration/mozilla-inbound/rev/2d437fbde070
accept a height of 14px for the reload icon in the browser_windowopen.js exception, r=mconley.
https://hg.mozilla.org/integration/mozilla-inbound/rev/ec1fc0649f4e
remove unused browser_windowopen_flicker.js test file, r=mconley.","https://hg.mozilla.org/mozilla-central/rev/2d437fbde070
https://hg.mozilla.org/mozilla-central/rev/ec1fc0649f4e",Verified fixed with latest central-as-beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&revision=a3ba256ed5f1c30dc9bf7a3c7897a8b898e4590c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable&group_state=expanded,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1521209,about:performance content hidden behind header with  localized builds.,FIXED,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0

Steps to reproduce:

Open about:performance page.

FTR, I did it using latest nightly release (66.0a1 from 2019-01-18 on Debian sid).


Actual results:

The first element in the table is partially hidden behind the table header.
Zooming in or out or changing window size has no effect.


Expected results:

No overlap :-)

Manually removing from the page CSS the above parameter fixes the issue:
#dispatch-thead { position: fixed; }
To avoid getting empty space, at least one of the above should also be disabled (both being fine):
#dispatch-tbody { display: block; }
#dispatch-tbody { margin-top: 2em; }","I do not see any overlapping in my current windows and Linux (ubuntu) nightly in about:performance.
Could you please attach a screenshot ?","Created attachment 9037785
Nightly_about:performance_french.png

Here you are for a screenshot.

In case it can help, I am using a French locale (fr_FR).

It seems that width limit for “Energetic impact” (or something like that) column results in two lines for the header. If I remove the width from the CSS, it also result in no more overlap.","I think you are right that the line wrap of ""Energetic impact"" is causing this. 
confirming based on the screenshot.",*** Bug 1523654 has been marked as a duplicate of this bug. ***,*** Bug 1524038 has been marked as a duplicate of this bug. ***,"this got reported from french, russian and greek locales so far.","Tarek, can you help find an owner to work on this? I'd like to see us fix it in 67 and 66 beta since many users are reporting it.","If it just ends up being a simple CSS fix or something, I'd consider it for a 65 dot release ride-along too.",*** Bug 1524403 has been marked as a duplicate of this bug. ***,*** Bug 1524405 has been marked as a duplicate of this bug. ***,"also need-infoing florian, since he worked on most off this stuff...","This was already reported at bug 1511637. I don't have an easy solution, so I guess if we need a quick fix, we'll just have to increase a bit the width of that column.","(In reply to Florian Quèze [:florian] from comment #12)

> This was already reported at bug 1511637. I don't have an easy solution, so I guess if we need a quick fix, we'll just have to increase a bit the width of that column.

In the regression triage meeting today we discussed how due to the prominence of the new about:performance in 65, if possible, a quick fix would be ideal for a 65.0.1 ride-along with a better long-term fix post-65.0.x.",wfm,"Created attachment 9041897
Bug 1521209 - Give more space for the 'Energy Impact' column header, and ensure it never wraps, r=felipe.","I tried a French localized nightly on OS X, Ubuntu and Windows 10 and couldn't reproduce. The Russian string is even longer than the French one, and I could reproduce the bug when using that string (putting that string in using the devtools inspector). Bug 1524038 says that 11em as a column width is good to fix it for Russian. I put a width of 12em in the patch to be safe.

I looked at https://transvision.mozfr.org/string/?entity=toolkit/toolkit/about/aboutPerformance.ftl:column-energy-impact&repo=gecko_strings to see if we have even longer strings that wouldn't fit within 12em. The only one that doesn't fit is the string for the gd locale: ""Buaidh air caitheamh dealain"". This would need 14em to fit... but 14em means a lot of empty space when 8em is enough for most locales. We should probably ask if the translation can be changed to a shorter wording. ni?flod for this.

The other CSS change ensures that if we have a column with a header that can't fit, it won't wrap and the overflow will just be hidden.","(In reply to Florian Quèze [:florian] from comment #16)

> We should probably ask if the translation can be changed to a shorter wording. ni?flod for this.

I really believe we should figure out how to make the layout not break for long translations. Asking to shorten translation, especially on desktop where space shouldn't be an issue, is a process that doesn't scale.

I understand you want a contained fix for uplift, and that's reasonable. But that shouldn't be the long term solution.

Would it be an option to have 2 lines of text available in the thead by default?","Created attachment 9041912
2 rows header","thank you for the stop gap fix - since this may get included into a 65.0.1 release per comment #8, could you please request uplift for beta and release? (it would be nice if it can be included in 66.0b6 still that's built tomorrow to have people try it out before the fix is ending up on release)","(In reply to Francesco Lodolo [:flod] from comment #17)

> Would it be an option to have 2 lines of text available in the thead by default?

I think that would be ugly when all the labels fit on a single line. But that's really more a question for UX (Bryan Bell cc'ed).","Pushed by fqueze@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/c679fa99e878
Give more space for the 'Energy Impact' column header, and ensure it never wraps, r=Felipe.",https://hg.mozilla.org/mozilla-central/rev/c679fa99e878,"Comment on attachment 9041897
Bug 1521209 - Give more space for the 'Energy Impact' column header, and ensure it never wraps, r=felipe.

## Beta/Release Uplift Approval Request

### Feature/Bug causing the regression

about:performance

### User impact if declined

The first line in about:performance may be invisible in some locales with some font settings.

### Is this code covered by automated tests?

No

### Has the fix been verified in Nightly?

No

### Needs manual test from QE?

Yes

### If yes, steps to reproduce

Use Firefox in a locale where the ""Energy Impact"" label is translated by a longer string.

### List of other uplifts needed

None

### Risk to taking this patch

Low

### Why is the change risky/not risky? (and alternatives if risky)

Minimal CSS change

### String changes made/needed

none","Comment on attachment 9041897
Bug 1521209 - Give more space for the 'Energy Impact' column header, and ensure it never wraps, r=felipe.

[Triage Comment]
Adds a bit more room to the Energy Impact column to avoid wrapping in some locales. Approved for 66.0b6.",https://hg.mozilla.org/releases/mozilla-beta/rev/d1a2c9425127,"Comment on attachment 9041897
Bug 1521209 - Give more space for the 'Energy Impact' column header, and ensure it never wraps, r=felipe.

[Triage Comment]
Simple fix for cut-off content in about:performance for some locales. Approved for 65.0.1.",https://hg.mozilla.org/releases/mozilla-release/rev/ca68db064405,"I have managed to reproduce the issue using Fx 66.0a1 with a RU and EL (greek) locale. The issue was not occurring for the FR (french) locale on that same build.

The issue is verified fixed using Fx 67.0a1, Fx66.0b6 and Fx65.0.1(downloaded from taskcluster) for the RU, EL and FR locale. The about:performance header no longer overlaps the first line.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1550769,Perma browser/base/content/test/performance/browser_startup_content_mainthreadio.js - when Gecko 68 merges to Beta on 2019-05-13,FIXED,"[Tracking Requested - why for this release]:

Central as beta simulation:

Treeherderlink: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel%2Crunnable&revision=3dbfef64b85107276c8ea489d287b0b67ef6c1fa&selectedJob=245739904

Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=245739904&repo=try&lineNumber=991

12:31:06     INFO - TEST-START | browser/base/content/test/performance/browser_startup_content_mainthreadio.js
12:31:06     INFO - TEST-INFO | started process screencapture
12:31:07     INFO - TEST-INFO | screencapture: exit 0
12:31:07     INFO - Buffered messages logged at 12:31:06
12:31:07     INFO - Entering test bound 
12:31:07     INFO - whitelisted paths for Web Content process:
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/omni.ja - stat: 1
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/browser/omni.ja - stat: 1
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/chrome.manifest - stat: 1, close: 1
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/browser/chrome.manifest - stat: 1, close: 1
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/browser/features/webcompat@mozilla.org.xpi - stat: 1
12:31:07     INFO -   /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/browser/features/formautofill@mozilla.org.xpi - stat: 1
12:31:07     INFO - TEST-PASS | browser/base/content/test/performance/browser_startup_content_mainthreadio.js | Found profile for Web Content process - 
12:31:07     INFO - TEST-PASS | browser/base/content/test/performance/browser_startup_content_mainthreadio.js | stat on /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/omni.ja allowed 1 more times in Web Content process - 
12:31:07     INFO - Buffered messages finished
12:31:07     INFO - TEST-UNEXPECTED-FAIL | browser/base/content/test/performance/browser_startup_content_mainthreadio.js | unused whitelist entry Web Content: /Users/cltbld/tasks/task_1557491085/build/application/Firefox Developer Edition.app/Contents/Resources/omni.ja - 
12:31:07     INFO - Stack trace:
12:31:07     INFO - chrome://mochikit/content/browser-test.js:test_ok:1314
12:31:07     INFO - chrome://mochitests/content/browser/browser/base/content/test/performance/browser_startup_content_mainthreadio.js:null:399

This also appeared in yesterday beta sims: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception&revision=f93bb605459b4db524f5ecf50596ce01e85bea6e&selectedJob=245532264",This seems to only affect devedition builds. I don't understand why yet.,"24 failures in 360 pushes (0.067 failures/push) were associated with this bug yesterday.

Repository breakdown:
* try: 24

Platform breakdown:
* macosx64-devedition: 6
* linux64-devedition: 4
* windows10-64-devedition: 5
* windows7-32-devedition: 5
* linux32-devedition: 4

For more details, see:
https://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1550769&startday=2019-05-11&endday=2019-05-11&tree=all","24 failures in 4705 pushes (0.005 failures/push) were associated with this bug in the last 7 days.

Repository breakdown:
* try: 24

Platform breakdown:
* macosx64-devedition: 6
* linux64-devedition: 4
* windows7-32-devedition: 5
* linux32-devedition: 4
* windows10-64-devedition: 5

For more details, see:
https://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1550769&startday=2019-05-06&endday=2019-05-12&tree=all","18 failures in 746 pushes (0.024 failures/push) were associated with this bug yesterday.

Repository breakdown:
* mozilla-beta: 18

Platform breakdown:
* macosx64-devedition: 6
* windows7-32-devedition: 2
* windows10-64-devedition: 2
* linux64-devedition: 2
* linux32-devedition: 6

For more details, see:
https://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1550769&startday=2019-05-13&endday=2019-05-13&tree=all","The patch I have in bug 1550034 will address this by disabling the test on RELEASE_OR_BETA builds.

Bug 1532596 covers the way to make the platform piece that the test depends on work on beta builds.","20 failures in 4658 pushes (0.004 failures/push) were associated with this bug in the last 7 days.

Repository breakdown:
* mozilla-beta: 20

Platform breakdown:
* macosx64-devedition: 6
* windows7-32-devedition: 2
* windows10-64-devedition: 3
* linux64-devedition: 2
* linux32-devedition: 7

For more details, see:
https://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1550769&startday=2019-05-13&endday=2019-05-19&tree=all",Verified fixed with yesterday's beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Crunnable&revision=8b1bfa1389a764b7bbfd9538b0cd2e0301db5c16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1606082,"Perma devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js | Uncaught exception - [Exception... ""Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE)   when Gecko 73 merges to Beta on 2020-01-06",FIXED,"[Tracking Requested - why for this release]:

Treeherder link:  https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=ec95a9b6fb3da934dca8dacc4b0f419658e09c8e&selectedJob=282737487

Failure log:  https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=282737487&repo=try&lineNumber=8318

[task 2019-12-27T11:45:55.903Z] 11:45:55     INFO - TEST-START | devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js
[task 2019-12-27T11:45:55.950Z] 11:45:55     INFO - TEST-INFO | started process screentopng
[task 2019-12-27T11:45:56.573Z] 11:45:56     INFO - TEST-INFO | screentopng: exit 0
[task 2019-12-27T11:45:56.573Z] 11:45:56     INFO - Buffered messages logged at 11:45:55
[task 2019-12-27T11:45:56.573Z] 11:45:56     INFO - Entering test bound test
[task 2019-12-27T11:45:56.573Z] 11:45:56     INFO - Test that about:profiling can be loaded, and the features changed.
[task 2019-12-27T11:45:56.573Z] 11:45:56     INFO - TEST-PASS | devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js | This test assumes that the JavaScript feature is available on every platform. - 
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Begin to open about:profiling in a new tab.
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Buffered messages finished
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - TEST-UNEXPECTED-FAIL | devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js | Uncaught exception - [Exception... ""Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIAboutModule.getURIFlags]""  nsresult: ""0x80070057 (NS_ERROR_ILLEGAL_VALUE)""  location: ""JS frame :: resource://gre/modules/E10SUtils.jsm :: getRemoteTypeForURIObject :: line 439""  data: no]
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Stack trace:
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - getRemoteTypeForURIObject@resource://gre/modules/E10SUtils.jsm:439:28
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - getRemoteTypeForURI@resource://gre/modules/E10SUtils.jsm:388:17
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - addTab@chrome://browser/content/tabbrowser.js:2770:23
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - addTab@resource://testing-common/BrowserTestUtils.jsm:2159:23
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openNewForegroundTab/promises<@resource://testing-common/BrowserTestUtils.jsm:251:61
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - switchTab@resource://testing-common/BrowserTestUtils.jsm:371:7
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openNewForegroundTab@resource://testing-common/BrowserTestUtils.jsm:246:26
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - withNewTab@resource://testing-common/BrowserTestUtils.jsm:148:38
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openAboutProfiling@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:307:27
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - test@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js:15:9
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Tester_execTest/<@chrome://mochikit/content/browser-test.js:1062:34
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Tester_execTest@chrome://mochikit/content/browser-test.js:1097:11
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - nextTest/<@chrome://mochikit/content/browser-test.js:925:14
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - SimpleTest.waitForFocus/waitForFocusInner/focusedOrLoaded/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:808:67
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Leaving test bound test
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - Console message: [JavaScript Error: ""Failed to create tab"" {file: ""chrome://browser/content/tabbrowser.js"" line: 2849}]
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - addTab@chrome://browser/content/tabbrowser.js:2849:12
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - addTab@resource://testing-common/BrowserTestUtils.jsm:2159:23
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openNewForegroundTab/promises<@resource://testing-common/BrowserTestUtils.jsm:251:61
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - switchTab@resource://testing-common/BrowserTestUtils.jsm:371:7
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openNewForegroundTab@resource://testing-common/BrowserTestUtils.jsm:246:26
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - withNewTab@resource://testing-common/BrowserTestUtils.jsm:148:38
[task 2019-12-27T11:45:56.574Z] 11:45:56     INFO - openAboutProfiling@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:307:27
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - test@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js:15:9
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - Tester_execTest/<@chrome://mochikit/content/browser-test.js:1062:34
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - Tester_execTest@chrome://mochikit/content/browser-test.js:1097:11
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - nextTest/<@chrome://mochikit/content/browser-test.js:925:14
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - SimpleTest.waitForFocus/waitForFocusInner/focusedOrLoaded/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:808:67
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - 
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - Console message: [JavaScript Error: ""[Exception... ""Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIAboutModule.getURIFlags]""  nsresult: ""0x80070057 (NS_ERROR_ILLEGAL_VALUE)""  location: ""JS frame :: resource://gre/modules/E10SUtils.jsm :: getRemoteTypeForURIObject :: line 439""  data: no]""]
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - getRemoteTypeForURIObject@resource://gre/modules/E10SUtils.jsm:439:28
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - getRemoteTypeForURI@resource://gre/modules/E10SUtils.jsm:388:17
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - addTab@chrome://browser/content/tabbrowser.js:2770:23
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - addTab@resource://testing-common/BrowserTestUtils.jsm:2159:23
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - openNewForegroundTab/promises<@resource://testing-common/BrowserTestUtils.jsm:251:61
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - switchTab@resource://testing-common/BrowserTestUtils.jsm:371:7
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - openNewForegroundTab@resource://testing-common/BrowserTestUtils.jsm:246:26
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - withNewTab@resource://testing-common/BrowserTestUtils.jsm:148:38
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - openAboutProfiling@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:307:27
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - test@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js:15:9
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - Tester_execTest/<@chrome://mochikit/content/browser-test.js:1062:34
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - Tester_execTest@chrome://mochikit/content/browser-test.js:1097:11
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - nextTest/<@chrome://mochikit/content/browser-test.js:925:14
[task 2019-12-27T11:45:56.575Z] 11:45:56     INFO - SimpleTest.waitForFocus/waitForFocusInner/focusedOrLoaded/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:808:67
[task 2019-12-27T11:45:56.576Z] 11:45:56     INFO - 
[task 2019-12-27T11:45:56.576Z] 11:45:56     INFO - GECKO(2858) | MEMORY STAT vsizeMaxContiguous not supported in this build configuration.
[task 2019-12-27T11:45:56.576Z] 11:45:56     INFO - GECKO(2858) | MEMORY STAT | vsize 2827MB | residentFast 361MB | heapAllocated 149MB
[task 2019-12-27T11:45:56.577Z] 11:45:56     INFO - TEST-OK | devtools/client/performance-new/test/browser/browser_aboutprofiling-features.js | took 235ms

Greg, please take a look.","Created attachment 9117884
Bug 1606082 - Skip about:profiling tests when not on nightly; r?gerald

Currently, the panel is nightly only while it is in development.","Pushed by gtatum@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/3b42cd213461
Skip about:profiling tests when not on nightly; r=gerald",https://hg.mozilla.org/mozilla-central/rev/3b42cd213461,"Verified as fixed with this beta sim: 
https://treeherder.mozilla.org/#/jobs?repo=try&revision=caf7e37d9e3fc92cf82a20bee271beba0dbc78dd&searchStr=linux%2Cx64%2Cdebug%2Cmochitests%2Ctest-linux64%2Fdebug-mochitest-devtools-chrome-e10s-4%2Cm%28dt4%29&selectedJob=282831979",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1614667,Perma devtools/client/performance-new/test/browser/browser_webchannel-enable-menu-button.js | Test timed out - when Gecko 75 merges to Beta on 2020-03-09,FIXED,"[Tracking Requested - why for this release]:

Central as beta simulation: 

Treeherder link: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel%2Crunnable&revision=9555bb52360fee973f27c6b55380fc9beaf1404b&selectedJob=288342280

Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=288342280&repo=try&lineNumber=6093

[task 2020-02-11T12:14:56.664Z] 12:14:56     INFO - TEST-START | devtools/client/performance-new/test/browser/browser_webchannel-enable-menu-button.js
[task 2020-02-11T12:14:56.760Z] 12:14:56     INFO - GECKO(2395) | ### XPCOM_MEM_BLOAT_LOG defined -- logging bloat/leaks to /tmp/tmpowTry8.mozrunner/runtests_leaks_tab_pid2673.log
[task 2020-02-11T12:14:56.896Z] 12:14:56     INFO - GECKO(2395) | [Child 2658, Main Thread] WARNING: could not set real-time limit at process startup: file /builds/worker/workspace/build/src/dom/ipc/ContentChild.cpp, line 1823
[task 2020-02-11T12:14:56.912Z] 12:14:56     INFO - GECKO(2395) | [Child 2658: Main Thread]: I/DocShellAndDOMWindowLeak ++DOCSHELL 0x7f70083e8800 == 1 [pid = 2658] [id = {e73fdf22-894b-4ddd-887f-c83e9088f99e}]
[task 2020-02-11T12:14:56.979Z] 12:14:56     INFO - GECKO(2395) | [Child 2658: Main Thread]: I/DocShellAndDOMWindowLeak ++DOMWINDOW == 1 (0x7f700a11b5c0) [pid = 2658] [serial = 1] [outer = (nil)]
[task 2020-02-11T12:14:57.000Z] 12:14:56     INFO - GECKO(2395) | [Child 2658, Main Thread] WARNING: NS_ENSURE_TRUE(mPresShell) failed: file /builds/worker/workspace/build/src/layout/base/nsPresContext.cpp, line 845
[task 2020-02-11T12:14:57.000Z] 12:14:56     INFO - GECKO(2395) | [Child 2658: Main Thread]: I/DocShellAndDOMWindowLeak ++DOMWINDOW == 2 (0x7f7008d88000) [pid = 2658] [serial = 2] [outer = 0x7f700a11b5c0]
[task 2020-02-11T12:14:57.023Z] 12:14:57     INFO - GECKO(2395) | [Child 2673, Main Thread] WARNING: No CID found when attempting to map contract ID: file /builds/worker/workspace/build/src/xpcom/components/nsComponentManager.cpp, line 721
[task 2020-02-11T12:14:57.064Z] 12:14:57     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fb1565e4800 == 5 [pid = 2395] [id = {60a5e85e-fe5f-44e6-8108-ac94c68febc5}] [url = chrome://devtools/content/performance-new/popup/popup.xhtml]
[task 2020-02-11T12:14:57.208Z] 12:14:57     INFO - GECKO(2395) | Couldn't convert chrome URL: chrome://branding/locale/brand.properties
[task 2020-02-11T12:14:57.312Z] 12:14:57     INFO - GECKO(2395) | [Child 2673, Main Thread] WARNING: could not set real-time limit at process startup: file /builds/worker/workspace/build/src/dom/ipc/ContentChild.cpp, line 1823
[task 2020-02-11T12:14:57.313Z] 12:14:57     INFO - GECKO(2395) | [Child 2673: Main Thread]: I/DocShellAndDOMWindowLeak ++DOCSHELL 0x7ff91b9e9800 == 1 [pid = 2673] [id = {ef7002af-9f70-47ff-a095-7771f71c34c5}]
[task 2020-02-11T12:14:57.328Z] 12:14:57     INFO - GECKO(2395) | [Child 2673: Main Thread]: I/DocShellAndDOMWindowLeak ++DOMWINDOW == 1 (0x7ff91d71b5c0) [pid = 2673] [serial = 1] [outer = (nil)]
[task 2020-02-11T12:14:57.329Z] 12:14:57     INFO - GECKO(2395) | [Child 2673, Main Thread] WARNING: NS_ENSURE_TRUE(mPresShell) failed: file /builds/worker/workspace/build/src/layout/base/nsPresContext.cpp, line 845
[task 2020-02-11T12:14:57.330Z] 12:14:57     INFO - GECKO(2395) | [Child 2673: Main Thread]: I/DocShellAndDOMWindowLeak ++DOMWINDOW == 2 (0x7ff91c374400) [pid = 2673] [serial = 2] [outer = 0x7ff91d71b5c0]
[task 2020-02-11T12:14:57.471Z] 12:14:57     INFO - GECKO(2395) | [Child 2673, Main Thread] WARNING: Trying to request nsIHttpChannel from DocumentChannel, this is likely broken: file /builds/worker/workspace/build/src/netwerk/ipc/DocumentChannel.cpp, line 63
[task 2020-02-11T12:14:57.513Z] 12:14:57     INFO - GECKO(2395) | [Child 2673: Main Thread]: I/DocShellAndDOMWindowLeak ++DOMWINDOW == 3 (0x7ff91d6d0000) [pid = 2673] [serial = 3] [outer = 0x7ff91d71b5c0]
[task 2020-02-11T12:14:57.961Z] 12:14:57     INFO - GECKO(2395) | ### XPCOM_MEM_BLOAT_LOG defined -- logging bloat/leaks to /tmp/tmpowTry8.mozrunner/runtests_leaks_tab_pid2709.log
[task 2020-02-11T12:14:58.065Z] 12:14:58     INFO - GECKO(2395) | [Child 2709, Main Thread] WARNING: No CID found when attempting to map contract ID: file /builds/worker/workspace/build/src/xpcom/components/nsComponentManager.cpp, line 721
[task 2020-02-11T12:14:58.201Z] 12:14:58     INFO - GECKO(2395) | Couldn't convert chrome URL: chrome://branding/locale/brand.properties
[task 2020-02-11T12:14:58.222Z] 12:14:58     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 15 (0x7fb15d5db400) [pid = 2395] [serial = 9] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:14:58.222Z] 12:14:58     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 14 (0x7fb15d72b800) [pid = 2395] [serial = 4] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:14:58.303Z] 12:14:58     INFO - GECKO(2395) | [Child 2709, Main Thread] WARNING: could not set real-time limit at process startup: file /builds/worker/workspace/build/src/dom/ipc/ContentChild.cpp, line 1823
[task 2020-02-11T12:15:02.670Z] 12:15:02     INFO - GECKO(2395) | [Child 2574: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fc1f8d57000 == 0 [pid = 2574] [id = {fe95d07b-e35a-4131-bddb-93db3c0fe6f7}] [url = http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html]
[task 2020-02-11T12:15:03.277Z] 12:15:03     INFO - GECKO(2395) | [Child 2538: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7fa259415000 == 0 [pid = 2538] [id = {36fc0549-c2d9-4982-ae42-59eae9325482}] [url = about:blank]
[task 2020-02-11T12:15:05.388Z] 12:15:05     INFO - GECKO(2395) | [Child 2588: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7f33836b4800 == 0 [pid = 2588] [id = {8dfa9383-9b38-48c7-9336-2e54518f9835}] [url = about:blank]
[task 2020-02-11T12:15:06.066Z] 12:15:06     INFO - GECKO(2395) | [Child 2635: Main Thread]: I/DocShellAndDOMWindowLeak --DOCSHELL 0x7f3c06f13000 == 0 [pid = 2635] [id = {6c67c59f-d337-495c-bea9-3c70c10a5930}] [url = about:blank]
[task 2020-02-11T12:15:06.757Z] 12:15:06     INFO - GECKO(2395) | [Child 2574: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7fc1f8e6b800) [pid = 2574] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:15:06.772Z] 12:15:06     INFO - GECKO(2395) | [Child 2574: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7fc1f8d195c0) [pid = 2574] [serial = 1] [outer = (nil)] [url = http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html]
[task 2020-02-11T12:15:07.350Z] 12:15:07     INFO - GECKO(2395) | [Child 2538: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7fa25b2195c0) [pid = 2538] [serial = 1] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:15:09.667Z] 12:15:09     INFO - GECKO(2395) | [Child 2673: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 2 (0x7ff91c374400) [pid = 2673] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:15:10.819Z] 12:15:10     INFO - GECKO(2395) | [Child 2574: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7fc1f8eb7400) [pid = 2574] [serial = 3] [outer = (nil)] [url = http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html]
[task 2020-02-11T12:15:11.377Z] 12:15:11     INFO - GECKO(2395) | [Child 2538: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7fa259e91000) [pid = 2538] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:19:43.734Z] 12:19:43     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 13 (0x7fb163f55d40) [pid = 2395] [serial = 13] [outer = (nil)] [url = chrome://devtools/content/performance-new/popup/popup.xhtml]
[task 2020-02-11T12:19:43.735Z] 12:19:43     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 12 (0x7fb16326b100) [pid = 2395] [serial = 15] [outer = (nil)] [url = chrome://devtools/content/performance-new/popup/popup.xhtml]
[task 2020-02-11T12:19:48.670Z] 12:19:48     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 11 (0x7fb157fbb800) [pid = 2395] [serial = 14] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:19:48.671Z] 12:19:48     INFO - GECKO(2395) | [Parent 2395: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 10 (0x7fb157c85000) [pid = 2395] [serial = 16] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:20:00.253Z] 12:20:00     INFO - GECKO(2395) | [Child 2588: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7f338541b5c0) [pid = 2588] [serial = 1] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:20:00.979Z] 12:20:00     INFO - GECKO(2395) | [Child 2635: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 1 (0x7f3c08d195c0) [pid = 2635] [serial = 1] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:20:04.297Z] 12:20:04     INFO - GECKO(2395) | [Child 2588: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7f338408e000) [pid = 2588] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:20:05.036Z] 12:20:05     INFO - GECKO(2395) | [Child 2635: Main Thread]: I/DocShellAndDOMWindowLeak --DOMWINDOW == 0 (0x7f3c07989400) [pid = 2635] [serial = 2] [outer = (nil)] [url = about:blank]
[task 2020-02-11T12:21:06.162Z] 12:21:06     INFO - GECKO(2395) | [2020-02-11T12:21:06Z WARN  rkv::backend::impl_safe::environment] Ignoring `map_size=16777216`
[task 2020-02-11T12:21:06.163Z] 12:21:06     INFO - GECKO(2395) | [Parent 2395, IndexedDB #9] WARNING: NS_ENSURE_SUCCESS(rv, rv) failed with result 0x80630001: file /builds/worker/workspace/build/src/storage/mozStorageConnection.cpp, line 702
[task 2020-02-11T12:21:06.164Z] 12:21:06     INFO - GECKO(2395) | [Parent 2395, IndexedDB #9] WARNING: NS_ENSURE_SUCCESS(rv, rv) failed with result 0x80630001: file /builds/worker/workspace/build/src/storage/mozStorageService.cpp, line 667
[task 2020-02-11T12:21:06.165Z] 12:21:06     INFO - GECKO(2395) | [Parent 2395, IndexedDB #9] WARNING: Received NS_ERROR_STORAGE_BUSY when attempting to open database '3870112724rsegmnoittet-es.sqlite', retrying for up to 10 seconds: file /builds/worker/workspace/build/src/dom/indexedDB/ActorsParent.cpp, line 4137
[task 2020-02-11T12:31:26.684Z] 12:31:26     INFO - TEST-INFO | started process screentopng
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - TEST-INFO | screentopng: exit 0
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - <snipped 899 output lines - if you need more context, please use SimpleTest.requestCompleteLog() in your test>
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - Buffered messages logged at 12:29:47
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 890 seconds)
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - Buffered messages logged at 12:29:48
[task 2020-02-11T12:31:27.022Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 891 seconds)
[task 2020-02-11T12:31:27.023Z] 12:31:27     INFO - Buffered messages logged at 12:29:49
[task 2020-02-11T12:31:27.023Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 892 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:50
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 893 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:51
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 894 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:52
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 895 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:53
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 896 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:54
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 897 seconds)
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - Buffered messages logged at 12:29:55
[task 2020-02-11T12:31:27.025Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 898 seconds)
[task 2020-02-11T12:31:27.026Z] 12:31:27     INFO - Buffered messages logged at 12:29:56
[task 2020-02-11T12:31:27.026Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 899 seconds)
[task 2020-02-11T12:31:27.027Z] 12:31:27     INFO - Buffered messages logged at 12:29:57
[task 2020-02-11T12:31:27.030Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 900 seconds)
[task 2020-02-11T12:31:27.031Z] 12:31:27     INFO - Buffered messages logged at 12:29:58
[task 2020-02-11T12:31:27.035Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 901 seconds)
[task 2020-02-11T12:31:27.036Z] 12:31:27     INFO - Buffered messages logged at 12:29:59
[task 2020-02-11T12:31:27.037Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 902 seconds)
[task 2020-02-11T12:31:27.037Z] 12:31:27     INFO - Buffered messages logged at 12:30:00
[task 2020-02-11T12:31:27.039Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 903 seconds)
[task 2020-02-11T12:31:27.039Z] 12:31:27     INFO - Buffered messages logged at 12:30:01
[task 2020-02-11T12:31:27.040Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 904 seconds)
[task 2020-02-11T12:31:27.040Z] 12:31:27     INFO - Buffered messages logged at 12:30:02
[task 2020-02-11T12:31:27.041Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 905 seconds)
[task 2020-02-11T12:31:27.042Z] 12:31:27     INFO - Buffered messages logged at 12:30:03
[task 2020-02-11T12:31:27.043Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 906 seconds)
[task 2020-02-11T12:31:27.043Z] 12:31:27     INFO - Buffered messages logged at 12:30:04
[task 2020-02-11T12:31:27.044Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 907 seconds)
[task 2020-02-11T12:31:27.044Z] 12:31:27     INFO - Buffered messages logged at 12:30:05
[task 2020-02-11T12:31:27.045Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 908 seconds)
[task 2020-02-11T12:31:27.046Z] 12:31:27     INFO - Buffered messages logged at 12:30:06
[task 2020-02-11T12:31:27.046Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 909 seconds)
[task 2020-02-11T12:31:27.046Z] 12:31:27     INFO - Buffered messages logged at 12:30:07
[task 2020-02-11T12:31:27.050Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 910 seconds)
[task 2020-02-11T12:31:27.054Z] 12:31:27     INFO - Buffered messages logged at 12:30:08
[task 2020-02-11T12:31:27.055Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 911 seconds)
[task 2020-02-11T12:31:27.056Z] 12:31:27     INFO - Buffered messages logged at 12:30:09
[task 2020-02-11T12:31:27.056Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 912 seconds)
[task 2020-02-11T12:31:27.057Z] 12:31:27     INFO - Buffered messages logged at 12:30:10
[task 2020-02-11T12:31:27.057Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 913 seconds)
[task 2020-02-11T12:31:27.058Z] 12:31:27     INFO - Buffered messages logged at 12:30:11
[task 2020-02-11T12:31:27.058Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 914 seconds)
[task 2020-02-11T12:31:27.059Z] 12:31:27     INFO - Buffered messages logged at 12:30:12
[task 2020-02-11T12:31:27.059Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 915 seconds)
[task 2020-02-11T12:31:27.059Z] 12:31:27     INFO - Buffered messages logged at 12:30:13
[task 2020-02-11T12:31:27.060Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 916 seconds)
[task 2020-02-11T12:31:27.060Z] 12:31:27     INFO - Buffered messages logged at 12:30:14
[task 2020-02-11T12:31:27.061Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 917 seconds)
[task 2020-02-11T12:31:27.061Z] 12:31:27     INFO - Buffered messages logged at 12:30:15
[task 2020-02-11T12:31:27.062Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 918 seconds)
[task 2020-02-11T12:31:27.063Z] 12:31:27     INFO - Buffered messages logged at 12:30:16
[task 2020-02-11T12:31:27.064Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 919 seconds)
[task 2020-02-11T12:31:27.070Z] 12:31:27     INFO - Buffered messages logged at 12:30:17
[task 2020-02-11T12:31:27.071Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 920 seconds)
[task 2020-02-11T12:31:27.078Z] 12:31:27     INFO - Buffered messages logged at 12:30:18
[task 2020-02-11T12:31:27.079Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 921 seconds)
[task 2020-02-11T12:31:27.079Z] 12:31:27     INFO - Buffered messages logged at 12:30:19
[task 2020-02-11T12:31:27.080Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 922 seconds)
[task 2020-02-11T12:31:27.080Z] 12:31:27     INFO - Buffered messages logged at 12:30:20
[task 2020-02-11T12:31:27.081Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 923 seconds)
[task 2020-02-11T12:31:27.081Z] 12:31:27     INFO - Buffered messages logged at 12:30:21
[task 2020-02-11T12:31:27.082Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 924 seconds)
[task 2020-02-11T12:31:27.082Z] 12:31:27     INFO - Buffered messages logged at 12:30:22
[task 2020-02-11T12:31:27.083Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 925 seconds)
[task 2020-02-11T12:31:27.083Z] 12:31:27     INFO - Buffered messages logged at 12:30:23
[task 2020-02-11T12:31:27.084Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 926 seconds)
[task 2020-02-11T12:31:27.084Z] 12:31:27     INFO - Buffered messages logged at 12:30:24
[task 2020-02-11T12:31:27.085Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 927 seconds)
[task 2020-02-11T12:31:27.086Z] 12:31:27     INFO - Buffered messages logged at 12:30:25
[task 2020-02-11T12:31:27.086Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 928 seconds)
[task 2020-02-11T12:31:27.090Z] 12:31:27     INFO - Buffered messages logged at 12:30:26
[task 2020-02-11T12:31:27.090Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 929 seconds)
[task 2020-02-11T12:31:27.091Z] 12:31:27     INFO - Buffered messages logged at 12:30:27
[task 2020-02-11T12:31:27.091Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 930 seconds)
[task 2020-02-11T12:31:27.091Z] 12:31:27     INFO - Buffered messages logged at 12:30:28
[task 2020-02-11T12:31:27.092Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 931 seconds)
[task 2020-02-11T12:31:27.092Z] 12:31:27     INFO - Buffered messages logged at 12:30:29
[task 2020-02-11T12:31:27.092Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 932 seconds)
[task 2020-02-11T12:31:27.092Z] 12:31:27     INFO - Buffered messages logged at 12:30:30
[task 2020-02-11T12:31:27.092Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 933 seconds)
[task 2020-02-11T12:31:27.093Z] 12:31:27     INFO - Buffered messages logged at 12:30:31
[task 2020-02-11T12:31:27.093Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 934 seconds)
[task 2020-02-11T12:31:27.093Z] 12:31:27     INFO - Buffered messages logged at 12:30:32
[task 2020-02-11T12:31:27.094Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 935 seconds)
[task 2020-02-11T12:31:27.095Z] 12:31:27     INFO - Buffered messages logged at 12:30:33
[task 2020-02-11T12:31:27.095Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 936 seconds)
[task 2020-02-11T12:31:27.102Z] 12:31:27     INFO - Buffered messages logged at 12:30:34
[task 2020-02-11T12:31:27.103Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 937 seconds)
[task 2020-02-11T12:31:27.103Z] 12:31:27     INFO - Buffered messages logged at 12:30:35
[task 2020-02-11T12:31:27.104Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 938 seconds)
[task 2020-02-11T12:31:27.104Z] 12:31:27     INFO - Buffered messages logged at 12:30:36
[task 2020-02-11T12:31:27.105Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 939 seconds)
[task 2020-02-11T12:31:27.107Z] 12:31:27     INFO - Buffered messages logged at 12:30:37
[task 2020-02-11T12:31:27.107Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 940 seconds)
[task 2020-02-11T12:31:27.108Z] 12:31:27     INFO - Buffered messages logged at 12:30:38
[task 2020-02-11T12:31:27.109Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 941 seconds)
[task 2020-02-11T12:31:27.109Z] 12:31:27     INFO - Buffered messages logged at 12:30:39
[task 2020-02-11T12:31:27.109Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 942 seconds)
[task 2020-02-11T12:31:27.110Z] 12:31:27     INFO - Buffered messages logged at 12:30:40
[task 2020-02-11T12:31:27.111Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 943 seconds)
[task 2020-02-11T12:31:27.111Z] 12:31:27     INFO - Buffered messages logged at 12:30:41
[task 2020-02-11T12:31:27.112Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 944 seconds)
[task 2020-02-11T12:31:27.113Z] 12:31:27     INFO - Buffered messages logged at 12:30:42
[task 2020-02-11T12:31:27.114Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 945 seconds)
[task 2020-02-11T12:31:27.114Z] 12:31:27     INFO - Buffered messages logged at 12:30:43
[task 2020-02-11T12:31:27.115Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 946 seconds)
[task 2020-02-11T12:31:27.115Z] 12:31:27     INFO - Buffered messages logged at 12:30:44
[task 2020-02-11T12:31:27.116Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 947 seconds)
[task 2020-02-11T12:31:27.116Z] 12:31:27     INFO - Buffered messages logged at 12:30:45
[task 2020-02-11T12:31:27.117Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 948 seconds)
[task 2020-02-11T12:31:27.117Z] 12:31:27     INFO - Buffered messages logged at 12:30:46
[task 2020-02-11T12:31:27.118Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 949 seconds)
[task 2020-02-11T12:31:27.118Z] 12:31:27     INFO - Buffered messages logged at 12:30:47
[task 2020-02-11T12:31:27.119Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 950 seconds)
[task 2020-02-11T12:31:27.119Z] 12:31:27     INFO - Buffered messages logged at 12:30:48
[task 2020-02-11T12:31:27.120Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 951 seconds)
[task 2020-02-11T12:31:27.120Z] 12:31:27     INFO - Buffered messages logged at 12:30:49
[task 2020-02-11T12:31:27.121Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 952 seconds)
[task 2020-02-11T12:31:27.121Z] 12:31:27     INFO - Buffered messages logged at 12:30:50
[task 2020-02-11T12:31:27.122Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 953 seconds)
[task 2020-02-11T12:31:27.122Z] 12:31:27     INFO - Buffered messages logged at 12:30:51
[task 2020-02-11T12:31:27.123Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 954 seconds)
[task 2020-02-11T12:31:27.124Z] 12:31:27     INFO - Buffered messages logged at 12:30:52
[task 2020-02-11T12:31:27.124Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 955 seconds)
[task 2020-02-11T12:31:27.125Z] 12:31:27     INFO - Buffered messages logged at 12:30:53
[task 2020-02-11T12:31:27.125Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 956 seconds)
[task 2020-02-11T12:31:27.126Z] 12:31:27     INFO - Buffered messages logged at 12:30:54
[task 2020-02-11T12:31:27.126Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 957 seconds)
[task 2020-02-11T12:31:27.127Z] 12:31:27     INFO - Buffered messages logged at 12:30:55
[task 2020-02-11T12:31:27.127Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 958 seconds)
[task 2020-02-11T12:31:27.128Z] 12:31:27     INFO - Buffered messages logged at 12:30:56
[task 2020-02-11T12:31:27.128Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 959 seconds)
[task 2020-02-11T12:31:27.129Z] 12:31:27     INFO - Buffered messages logged at 12:30:57
[task 2020-02-11T12:31:27.129Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 960 seconds)
[task 2020-02-11T12:31:27.133Z] 12:31:27     INFO - Buffered messages logged at 12:30:58
[task 2020-02-11T12:31:27.133Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 961 seconds)
[task 2020-02-11T12:31:27.134Z] 12:31:27     INFO - Buffered messages logged at 12:30:59
[task 2020-02-11T12:31:27.134Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 962 seconds)
[task 2020-02-11T12:31:27.135Z] 12:31:27     INFO - Buffered messages logged at 12:31:00
[task 2020-02-11T12:31:27.135Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 963 seconds)
[task 2020-02-11T12:31:27.135Z] 12:31:27     INFO - Buffered messages logged at 12:31:01
[task 2020-02-11T12:31:27.136Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 964 seconds)
[task 2020-02-11T12:31:27.136Z] 12:31:27     INFO - Buffered messages logged at 12:31:02
[task 2020-02-11T12:31:27.136Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 965 seconds)
[task 2020-02-11T12:31:27.137Z] 12:31:27     INFO - Buffered messages logged at 12:31:03
[task 2020-02-11T12:31:27.137Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 966 seconds)
[task 2020-02-11T12:31:27.137Z] 12:31:27     INFO - Buffered messages logged at 12:31:04
[task 2020-02-11T12:31:27.138Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 967 seconds)
[task 2020-02-11T12:31:27.138Z] 12:31:27     INFO - Buffered messages logged at 12:31:05
[task 2020-02-11T12:31:27.139Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 968 seconds)
[task 2020-02-11T12:31:27.139Z] 12:31:27     INFO - Buffered messages logged at 12:31:06
[task 2020-02-11T12:31:27.139Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 969 seconds)
[task 2020-02-11T12:31:27.140Z] 12:31:27     INFO - Buffered messages logged at 12:31:07
[task 2020-02-11T12:31:27.140Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 970 seconds)
[task 2020-02-11T12:31:27.141Z] 12:31:27     INFO - Buffered messages logged at 12:31:08
[task 2020-02-11T12:31:27.141Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 971 seconds)
[task 2020-02-11T12:31:27.145Z] 12:31:27     INFO - Buffered messages logged at 12:31:09
[task 2020-02-11T12:31:27.145Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 972 seconds)
[task 2020-02-11T12:31:27.145Z] 12:31:27     INFO - Buffered messages logged at 12:31:10
[task 2020-02-11T12:31:27.146Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 973 seconds)
[task 2020-02-11T12:31:27.146Z] 12:31:27     INFO - Buffered messages logged at 12:31:11
[task 2020-02-11T12:31:27.147Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 974 seconds)
[task 2020-02-11T12:31:27.147Z] 12:31:27     INFO - Buffered messages logged at 12:31:12
[task 2020-02-11T12:31:27.147Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 975 seconds)
[task 2020-02-11T12:31:27.148Z] 12:31:27     INFO - Buffered messages logged at 12:31:13
[task 2020-02-11T12:31:27.148Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 976 seconds)
[task 2020-02-11T12:31:27.148Z] 12:31:27     INFO - Buffered messages logged at 12:31:14
[task 2020-02-11T12:31:27.149Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 977 seconds)
[task 2020-02-11T12:31:27.149Z] 12:31:27     INFO - Buffered messages logged at 12:31:15
[task 2020-02-11T12:31:27.150Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 978 seconds)
[task 2020-02-11T12:31:27.150Z] 12:31:27     INFO - Buffered messages logged at 12:31:16
[task 2020-02-11T12:31:27.150Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 979 seconds)
[task 2020-02-11T12:31:27.151Z] 12:31:27     INFO - Buffered messages logged at 12:31:17
[task 2020-02-11T12:31:27.152Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 980 seconds)
[task 2020-02-11T12:31:27.152Z] 12:31:27     INFO - Buffered messages logged at 12:31:18
[task 2020-02-11T12:31:27.153Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 981 seconds)
[task 2020-02-11T12:31:27.153Z] 12:31:27     INFO - Buffered messages logged at 12:31:19
[task 2020-02-11T12:31:27.154Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 982 seconds)
[task 2020-02-11T12:31:27.155Z] 12:31:27     INFO - Buffered messages logged at 12:31:20
[task 2020-02-11T12:31:27.155Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 983 seconds)
[task 2020-02-11T12:31:27.155Z] 12:31:27     INFO - Buffered messages logged at 12:31:21
[task 2020-02-11T12:31:27.156Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 984 seconds)
[task 2020-02-11T12:31:27.156Z] 12:31:27     INFO - Buffered messages logged at 12:31:22
[task 2020-02-11T12:31:27.157Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 985 seconds)
[task 2020-02-11T12:31:27.157Z] 12:31:27     INFO - Buffered messages logged at 12:31:23
[task 2020-02-11T12:31:27.158Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 986 seconds)
[task 2020-02-11T12:31:27.158Z] 12:31:27     INFO - Buffered messages logged at 12:31:24
[task 2020-02-11T12:31:27.158Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 987 seconds)
[task 2020-02-11T12:31:27.159Z] 12:31:27     INFO - Buffered messages logged at 12:31:25
[task 2020-02-11T12:31:27.159Z] 12:31:27     INFO - > Waiting until the profiler button is added to the browser. (After 988 seconds)
[task 2020-02-11T12:31:",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1625145,Perma TEST-UNEXPECTED-FAIL | devtools/client/performance-new/test/browser/browser_popup-record-capture.js | Test timed out - when Gecko 76 merges to Beta on 2020-04-06,FIXED,"Central as Beta

Treeherder link: https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=65b4603f3ae102f328dfa4fde5a3117fae254ef5&searchStr=devtools&selectedJob=294849199

Failure log:  https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=294849199&repo=try&lineNumber=7111

> [task 2020-03-26T11:56:36.275Z] 11:56:36     INFO - TEST-START | devtools/client/performance-new/test/browser/browser_popup-record-capture.js
[task 2020-03-26T11:56:36.283Z] 11:56:36     INFO - GECKO(4954) | console.error: ""The preference \""devtools.performance.recording.ui-base-url\"" was set to a URL that is not allowed. No WebChannel messages will be sent between the browser and that URL. Falling back to https://profiler.firefox.com. Only localhost and deploy previews URLs are allowed."" ""http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html""
[task 2020-03-26T11:56:36.287Z] 11:56:36     INFO - GECKO(4954) | console.error: ""The preference \""devtools.performance.recording.ui-base-url\"" was set to a URL that is not allowed. No WebChannel messages will be sent between the browser and that URL. Falling back to https://profiler.firefox.com. Only localhost and deploy previews URLs are allowed."" ""http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html""
[task 2020-03-26T11:56:36.287Z] 11:56:36     INFO - GECKO(4954) | console.error: CustomizableUI:
[task 2020-03-26T11:56:36.287Z] 11:56:36     INFO - GECKO(4954) |   Widget 'profiler-button' not found, unable to move
[task 2020-03-26T12:04:51.280Z] 12:04:51     INFO - TEST-INFO | started process screentopng
[task 2020-03-26T12:04:51.634Z] 12:04:51     INFO - TEST-INFO | screentopng: exit 0
[task 2020-03-26T12:04:51.634Z] 12:04:51     INFO - <snipped 401 output lines - if you need more context, please use SimpleTest.requestCompleteLog() in your test>
[task 2020-03-26T12:04:51.634Z] 12:04:51     INFO - Buffered messages logged at 12:03:11
[task 2020-03-26T12:04:51.634Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 395 seconds)
[task 2020-03-26T12:04:51.635Z] 12:04:51     INFO - Buffered messages logged at 12:03:12
[task 2020-03-26T12:04:51.635Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 396 seconds)
[task 2020-03-26T12:04:51.635Z] 12:04:51     INFO - Buffered messages logged at 12:03:13
[task 2020-03-26T12:04:51.636Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 397 seconds)
[task 2020-03-26T12:04:51.636Z] 12:04:51     INFO - Buffered messages logged at 12:03:14
[task 2020-03-26T12:04:51.636Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 398 seconds)
[task 2020-03-26T12:04:51.636Z] 12:04:51     INFO - Buffered messages logged at 12:03:15
[task 2020-03-26T12:04:51.637Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 399 seconds)
[task 2020-03-26T12:04:51.637Z] 12:04:51     INFO - Buffered messages logged at 12:03:16
[task 2020-03-26T12:04:51.637Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 400 seconds)
[task 2020-03-26T12:04:51.641Z] 12:04:51     INFO - Buffered messages logged at 12:03:17
[task 2020-03-26T12:04:51.642Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 401 seconds)
[task 2020-03-26T12:04:51.642Z] 12:04:51     INFO - Buffered messages logged at 12:03:18
[task 2020-03-26T12:04:51.642Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 402 seconds)
[task 2020-03-26T12:04:51.644Z] 12:04:51     INFO - Buffered messages logged at 12:03:19
[task 2020-03-26T12:04:51.644Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 403 seconds)

> [task 2020-03-26T12:04:51.793Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 493 seconds)
[task 2020-03-26T12:04:51.793Z] 12:04:51     INFO - Buffered messages logged at 12:04:50
[task 2020-03-26T12:04:51.795Z] 12:04:51     INFO - > Waiting until the profiler button is added to the browser. (After 494 seconds)
[task 2020-03-26T12:04:51.795Z] 12:04:51     INFO - Buffered messages finished
[task 2020-03-26T12:04:51.795Z] 12:04:51     INFO - TEST-UNEXPECTED-FAIL | devtools/client/performance-new/test/browser/browser_popup-record-capture.js | Test timed out - 
[task 2020-03-26T12:04:51.796Z] 12:04:51     INFO - GECKO(4954) | MEMORY STAT | vsize 3328MB | residentFast 416MB | heapAllocated 246MB
[task 2020-03-26T12:04:51.796Z] 12:04:51     INFO - TEST-OK | devtools/client/performance-new/test/browser/browser_popup-record-capture.js | took 495013ms
[task 2020-03-26T12:04:51.797Z] 12:04:51     INFO - checking window state
[task 2020-03-26T12:04:51.797Z] 12:04:51     INFO - Not taking screenshot here: see the one that was previously logged
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - TEST-UNEXPECTED-FAIL | devtools/client/performance-new/test/browser/browser_popup-record-capture.js | Uncaught exception received from previously timed out test - at chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:44 - ReferenceError: info is not defined
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - Stack trace:
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - createPeriodicLogger/<@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:44:9
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - waitUntil@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:71:22
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - TEST-START | devtools/client/performance-new/test/browser/browser_popup-record-discard.js
[task 2020-03-26T12:04:51.818Z] 12:04:51     INFO - GECKO(4954) | console.error: ""The preference \""devtools.performance.recording.ui-base-url\"" was set to a URL that is not allowed. No WebChannel messages will be sent between the browser and that URL. Falling back to https://profiler.firefox.com. Only localhost and deploy previews URLs are allowed."" ""http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html""
[task 2020-03-26T12:04:51.820Z] 12:04:51     INFO - GECKO(4954) | console.error: ""The preference \""devtools.performance.recording.ui-base-url\"" was set to a URL that is not allowed. No WebChannel messages will be sent between the browser and that URL. Falling back to https://profiler.firefox.com. Only localhost and deploy previews URLs are allowed."" ""http://example.com/browser/devtools/client/performance-new/test/browser/fake-frontend.html""
[task 2020-03-26T12:04:51.821Z] 12:04:51     INFO - Not taking screenshot here: see the one that was previously logged
[task 2020-03-26T12:04:51.822Z] 12:04:51     INFO - Buffered messages logged at 12:04:51
[task 2020-03-26T12:04:51.823Z] 12:04:51     INFO - Entering test bound test
[task 2020-03-26T12:04:51.823Z] 12:04:51     INFO - Test that the profiler popup recording can be discarded.
[task 2020-03-26T12:04:51.824Z] 12:04:51     INFO - Setting the profiler URL to the fake frontend. Note that this doesn't currently support the WebChannels, so expect a few error messages about the WebChannel URLs not being correct.
[task 2020-03-26T12:04:51.826Z] 12:04:51     INFO - Make sure the profiler popup is enabled.
[task 2020-03-26T12:04:51.827Z] 12:04:51     INFO - > Load the profiler menu button.
[task 2020-03-26T12:04:51.827Z] 12:04:51     INFO - > The menu button was already enabled.
[task 2020-03-26T12:04:51.827Z] 12:04:51     INFO - Toggle open the profiler popup.
[task 2020-03-26T12:04:51.828Z] 12:04:51     INFO - > Find the profiler menu button.
[task 2020-03-26T12:04:51.828Z] 12:04:51     INFO - Buffered messages finished
[task 2020-03-26T12:04:51.829Z] 12:04:51     INFO - TEST-UNEXPECTED-FAIL | devtools/client/performance-new/test/browser/browser_popup-record-discard.js | Uncaught exception - at chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:204 - Error: Could not find the profiler button in the menu.
[task 2020-03-26T12:04:51.829Z] 12:04:51     INFO - Stack trace:
[task 2020-03-26T12:04:51.830Z] 12:04:51     INFO - toggleOpenProfilerPopup@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/head.js:204:11
[task 2020-03-26T12:04:51.830Z] 12:04:51     INFO - test@chrome://mochitests/content/browser/devtools/client/performance-new/test/browser/browser_popup-record-discard.js:13:9
[task 2020-03-26T12:04:51.831Z] 12:04:51     INFO - Leaving test bound test
[task 2020-03-26T12:04:51.831Z] 12:04:51     INFO - GECKO(4954) | MEMORY STAT | vsize 3322MB | residentFast 417MB | heapAllocated 247MB
[task 2020-03-26T12:04:51.832Z] 12:04:51     INFO - TEST-OK | devtools/client/performance-new/test/browser/browser_popup-record-discard.js | took 56ms

Greg, is this from bug 1621022?",I'm pretty sure it is. I'll investigate and get a fix going.,"Created attachment 9136413
Bug 1625145 - Ensure the profiler menu button feature flag is enabled in tests; r?julienw",https://treeherder.mozilla.org/#/jobs?repo=try&revision=c6acdfc43b7a6778b0051d13f6826c44f8cc95f7,"Imported the patch in today's beta sims and seems to work:
https://treeherder.mozilla.org/#/jobs?repo=try&revision=5231bd057830a48eab1ae9275fe72a91edb6ecab&searchStr=Windows%2C10%2Cx64%2Casan%2CMochitests%2Ctest-windows10-64-asan%2Fopt-mochitest-devtools-chrome-e10s-2%2CM%28dt2%29&selectedJob=295191387","Pushed by gtatum@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/89453cbdf243
Ensure the profiler menu button feature flag is enabled in tests; r=julienw",https://hg.mozilla.org/mozilla-central/rev/89453cbdf243,"Verified fixed in today's central as beta simulation:
https://treeherder.mozilla.org/#/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception%2Crunnable&revision=04be6ee26bb3182a09f340d814d19b5540688f81&searchStr=%28dt",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1663387,Poor scrolling performance on westfield.co.nz (very large blob copy),FIXED,"Created attachment 9174162
Untitled-1.jpg

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0

Steps to reproduce:

Visited this page, clicked middle mouse button and moved mouse downwards.
https://www.westfield.co.nz/newmarket

about:support details:
https://pastebin.com/uYhhVwSP

System specs:
i5 2400
8gb
GTX 970 - 442.59
Win 10 19041.488


Actual results:

Very jerky scrolling with large frame drops; Menu bar resizes very slowly.


Expected results:

Smooth scrolling / menu resize.",https://share.firefox.dev/3icV5Ja,"Can reproduce both with and without WebRender on MBP. Seems like an older bug, present since at least FF70.

WR: https://share.firefox.dev/2E4eqNO
Non-WR: https://share.firefox.dev/2ZDncK5","@Nical: Looks to be blob related on WR and skia on non-WR, could you take a look at what we can do here?","Wow, 300+ ms copying bytes (the blob) from a shmem into a rust vec, and about twice as much writing into the shmem on the content side.

The blob image is very large. It looks like we serialize some big source surfaces into the recording.
The slowness appears to be coming from a blob mask","(In reply to Nicolas Silva [:nical] from comment #4)
> Wow, 300+ ms copying bytes (the blob) from a shmem into a rust vec, and about twice as much writing into the shmem on the content side.
> 
> The blob image is very large. It looks like we serialize some big source surfaces into the recording.
> The slowness appears to be coming from a blob mask

I had a look at what's going on it and it looks like this is caused by stacked svg masks. I suspect we hit some raster fallback path in that case and then we're just recording a huge raster image in the blob.","Created attachment 9176973
Partially reduced version","Created attachment 9178004
This patch fixes the long recording times but causes large gpu times

Not sure why this causes the long gpu times yet.",The large gpu times were already there. They are a very large clip task.,"I investigated the large GPU times. I turned off picture caching to make it easy to get a capture. I was able to replay the capture in GPA and RenderDoc.

GPA allows graphing draw calls by their execution time and this showed two clip_image draw calls taking the bulk of the time. 

It wasn't immediately obvious why these draw calls should be so much worse than the others. The memory bandwidth used on these calls was lower than other fullscreen draws. Eventually I noticed that the number of rasterized pixels was very high (34 million), and it turns out that for the first clip_image draw call we were rasterizing 12 full screen quads and the second 3 additional full screen quads. The vast majority of these rasterized pixels end up hitting the discard branch of the clip_image shader which avoids the memory bandwidth cost. However, we still get bottlenecked on pixel shader dispatch/execution.

I also discovered that conditional 'discard' causes ANGLE to turn off optimization in the D3D shader compiler. While not great, this probably isn't that bad because are shaders are already preoptimized by glslopt.","It looks like the 12 instances are from the 12 tiles of the image. I'm guessing we draw each tile over the entire area of the mask and this causes the sad. This sounds somewhat related to bug 1616326 comment 11.

Glenn, can you confirm that this could be what's happening? If it is how can we fix it?","The tiled clip rendering path is known bad path in WR right now, so this analysis sounds right. I'll look into it this week and see if we can apply a better bounding rect to clip tiles (this should be a reasonable short-term fix, we can look at removing the discard altogether as a longer term improvement).","Added an optimization for tiled clip masks that are axis-aligned (the common case) in bug #1667707.

On my 5700 machine, this drops the GPU time on this page at 4k from 4.5ms down to 0.9ms.","Created attachment 9178284
A more reduced version

The conditions for the CreateSamplingRestrictedDrawable are narrower than I thought.",You need to have two mask images and one needs to be positioned.,"I took another look at this. There is still some very long times spent in the ""WR DL"" category, which I suspect to be the blob draw/copy mentioned above? Apart from that, the WR side looks quite reasonable now - there's nothing else obvious in the profile.

Nical, Jeff, would this be a good test candidate for some of the proposed work related to accelerating SVG masks?",Either the page changed or the removal of CreateSamplingRestrictedDrawable removed the worst of the blob rendering (or both). There's still some blob activity but nothing too intense.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1673522,Slow paint performance | https://projects.fivethirtyeight.com/2020-election-forecast/,FIXED,"+++ This bug was initially created as a clone of Bug #1672880 +++

I closed the original bug prematurely. It turned out to be quite reproducible and not related to other tabs.  See video of behavior here:  https://drive.google.com/file/d/19d2zlCclqiNRkbn6wGb7QCyg1_328rBr/view?usp=sharing

The page is fast at one size, and once I widen it out it becomes very sluggish. If I shrink the width back down the performance is restored. I don't see a similar slowdown in other browsers.



Original report ------------>

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:82.0) Gecko/20100101 Firefox/82.0

Steps to reproduce:

I've notice sluggish performance on JS-heavy sites compared to Safari and Chrome. One site in particular is dramatically worse: https://projects.fivethirtyeight.com/2020-election-forecast/


Actual results:

Mousing around the simulation graphic (the one with all the dots) takes the better parts of a second to show the pop-up for each dot. According to the profiler, the long pauses are in ""Paint"" calls.


Expected results:

Both Chrome and Safari show these pop-ups almost instantly.","I confirm that on Firefox the performance of the website is slower comparing to Chrome on Windows 10 x64, MacOS 10.14 and on Ubunutu 20.04.",On Mac this performs much better for me with WebRender enabled (Nightly or `gfx.webrender.all` in about:config in Firefox 82).,"Marking as S3 as this is fixed by WR, yay!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1681301,[Apple Chip - ARM64 M1] [pinterest.com] Severe performance issues upon scrolling on pinterest with video playback,FIXED,"**Affected Versions:**
84.0 - Beta RC
83.0 - Release - works with Rosetta installed

**Unaffected Version:**
Nightly (2020-12-08)

**Affected Platforms:**
ARM64 MacOS:
- miniMac: MacOS Big Sur 11.0.1, Mac mini (M1, 2020), Chip: Apple M1, display 27-inch (2560x1440), with Rosetta

**Unaffected Tested Platforms:**
MacOS 10.15 MacBook Pro 13inch, macOS Big Sur 11 (intel chip)

**Steps to reproduce:**
1. Go to https://ro.pinterest.com/pin/584342120393644748/ (log in when prompted)(make sure the browser is maximized)
2. While the video is played back start scrolling up and down
3. Reload the page once if needed (performance issues are not visible enough)
4. Start scrolling again and also check the hover highlight from the address bar search options for significant delays or open new tabs

**Expected Results:**
Scrolling on Pinterest while videos are played back should be smooth

**Actual Result:**
Severe performance issues can be observed if a video is played back while scrolling on Pinterest and the suggested images are being loaded. See recording: https://streamable.com/eymtu5

**Severity suggestion: S1 - S2 - Pinterest is a common top site**
Not reproducible with Chrome using the same M1 device. Chrome nearly hits 25% CPU usage while Firefox can reach over 100% (please note macOS CPU usage shown in activity monitor is per core). Attached screenshots of core usage in Beta and Nightly (unaffected)

The significant difference in Nightly (where this is not reproducible) is that it uses WebRender while on Beta and Release we have OpenGL. 

Performance Profile: https://profiler.firefox.com/from-addon/calltree/?globalTrackOrder=7-0-1-2-3-4-5-6&hiddenGlobalTracks=1-2-3-4-5&hiddenLocalTracksByPid=1148-1-2-3~1780-0-1-2-3-4-5&localTrackOrderByPid=1148-4-0-1-2-3~1780-6-0-1-2-3-4-5~&thread=10&v=5","Created attachment 9191937
Nightly Core Usage.png","Created attachment 9191938
Beta Core Usage.png","The difference appears to be caused by WebRender not being enabled on arm64 Beta builds. Bug 1679998 enabled WebRender on Apple arm64 hardware and is in 85.

@Timea, could you verify that the problem is not reproducible for you with on Beta after setting `gfx.webrender.all=true` in about:config and restarting?","@mstange and @RyanVM, uplifting enabling WebRender (bug 1679998) is something to consider for an RC2.",That seems like a pretty massive change to make in an RC build...,"I agree, I would prefer sitting this one out. Firefox 82 would probably have had the same bad performance on all macOS variants (because it didn't have WR enabled anywhere).",Sounds like we should call this fixed by bug 1679998 in any case.,Can confirm that enabling WebRender on Beta 84.0 RC does indeed fix this issue as it can also be observed on Nightly.,"A severity wasn't assigned for this bug. Jim/Haik, could you please help?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1649188,Race condition on Thunderbird initial startup when opening a tab,FIXED,"Steps to reproduce problem:
1. Compile Thunderbird 78 with a custom source for Owl, so that it picks up a version that actually runs in Thunderbird 78
2. Start a new profile
3. Set up an account which requires Owl to log in using a browser
4. Complete account setup
5. Dismiss the default mail dialog

Expected results: After account setup is complete, Owl logs in to the account in a tab, and discovers folders

Actual results: Exception thrown in calendar code.

What happens here is that the default mail dialog is modal, which means that Thunderbird's onload handler has not yet completed, and therefore calendar's main window onload handler has not even started to execute. However, Owl is trying to authenticate in the background by opening a browser tab. This action causes Calendar to try to update its UI, which fails because its onload handler has not yet executed.","Created attachment 9163033
Catch errors in listeners

Actually any extension can trigger the bug by opening a tab while the default client dialog is open.","Even though there's Owl appearing in the reproduction steps, the bug here is not in Owl. Owl is merely opening a tab, nothing more. That mere opening of the tab is completely breaking Thunderbird. That shouldn't happen.

This is the right fix for the problem.

The concept of observers is to decouple modules. An observer, from the perspective of the main module, is by definition always optional. An observer should never ever be able to break other, later observers, nor the main module. Imagine if a broken event listener would break the entire browser. Likewise, an optional module like the calendar should not break the mail reading.

Firefox in its <tabbrowser> implementation does the same thing, it's wrapping the call to the listeners in a try/catch. tabmail should do the same.

https://searchfox.org/mozilla-central/source/browser/base/content/tabbrowser.js#814 function _callListeners()","Comment on attachment 9163033
Catch errors in listeners

Seems reasonable. I hate tabmail. :-)","Pushed by geoff@darktrojan.net:
https://hg.mozilla.org/comm-central/rev/b2fc6b0388b8
Wrap calls to tab monitors in try/catch to prevent them from breaking tabmail. r=darktrojan DONTBUILD","Comment on attachment 9163033
Catch errors in listeners

[Approval Request Comment]
Regression caused by (bug #): tabmail XBL rewrite
User impact if declined:
Any error in any tab observer of any kind, anywhere in the app, even in optional components, can completely break the Thunderbird app and the tabs and the main window.
Testing completed (on c-c, etc.):
Risk to taking this patch (and alternatives if risky):
Just adding a try/catch. Very safe.","Comment on attachment 9163033
Catch errors in listeners

Approved for esr78","Thank you, Neil, Geoff and Wayne!","Comment on attachment 9163033
Catch errors in listeners

[Triage Comment]
Taking for 79.0b2 for consistency.","Thunderbird 79.0b2:
https://hg.mozilla.org/releases/comm-beta/rev/5bbe33b8430f34f916db9e89151f52f8755f785e","Thunderbird 78.0.1:
https://hg.mozilla.org/releases/comm-esr78/rev/bdbecbab1b92",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1343143,Enable VP8 temporal scalability for simulcast,FIXED,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:50.0) Gecko/20100101 Firefox/50.0
Build ID: 20161209094312

Steps to reproduce:

Configure the Firefox local SDP to enable VP8 simulcast encoding.


Actual results:

Firefox encodes VP8 simulcast streams with a single temporal layer.


Expected results:

Firefox should ideally encode VP8 simulcast streams with multiple temporal layers. Compare with Chrome, which uses three temporal layers when doing simulcast encoding for VP8. This is especially important for group video calls using an SFU architecture.","This code review comment appears to be relevant:
https://bugzilla.mozilla.org/show_bug.cgi?id=1230197#c5","> Firefox should ideally encode VP8 simulcast streams with multiple temporal
> layers. Compare with Chrome, which uses three temporal layers when doing
> simulcast encoding for VP8. This is especially important for group video
> calls using an SFU architecture.

Actually the number of layers varies from 1 to 3, depending on resolution; see simulcast.cc in libjingle.","Sorry, that's number of simulcast layers; they are using 3 temporal layers for all simulcast layers it appears.","Created attachment 8841869
enable 3 temporal layers in simulcast mode, at all resolutions

https://treeherder.mozilla.org/#/jobs?repo=try&revision=afb2c11d61a53a414bf19414a47359b01870cf56 (with the fixes for TIAS and ssrc signaling as well).  Works fine locally, though we have nothing that would do anything interesting with temporal layers.  Reporter - can you try it with whatever it is you want it to work with?  Thanks","Pushed by rjesup@wgate.com:
https://hg.mozilla.org/integration/mozilla-inbound/rev/14aa512533f1
enable 3 temporal layers in simulcast mode, at all resolutions r=bwc",https://hg.mozilla.org/mozilla-central/rev/14aa512533f1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1745529,"scrolling with scrollwheel moves very slowly down the page, at nuro.ai",FIXED,"STR:
1. Visit https://www.nuro.ai/
2. Scroll down until you see the text ""Here to make your everyday a little better"", with a pizza-delivery video playing below it.  Position that text at the top of your viewport (with the video mostly filling the viewport).
3. Use your mousewheel to try to continue scrolling, paying attention to how many times you have to spin the wheel.

ACTUAL RESULTS:
The mousewheel scrolling velocity reduces here (and elsewhere on the page, but it's especially noticeable here). In particular, it takes many more mousewheel scrolls to get past this video on Firefox vs. Chrome. (About 8 wheel-scrolls in Firefox, vs. 2 in Chrome. I'm defining a wheel-scroll as the largest individual scroll that I can do with the wheel, i.e. starting my finger at the top of the wheel, and rolling that point all the way back. )

EXPECTED RESULTS:
Shouldn't have to mousewheel-scroll so many times. Should get the same experience as in Chrome.","(I suspect they're doing something fancy for handling scroll events to play their slideshow fanciness, but it seems to be performing poorly and requiring unusual amounts of scrolling, specifically in Firefox.)","Screencast of me scrolling in Firefox (with each scroll operation being a ""full"" scrollwheel-scroll, dragging my finger from the front of the wheel to the back of the wheel):
https://www.dropbox.com/s/3bqg8c2e0asw4ud/screencast-nuro-firefox.webm?dl=0
It took 8 full mousewheel scrolls to get past this section.

Screencast of me doing the same actions in Chrome:
https://www.dropbox.com/s/hqd98gk80j11m3x/screencast-nuro-chrome.webm?dl=0
It took 2 full mousewheel scrolls to get past this section.

(Note, dropbox may prompt you to log in; it looks like you can ignore that and just click the ""x"" on their login prompt. Their web player leaves something to be desired, so it may be easiest to use the download button there. Apologies for hosting them elsewhere; I did so because the screencast ended up being too large to be bugzilla-friendly, ~34MB.)","Opening devtools: it looks like the ""scrolling"" here is handled dynamically via this element:
```
<div id=""scroll-el"" data-v-5c59e03f="""" style=""transform: translate3d(0px, -7083px, 0px);"">
```
...where that transform gets updated dynamically, in the site's JS, in response to scrollwheel events (and/or on rAF, since the actual transform-setting happens inside of a function defined as:
```
 key: ""onRAF"",
    value: function onRAF() {
...
```
(This is via a 3rd-party library https://github.com/ashthornton/asscroll , which the site here references via internal webpack URI `webpack:///node_modules/@ashthornton/asscroll/build/asscroll.js`)

The interesting/differing thing here is the distance scrolled with a single mousewheel-tick.  (which is stored in `this.deltaY` whenever you mousewheel scroll). In Chrome, the distance is consistently 106px. In Firefox, it's 126px for ""regular"" scroll ticks, vs. 18px for ""tiny"" scroll operations.

That value is determined in the `normalizeWheel` function, which actually just takes the value from `event.deltaY` from the scroll event here.  And for some reason, we have `event.deltaY` being `18` when you hover the video, vs. `126` when you hover other parts of the page.",Number of lines scrolled depends on the font-size. They have a `.vv-visual { font-size: 0; }` rule that applies to the videos...,"Since it also has `overflow: hidden`, then we use it as the line scroll amount, even though probably we end up scrolling the root scroller?","Yup, it seems to be a combination of `overflow:hidden` and the small `font-size`, which produces a small deltaY which is what we *would* have used if we were indeed scrolling this scrollable element (even though in fact we are scrolling the root scroller instead).

I've got a reduced testcase, posting shortly.","Created attachment 9255098
testcase 1","STR with reduced testcase:
1. Load attached testcase.
2. Hover the black rectangle and mousewheel-scroll (with individual ""ticks"" of your wheel), and notice the reported `deltaY` (shown in the top right of the page, for convenience, and also in console.log)
3. Hover a different area (outside the black rectangle) and scroll.

ACTUAL RESULTS:
The values differ -- I get 18 vs 114 -- even though the actual distance that we scroll is the same.

EXPECTED RESULTS:
The values should be the same, perhaps?

In Chrome, the values are the same (106 for me) regardless of whether you're hovering the black rectangle.","Created attachment 9255100
Bug 1745529 - Use default action target to compute scroll amount. r=masayuki


This avoids pages having different scroll amount if there are overflow:
hidden elements with different font sizes.

Running through try to see if there's any test to adjust or I need to
write one.","FWIW, it looks like Chrome just always uses 106px regardless of the font-size. So it's not obvious whether they're doing anything special with regard to figuring out which scrollport is going to handle the event.

I'll attach another testcase where the `font:0` element is actually scrollable to demonstrate this.","Created attachment 9255101
testcase 2

Here's a second testcase, where the black-bordered div is actually scrollable.

Here, if you hover & mousewheel-scroll the black-bordered div, you can see that it does indeed just scroll a tiny amount (in Firefox), which we faithfully report via `deltaY`; whereas in Chrome, they scroll the div by ~large amounts (unaffected by the font-size), and so they report the same `deltaY` regardless.

To be clear, I'm not sure we need/want to worry about interop on *this* testcase. testcase 1 seems like the one to focus on more.  I'm mostly just attaching this one to illumniate what's going on a bit better.","So this changes behavior in `dom/events/test/test_moz_mouse_pixel_scroll_event.html`, which asserts pretty strongly that `Should be computed from nearest scrollable element, even if not scrollable to the direction`. Masayuki, this test was added in bug 719320, was that just keeping existing behavior or is there a deeper reason for that? If the former, I think we should probably just adjust the test so that `MozMousePixelScroll` and wheel with pixel delta behave the same way.","According to bug 719320 comment 44, I considered to keep traditional behavior. And IIRC, I thought that it is logically wrong because:

* `wheel` event and the legacy events report different scroll amount in the case
* Computing scroll amount from different element is simply odd

So I think that it's fine to stop doing it and updating the test for new behavior.

According to the telemetry, it's now less than 2% documents which still use the legacy events:
* [`DOMMouseScroll`](https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&end_date=2021-12-09&include_spill=0&keys=__none__!__none__!__none__&max_channel_version=beta%252F95&measure=USE_COUNTER2_ONDOMMOUSESCROLL_DOCUMENT&min_channel_version=null&processType=*&product=Firefox&sanitize=1&sort_by_value=0&sort_keys=submissions&start_date=2021-12-06&table=0&trim=1&use_submission_date=0)
* [`MozMousePixelScroll`](https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&end_date=2021-11-29&include_spill=0&keys=__none__!__none__!__none__&max_channel_version=beta%252F95&measure=USE_COUNTER2_ONMOZMOUSEPIXELSCROLL_DOCUMENT&min_channel_version=null&processType=*&product=Firefox&sanitize=1&sort_by_value=0&sort_keys=submissions&start_date=2021-11-01&table=0&trim=1&use_submission_date=0)

So changing it must be safe.

FYI: The reason why we use different scroll pixels if native scroll input is per line is, for respecting the meaning of the scroll amount coming from OS. And I believe that it's reasonable for bigger or smaller font-size cases than usual. But I know some web site/apps specify not reasonable font-size if the element does not have text. It might be better to refer parent font-size if we detect it though.","Pushed by ealvarez@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/c0f7fb9a866c
Use default action target to compute scroll amount. r=masayuki","Backed out changeset c0f7fb9a866c (Bug 1745529) for causing mochitest failures in test_moz_mouse_pixel_scroll_event.html CLOSED TREE

Push with failures: https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&collapsedPushes=842382&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=c0f7fb9a866c12e014f57a263b9a21bc62d2371f&selectedTaskRun=L5IeS85CS8-xvagRa2i6PA.0

Log: https://treeherder.mozilla.org/logviewer?job_id=361199682&repo=autoland&lineNumber=2398

Backout: https://hg.mozilla.org/integration/autoland/rev/d797a5113bef9e7b141f4b2affa52e4e56f58164","Pushed by ealvarez@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/83969b8b9a44
Use default action target to compute scroll amount. r=masayuki","Pushed by emilio@crisal.io:
https://hg.mozilla.org/integration/autoland/rev/4bf03b52cc25
Skip DELTA_MODE_PAGE tests on Android since they fail but I can't repro.","https://hg.mozilla.org/mozilla-central/rev/83969b8b9a44
https://hg.mozilla.org/mozilla-central/rev/4bf03b52cc25","Verified, mousewheel-scrolling now works consistently at https://www.nuro.ai/ .  Thanks for the quick fix, emilio!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1781786,Switching to scrolling-boxes.html tab became slower after bug 1779952,FIXED,"Steps to reproduce:

1. Navigate to https://web.archive.org/web/20110313233153id_/https://people.mozilla.org/~roc/scrolling-boxes.html
2. Open a new tab
3. Switch back to scrolling-boxes.html

Actual results:
Takes a bit of time

Expected results:
Takes a bit less time.

I also noticed that interactive performance of the browser UI is really bad with scrolling-boxes.html open. It took 500ms for the address bar to finish opening in one case, very strange. 

Tab switching before bug 1779952: https://share.firefox.dev/3BjvBpG
Tab switching after bug 1779952: https://share.firefox.dev/3zBp9Jv
Moving cursor around the browser UI, opening the address bar before bug 1779952 with scrolling-boxes.html open: https://share.firefox.dev/3zdyDsN
Moving cursor around the browser UI, opening the address bar after bug 1779952 with scrolling-boxes.html open: https://share.firefox.dev/3PVUr31",Set release status flags based on info from the regressing bug 1779952,"Created attachment 9287354
Bug 1781786 - Optimize some of the clip-set building process

Pre-cache the clip set -> node information as entries are pushed
on to the clip-tree builder stack.

This page is still not fast (it's a worst case for our current
code with box-shadow clips) but it's better than without this
patch (and we have plans to optimize the box-shadow case).","Pushed by gwatson@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/badab985521a
Optimize some of the clip-set building process r=gfx-reviewers,nical",https://hg.mozilla.org/mozilla-central/rev/badab985521a,"Reproduced the issue on Firefox 105.0a1 (2022-07-27) under Ubuntu 22.04 by following the STR from Comment 0.

The transition between tabs is slightly better but still a bit hangy (see Comment 2) on Firefox 106.0b9 and Firefox 107.0a1 (2022-10-09). Tests were performed on Ubuntu 22.04, macOS 13 and Windows 11.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1787603,Slow loading Wikipedia home page on Linux due to FcConfigCompareValue in libfontconfig.so.1,FIXED,"Created attachment 9291895
Firefox profile on a fresh Ubuntu 22.04.1 LTS live USB

User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0

Steps to reproduce:

1. Boot into an Ubuntu 22.04.1 LTS* live USB.
2. Connect to the Internet.
3. `sudo snap refresh firefox` to install the latest version of Firefox.
4. Open Firefox.
5. Navigate to https://www.wikipedia.org/

* I was also able to reproduce this problem on a Kubuntu 22.04.1 LTS live USB as well.  It happens regardless of whether Firefox is running from Snap, Flatpak, or DEB.  This issue is also reproducible on all past versions of Nightly as far back as the common TLS ciphers of https://www.wikipedia.org/ will allow.


Actual results:

As the site is loading, notice that there is a blank page for a few seconds while the indeterminate blue progress bar bounces.  The page then loads quickly after this delay.

The profiler shows that most of the time is spent on the `FcConfigCompareValue` function from the `libfontconfig.so.1` resource.  See the attached profile for more details.


Expected results:

There should not have been a delay of a few seconds when initially loading the site.  This slow performance does not happen in other browsers such as Chromium.","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Core::Networking' component, and is moving the bug to that component. Please correct in case you think the bot is wrong.","The profiler data showed that most of the slowness was in the category ""Layout: Reflow"", so I've moved the bug to Core » Layout.","The severity field is not set for this bug.
:boris, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).","Hi,
I am able to reproduce this performance issue on latest nightly Fx 107.0a1 from 2022-10-12 and on Firefox 106.0, using Ubuntu 22. The same issue I see on Windows 10 x64 platform too, on Chrome the delay is not present, the page load is instantly.
I will set this as New and waiting for the developers opinion about it. If this is not the correct component please feel free to change it to a more appropriate one.","Thanks, Timea. Clear my ni and let the performance guys assign the Serverity.","The performance component is only for issues where the correct component is not known. Moving this back into Text & Fonts and including a performance triage.

The [Performance Impact Calculator](https://mozilla.github.io/perf-triage/calculator.html) has determined this bug's performance impact to be **low**. If you'd like to request re-triage, you can reset the Performance Impact flag to ""?"" or needinfo the triage sheriff.

Configuration: Rare
Page load impact: Some
Websites affected: Major","What does ""Configuration: Rare"" mean?  This bug reproduces with the default configuration on Linux, regardless of distribution, so shouldn't this be ""Configuration: General""?","(In reply to deltik from comment #7)
> What does ""Configuration: Rare"" mean?  This bug reproduces with the default configuration on Linux, regardless of distribution, so shouldn't this be ""Configuration: General""?

I misread part of the report and thought it was only on Flatpak. Re-running.

The [Performance Impact Calculator](https://mozilla.github.io/perf-triage/calculator.html) has determined this bug's performance impact to be **medium**. If you'd like to request re-triage, you can reset the Performance Impact flag to ""?"" or needinfo the triage sheriff.

Page load impact: Some
Websites affected: Major","The description specifies running from a ""live USB"" source.... I suspect that may be contributing to fontconfig slowness, compared to a standard install. So the impact on most users may be significantly less.","(In reply to Jonathan Kew [:jfkthame] from comment #9)
> The description specifies running from a ""live USB"" source.... I suspect that may be contributing to fontconfig slowness, compared to a standard install. So the impact on most users may be significantly less.

I provided the live USB instructions to make the issue easy to reproduce.  It's affecting my main system on an NVMe SSD, too, which was how I noticed the bug.  You can also pass `toram` in the boot options to run everything out of RAM to rule out the disk.

On my main Kubuntu 22.04.1 system with Firefox 106.0.2, I have about a 3-second delay before https://www.wikipedia.org/ will load.  It used to be about 7 seconds before I deleted my fontconfig cache at `~/.cache/fontconfig` and ran `fc-cache -v -r`.","OK, thanks for clarifying that.","The severity field is not set for this bug.
:TYLin, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).",I can reproduce something similar on Nightly (2022-11-16) https://share.firefox.dev/3hRmaGb,"OK, I think I know where most of the time is going. This is largely a result of bug 1756400, where we made font selection via fontconfig respect the lang attribute (if present) of the content, so that we can correctly respect different font settings for zh-CN vs zh-HK or zh-TW, for example.

The wikipedia.org home page, unfortunately, has something like 300 language-name links, each tagged with its appropriate `lang=...` in the HTML, and with a font-family list of about 7 family names (plus a CSS generic). So now when we're resolving the CSS font properties to determine what actual fonts to use, we end up running each of those 7 names through the fontconfig substitution functions 300 separate times, with each distinct lang code. We cache the results of that, per language and font-family name (so it's only expensive the first time), but that's what is hurting us here.

On my Linux machine, it takes around a millisecond to make the FcConfigSubstitute calls here, which is OK when there are a handful of font names to process, and a few distinct lang tags. But with a font-family list of 7 names multiplied by 300+ lang tags, we're looking at 2+ seconds right there.

This is pretty sad. Part of the problem is wikipedia's font-family list, which has `-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Lato, Helvetica, Arial, sans-serif`. So for every one of the 300+ lang codes, we ask fontconfig to resolve each one of those names -- even though most of them will just end up mapping to a default. The trouble is, we can't really *not* do this, because it's possible the user has a fontconfig configuration with alias/substitution rules to map these names to some other preferred font, and if we don't process those rules, we won't render the user's desired font.

If wikipedia used a simplified font-family list such as `system-ui, sans-serif` instead of attempting to explicitly name various potential ""system"" and default sans-serif fonts, I believe performance here would be substantially improved. But this sort of pattern is unfortunately quite common, I think, so we should see if there are ways we can optimize it better.","What I propose we do here is to partially undo the behavior change from bug 1756400, whereby we always include the content `lang` when doing fontconfig lookups. While in principle this could apply to any language, the cases where it's likely to matter in practice are the CJK languages, plus perhaps Arabic script (where, for example, Urdu or Kashmiri may prefer a very different style than the default used for most other Arabic-script languages).

So what we can do to mitigate the issue here is to avoid doing separate per-`lang` lookups *except* for these cases where there's a stronger likelihood of having distinct font configurations. We don't really need to be doing it for `lang=en` vs `fr` vs `nl` etc., where the same font configuration should be applicable to all languages using Latin script. This will dramatically reduce the number of fontconfig operations needed when loading a page like Wikipedia.","Created attachment 9303900
Bug 1787603 - Only pass content lang to fontconfig for CJK & Arabic scripts, to avoid performance quagmire on pages like wikipedia.org. r=#layout-reviewers


This in effect reverts part of bug 1756400, so that we only do the full
per-language fontconfig substitution processing for locales that use
CJK or Arabic script. These are the locales where it is likely that
there may be custom per-language/locale font preferences that need to
be respected.

(In theory fontconfig could be set up with per-language rules even for
distinctions like 'en-US' vs 'en-GB', or 'en' vs 'fr' vs 'de', etc.,
and we will no longer respect these. But it is almost vanishingly unlikely
that separate font mappings for such distinctions will really be needed,
and the cost of doing all the lookups separately for every lang tag,
even within simple writing systems like Latin, is excessive.)

No automated tests, as this is heavily dependent on the system configuration.","Pushed by jkew@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/e405b207d966
Only pass content lang to fontconfig for CJK & Arabic scripts, to avoid performance quagmire on pages like wikipedia.org. r=jwatt",https://hg.mozilla.org/mozilla-central/rev/e405b207d966,"Since nightly and release are affected, beta will likely be affected too.
For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#missing_beta_status.py).","Created attachment 9304783
Nightly profile with changeset bd8c9b741d01c77c5b52087717032ecbbfcafcf3

I don't believe the bug is fixed.  Attached is a new profile from Nightly with changeset bd8c9b741d01c77c5b52087717032ecbbfcafcf3, and https://www.wikipedia.org/ is still blocked for 3.0s waiting for ""Reflow"".

Remember that this bug is present on all past versions of Nightly as far as the common TLS ciphers with the website will allow, so whatever was changed in bug 1756400 from 9 months ago is probably unrelated.","That's odd.... on my Linux machine I was seeing about a 3s reflow on first load of wikipedia.org, but with the patch here it dropped to around 0.4s (fairly consistently, across multiple runs).

Ting-Yu, in comment 13 you said you could reproduce something similar; when you're back, could you please check again with current Nightly and see how it behaves for you? Thanks!","(In reply to Pulsebot from comment #17)
> Pushed by jkew@mozilla.com:
> https://hg.mozilla.org/integration/autoland/rev/e405b207d966
> Only pass content lang to fontconfig for CJK & Arabic scripts, to avoid
> performance quagmire on pages like wikipedia.org. r=jwatt

== Change summary for alert #36155 (as of Wed, 23 Nov 2022 05:32:04 GMT) ==
### Improvements:

| **Ratio** | **Test** | **Platform** | **Options** | **Absolute values (old vs new)**| 
|--|--|--|--|--| 
| [19%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405626,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) FirstVisualChange | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 1,223.33 -> 986.67 |
| [19%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405625,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) ContentfulSpeedIndex | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 1,226.42 -> 990.08 |
| [19%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405629,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) SpeedIndex | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 1,226.83 -> 991.00 |
| [19%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405631,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) fcp | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 1,173.46 -> 948.62 |
| [19%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405628,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) PerceptualSpeedIndex | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 1,228.17 -> 993.00 |
|...|...|...|...|...|
| [9%](https://treeherder.mozilla.org/perfherder/graphs?timerange=1209600&series=autoland,4405627,1,13)  | [wikipedia](https://firefox-source-docs.mozilla.org/testing/perfdocs/raptor.html#wikipedia-d) LastVisualChange | linux1804-64-shippable-qr | bytecode-cached cold fission webrender | 2,086.67 -> 1,890.00 |

For up to date results, see: https://treeherder.mozilla.org/perfherder/alerts?id=36155","I can confirm this issue is fixed, I verified using Firefox Nightly 109.0a1 (Build ID: 20221127212619) on Win 10 x64, macOS  12 and Ubuntu 22  x64, the Wikipedia page load is instantly, there is no loading delay.","I can also verify Jonathan's patch works for me. Here's the profile on Nightly (2022-11-28) https://share.firefox.dev/3GUBuww. The time spent in the purple ""Layout:Reflow"" was less than 1 second, whereas in the comment 13's profile on Nightly (2022-11-14) https://share.firefox.dev/3hRmaGb, the time spent in purple ""Layout:Reflow"" is ~ 3 seconds. A local mozregression run on my machine also bisects to this bug that improves the performance of loading Wikipedia.

Though given deltik 's comment 20 and bug 1802816, there might be other factors affecting the performance, but it's not clear to me how to reproduce.","Using my own steps to reproduce as originally reported, I can confirm a big improvement in the ""Layout: Reflow"" time on a Kubuntu 22.04.1 LTS live USB.

* Firefox 107.0 – 9.2 seconds – https://share.firefox.dev/3OXTrwd
* Nightly 109.0a1 (2022-11-28) – 1.1 seconds – https://share.firefox.dev/3ieZAYp

But the layout time is still quite bad at more than 6× slower than Chromium, which took 148.5ms doing the ""Layout"" activity.  Here's the profiler result from Chromium 107.0.5304.121: https://pastebin.com/raw/3vpKfexr

----

Should I open a new issue if I figure out how to reproduce the slow ""Layout: Reflow"" on my main computer?  Or perhaps this issue should be reopened because the layout time is still not on par with Chromium?","It gets difficult to keep track of things if we keep reopening a bug and perhaps adding new patches to it, unless the original patch really didn't work and needs to be reverted or substantially changed. In this case, better to open a new issue, as the patch that landed here clearly did make a significant difference. So it worked as expected/intended, although further improvement would certainly still be desirable.

[edit: It may be that bug 1802816 is the ""new issue"" needed; I haven't looked into that in detail yet.]

Regarding comparison with Chromium, I'm not sure this is entirely valid because (if I understand correctly) Chromium does not make the same attempts to respect various fontconfig settings; it prefers to ""do its own thing"", ignoring many kinds of fontconfig customization that may be present.","All right, I'm content with leaving this bug closed, and I filled in some more details in bug 1802816 comment 2 to suggest further improvements.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1792451,"New error on TB 102.3, POP3: ""The account X is being processed. Please wait until processing is complete to get messages."" (with slow or not responsive server)",FIXED,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0

Steps to reproduce:

This seems to be new with Thunderbird 102.3.0 (32-bit), which was installed a few days ago. Running on Windows 10 Enterprise. Using POP3. Mail server is Gmail.

Open Thunderbird, mail gets checked automatically.
Wait a bit.
Click on ""check messages"".


Actual results:

Pop-up message: 
The account X is being processed. Please wait until processing is complete to get messages.

Nothing gets downloaded until I restart the program.


Expected results:

Messages should have been checked.","The error seems to happen when the server is slow or stops responding. Perhaps what is happening is that instead of timing out, the program keeps trying to check for new email, with the result that the account ""is being processed"" forever.","(In reply to Fernando Gouvea from comment #1)
> The error seems to happen when the server is slow or stops responding. Perhaps what is happening is that instead of timing out, the program keeps trying to check for new email, with the result that the account ""is being processed"" forever.

Ping, any insights?","Created attachment 9296418
Bug 1792451 - Set socket timeout in Pop3Client to release folder lock. r=mkmelin","Thanks for reporting, I'm not totally sure my patch can fix your problem, but worth a try.","Fernando, can you attach a pop3 protocol log? https://wiki.mozilla.org/MailNews:Logging","Pushed by thunderbird@calypsoblue.org:
https://hg.mozilla.org/comm-central/rev/144b74e92a20
Set socket timeout in Pop3Client to release folder lock. r=mkmelin","Comment on attachment 9296418
Bug 1792451 - Set socket timeout in Pop3Client to release folder lock. r=mkmelin

[Approval Request Comment]
Regression caused by (bug #): pop3-js
User impact if declined: If Pop3Client is waiting for a unresponsive server, the folder maybe locked for a long time.
Testing completed (on c-c, etc.): c-c
Risk to taking this patch (and alternatives if risky): no risk","Comment on attachment 9296418
Bug 1792451 - Set socket timeout in Pop3Client to release folder lock. r=mkmelin

[Triage Comment]
Approved for beta

[Triage Comment]
approved for esr102","Thunderbird 106.0b4:
https://hg.mozilla.org/releases/comm-beta/rev/daa3d45d2271","Thunderbird 102.3.2:
https://hg.mozilla.org/releases/comm-esr102/rev/c1ca3473de08",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1745591,"System font rasterization on macOS 11+ slows down page load, tab opening and tab switching, take 2",FIXED,"This is a follow-up to bug 1683975, which only fixed part of the problem.

---

The default new tab page displays some text, for example in the Pocket suggestions. This text uses the system font.
With WebRender, we seem to be re-rasterizing system font glyphs on every new tab. Creating system fonts seems to be particularly slow on Big Sur. This delays the paint of the new tab by 100ms.

Loading pages that use system fonts, for example github or  stackoverflow, also incurs this issue.
Tab switching can also hit this, for tabs that haven't been painted in a while.

Steps to reproduce:
 1. Open a new Firefox window, and navigate to mozilla.org.
 2. Press Cmd+T to open a new tab.
 3. Press Cmd+T again to open another new tab.

Expected results:
Opening a new tab, or switching between github tabs, or loading a gith, should be really fast.

Actual results:
There is a 100ms paint delay. Profile: https://share.firefox.dev/31V7r5m
You can see ""BlockOnResources"" markers on the RenderBackend thread that take over 100ms.","The severity field is not set for this bug.
:jimm, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).","This is currently one of the top Firefox performance problems on macOS. It's a very frequent source of jank during tab switching and page load.
Setting qf priority to 1, and I think this deserves a higher severity than S4.","I did some local instrumentation and profiling of this: https://share.firefox.dev/3t3ddM4

It seems like running the profiler slows things down by more 2x. The time for a single call to new_ct_font_with_variations goes from around 3-4ms to 9-12ms (With mozilla::profiler::AllocCallback being mostly to blame).","This was mostly fixed by bug 1758555: We now only rasterize the fonts once per window. This means that opening a new tab is fast, and switching tabs in the same window is also usually fast.

There's still work to do to share fonts across windows, or to reduce the time it takes to initialize these fonts. But the main performance problem in this bug is fixed.

Thanks, Lee!","I was able to reproduce the delay on Firefox 97.0a1 (2021-12-11) on macOS 13 by following the info provided in Comment 0.

Verified that the issue is fixed on Firefox 100.0.2 and a newer Firefox 106.0b9 and the performance was greatly improved. Tests were performed on the same system as above.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1801539,PDF.js slow rendering of timetable pdf with gfx.canvas.accelerated set to true,FIXED,"Created attachment 9304298
Fahrplan_Krimml_2022_Hochwasser_SEV_abNsi_aktuell.pdf

User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/109.0

Steps to reproduce:

1. opened https://www.pinzgauerlokalbahn.at/content/dam/websites/pinzgauerlokalbahn/Downloads/Fahrplan_Krimml_2022_Hochwasser_SEV_abNsi_aktuell.pdf


Actual results:

pdf.js is slow at rendering the pdf - one can watch it draw line-by-line


Expected results:

pdf.js should render the pdf as fast as poppler","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Firefox::PDF Viewer' component, and is moving the bug to that component. Please correct in case you think the bot is wrong.","Is it reproducible with the option `gfx.canvas.accelerated` set to `false`?
Could you get a profile (see https://profiler.firefox.com/) of the pdf loading and share it here ?","I managed to reproduce this, it is only reproducible with gfx.canvas.accelerated set to true.",":lsalzman, since you are the author of the regressor, bug 1770088, could you take a look? Also, could you set the severity field?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#needinfo_regression_author.py).","Created attachment 9304671
Bug 1801539 - Attempt to cache the state of the clip mask for when mask is regenerated. r?aosmond


For use-cases that repeatedly pop and re-push the same clips over and over, we can regenerate the
same mask that is already still stored, because we only detect that clip state changed, rather than
that it changed to exactly the same state it was previously.

This just remembers the previous state of the clip stack at the time the clip mask was generated
so that we can compare the previous and current state. If they're the same, we can assume there
is no need to regenerate the clip mask again and simply reuse it.","Pushed by lsalzman@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/907adfcff538
Attempt to cache the state of the clip mask for when mask is regenerated. r=aosmond",https://hg.mozilla.org/mozilla-central/rev/907adfcff538,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1738514,I lost my synchronization after last Update of browser Mozilla Firefox!,FIXED,"Created attachment 9248488
Mozilla-notSync.JPG

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0

Steps to reproduce:

Update to Last Version (93) of browser. I done it from browser window


Actual results:

I lost my synchronization. And after I was trying to enter to my Firefox Account I see the page that its need to activate cookies and local storage, but them is activate!!!



Expected results:

I have my personal Firefox Account AND it was working to today. And i doesn't touched and does not changed the options of my browser! But after that update I cant to enter my account to synchronized my data!","Created attachment 9248489
Mozilla-notSync-COOKIES.JPG","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Cloud Services::Server: Firefox Accounts' component, and is moving the bug to that component. Please revert this change in case you think the bot is wrong.",That's right!,"So! I solved this bug myself.

I rename profile directory & restart Firefox. After creating new profile I could entered to syncaccount. After that I closed browser & replaced all files of old profile root catalog (only files don't catalogs). After that I had gotten my old browser with all opened tabs and passkeys and with synchronization.","Hi there, I'm so glad you were able to resolve your issue. I'm going to mark this as resolved, thank you!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1747345,"In Firefox version 95.0.2, <svg> images inside the iframe are distorted (with fission and dom.animations.mainthread-synchronization-with-geometric-animations enabled, as they are on current release versions)",FIXED,"Created attachment 9256669
firefox-bug.png

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36

Steps to reproduce:

In Firefox version 95.0.2, <svg> images inside the iframe are distorted. The same problem is present in the latest beta versions
If you switch to the Troubleshoot Mode, then there is no such problem. There is also no problem in versions older than 95.0.2.
This effect disappears if you just switch to another tab and go back.

Completely reset settings, cookies, etc. - does not help. This problem is observed in everyone who has version 95.0.2.

Here is an example with a bug on Firefox 95.0.2. - https://codepen.io/GloomyCoder/pen/KKXvOmb

On older versions and on other browsers - everything is ok.


Actual results:

In Firefox version 95.0.2, <svg> images inside the iframe are distorted. The same problem is present in the latest beta versions
If you switch to the Troubleshoot Mode, then there is no such problem. There is also no problem in versions older than 95.0.2.
This effect disappears if you just switch to another tab and go back.

Completely reset settings, cookies, etc. - does not help. This problem is observed in everyone who has version 95.0.2.

Here is an example with a bug on Firefox 95.0.2. - https://codepen.io/GloomyCoder/pen/KKXvOmb

On older versions and on other browsers - everything is ok.


Expected results:

svgs in an iframe should be of normal size as in other browsers","Created attachment 9256672
firefox-normal.png

And in this screenshot (firefox-normal.png) it looks like this if you switch to another tab and go back. I.e. this bug disappears.","Comment on attachment 9256669
firefox-bug.png

In this screenshot (firefox-bug.png) all svg icons are curves. But they become normal if you switch to another tab and go back.","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Core::SVG' component, and is moving the bug to that component. Please revert this change in case you think the bot is wrong.","Hmm, I don't see this in Nightly nor in 95....

> If you switch to the Troubleshoot Mode, then there is no such problem.

This hints at some kind of graphics issue, can you attach the contents of `about:support`?","(In reply to Emilio Cobos Álvarez (:emilio) from comment #4)
> Hmm, I don't see this in Nightly nor in 95....
> 
> > If you switch to the Troubleshoot Mode, then there is no such problem.
> 
> This hints at some kind of graphics issue, can you attach the contents of `about:support`?

This bug occurs in version >=95.0.2 (Firefox Setup 95.0.2.msi).
But everything is fine in version <=95.0 (Firefox Setup 95.0.msi)

This is a problem on both windows 10 and Mac.","Created attachment 9256690
firefox_about_support.txt

File with about:support attached",Able to reproduce issue in Firefox 95.0.2 but not Nightly 97.0a1 (2021-12-22). Not able to reproduce in Troubleshoot Mode or in a fresh profile.,"I can reproduce the issue in Firefix96.0b8 Windows10 but not in Nightly97.0a1 Windows10.

And Setting `dom.animations.mainthread-synchronization-with-geometric-animations` to `false` seems to fix in Firefix96.0b8.

So it seems related to Bug 1540906, Bug 1301305?",I was able to reproduce the issue on Release 95.0.2 on Win10 but not on NB (although I tried many builds from latest  97.0a1 to 94.0a1).,"It looks like this requires two prefs to be set a particular way, in order to be reproducible:
(1) `dom.animations.mainthread-synchronization-with-geometric-animations` needs to be `true` (per comment 8). Note that it defaults to `false` in Nightly (per bug  1540906), so you need to manually set it to `true` there.

(2)  `fission.autostart` needs to be `true` (note this is now the default in Nightly, as of last month).   Note that this dynamic pref-adjustment rolled out (via the experimenter infrastructure) to dynamically become the default around the Firefox 94/95 release timeframe.

So for example, I can reproduce this bug with Nightly from November 1st (or any recent date including today's date) with this invocation:
```
mozregression --launch 2021-11-01 --pref \
  ""dom.animations.mainthread-synchronization-with-geometric-animations:true"" \
  ""fission.autostart:true"" \
  -a https://codepen.io/GloomyCoder/pen/KKXvOmb
```

Using that same command but with `--good 2021-06-01 --bad 2021-11-01` instead of `--launch`, I got this regression range from October 13th:
https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=487c3eb6a0cdc989e28268562d1d753671fcdee6&tochange=c67cec98bf16173efd69cff2f12d1ffbb09c907f

Looks like this a regression from bug 1734740 and hence probably a WebRender bug. (Or potentially a latent bug that was getting papered-over by WebRender which was uncovered when bug 1734740 landed?)

Glenn, maybe you could take a look when you're back from PTO?",Set release status flags based on info from the regressing bug 1734740,"I can reproduce this locally, will investigate today/tomorrow.","The `snapping_transform` in the `SceneSpatialNode` ends up being different. This will explain the visual artifact, however I need to understand _why_ that can be different, before knowing what the right fix is.","Created attachment 9258258
Bug 1747345 - Include parent snapping transform in node equality test

We need to include the parent snapping transform in the test for
whether a spatial node needs to be updated from scene -> frame.","Pushed by gwatson@mozilla.com:
https://hg.mozilla.org/integration/autoland/rev/d62c3f84d38c
Include parent snapping transform in node equality test r=gfx-reviewers,aosmond",https://hg.mozilla.org/mozilla-central/rev/d62c3f84d38c,Can we land a test for this?,I wasn't able to create a reliable test for this on Gecko - it's very dependent on animation timing and specific deltas in individual display lists. What we can do is add some infrastructure to wrench specifically for testing this kind of scenario (where we have reliable control over when display lists are generated and the differences between them).,"(In reply to Glenn Watson [:gw] from comment #18)
> I wasn't able to create a reliable test for this on Gecko - it's very dependent on animation timing and specific deltas in individual display lists. 

Two musings in response to this (not necessarily requesting action unless it seems feasible):

(1) tests don't necessarily have to fail reliably in unfixed builds; they just need to be able to **pass reliably** in fixed builds, and fail at-least-occasionally in unfixed builds (on some platform/configuration).  That's enough to detect regressions & validate that the bug is fixed.

(2) The jsfiddle testcase here seemed to fail pretty reliably, which suggests that a reasonably-reliable regression test is possible at least in theory (though the jsfiddle testcase seems to be pretty unminimized, via reliance on an external JS library, so there may be some amount of minimization/testcrafting required to come up with one).  Even if `wrench` doesn't work for this, I wonder if a regular HTML/JS/CSS reftest would work.","The patch landed in nightly and beta is affected.
:gw, is this bug important enough to require an uplift?
If not please set `status_beta` to `wontfix`.


For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).","Comment on attachment 9258258
Bug 1747345 - Include parent snapping transform in node equality test

### Beta/Release Uplift Approval Request
* **User impact if declined**: Visual glitches in some cases
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: As per bug report
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Patch is very small, shouldn't affect any other code paths.
* **String changes made/needed**:","(In reply to Daniel Holbert [:dholbert] from comment #19)
> (In reply to Glenn Watson [:gw] from comment #18)
> > I wasn't able to create a reliable test for this on Gecko - it's very dependent on animation timing and specific deltas in individual display lists. 
> 
> Two musings in response to this (not necessarily requesting action unless it seems feasible):
> 
> (1) tests don't necessarily have to fail reliably in unfixed builds; they just need to be able to **pass reliably** in fixed builds, and fail at-least-occasionally in unfixed builds (on some platform/configuration).  That's enough to detect regressions & validate that the bug is fixed.

This is a good point - not something I had really considered.

> (2) The jsfiddle testcase here seemed to fail pretty reliably, which suggests that a reasonably-reliable regression test is possible at least in theory (though the jsfiddle testcase seems to be pretty unminimized, via reliance on an external JS library, so there may be some amount of minimization/testcrafting required to come up with one).  Even if `wrench` doesn't work for this, I wonder if a regular HTML/JS/CSS reftest would work.

It was a minimized HTML/JS test I was trying to create,  but I couldn't get it to reproduce at all. I think it needs very specific control over the delta between two display lists to reproduce. Adding some wrench testing infrastructure here shouldn't be a huge amount of work, but will allow us to test this case reliably.","(In reply to Daniel Holbert [:dholbert] from comment #19)
> (In reply to Glenn Watson [:gw] from comment #18)
> > I wasn't able to create a reliable test for this on Gecko - it's very dependent on animation timing and specific deltas in individual display lists. 
> 
> Two musings in response to this (not necessarily requesting action unless it seems feasible):
> 
> (1) tests don't necessarily have to fail reliably in unfixed builds; they just need to be able to **pass reliably** in fixed builds, and fail at-least-occasionally in unfixed builds (on some platform/configuration).  That's enough to detect regressions & validate that the bug is fixed.

This is a good point - not something I had really considered.

> (2) The jsfiddle testcase here seemed to fail pretty reliably, which suggests that a reasonably-reliable regression test is possible at least in theory (though the jsfiddle testcase seems to be pretty unminimized, via reliance on an external JS library, so there may be some amount of minimization/testcrafting required to come up with one).  Even if `wrench` doesn't work for this, I wonder if a regular HTML/JS/CSS reftest would work.

It was a minimized HTML/JS test I was trying to create,  but I couldn't get it to reproduce at all. I think it needs very specific control over the delta between two display lists to reproduce. Adding some wrench testing infrastructure here shouldn't be a huge amount of work, but will allow us to test this case reliably.","I was able to reproduce the issue on Win10x10 using NB build 96.0a1 (20211129215324) and settings from comment10.
Verified as unreproducible on Win10 and Mac10.13 using NB 98.0a1 (20220113215749) with settings from comment10 both set/not set.","Comment on attachment 9258258
Bug 1747345 - Include parent snapping transform in node equality test

Approved for 97.0b4.",Verified as unreproducible on Win10/Mac10.13/Ubuntu20.4 using Beta 97.0b4(20220116190254).,https://hg.mozilla.org/releases/mozilla-beta/rev/2173ce4bf65f9beaa1e008f59ba762a91be4aa25,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1462949,Crash report submission failed,INVALID,"Created attachment 8979064
1.pcapng

User Agent: Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0
Build ID: 20180430140610

Steps to reproduce:

Crash submission always fails from sometime last year. I tested it last night using ""Nightly tester tools"" addon to crash Firefox manually.


Actual results:

First I tested whether it is due to the great firewall blocking. ""Nightly tester tools"" addon seems uses IE proxy setting instead of Firefox' proxy setting, so I set a wall breaker proxy in IE proxy setting. Submission still failed, but the error log changed from ""An error occurred in the secure channel support"" (or sometimes ""A connection with the server could not be established"") to ""The server returned an invalid or unrecognized response"". So it seems not related to blocking.

Second I captured net packets using Wireshark. The error happened right after secure connection attempts to crash-reports.mozilla.com, which is resolved to 34.212.223.156, one as TLSv1 and another as SSLv3, and both failed as ""Handshake failure"". The log file will be attached.

Third I connected to crash-reports.mozilla.com using Firefox, and got a blank page without content. So it seems crash-reports.mozilla.com was not working or it does not accept Firefox.

Fourth, the submission in the Firefox about:crashes succeed. 


Expected results:

It should submit.","Created attachment 8979065
2.pcapng","From a former submit.log:

[09/09/16 09:41:43] Crash report submitted successfully
[09/18/16 16:45:24] Crash report submitted successfully
[Tue Apr 25 09:08:03 2017] Crash report submission failed: An error occurred in the secure channel support
[Tue Apr 25 21:42:47 2017] Crash report submission failed: An error occurred in the secure channel support
[Sun Apr 30 09:46:31 2017] Crash report submission failed: The server name or address could not be resolved
[Wed May 10 15:34:26 2017] Crash report submission failed: An error occurred in the secure channel support
[Fri May 19 09:21:38 2017] Crash report submission failed: The server name or address could not be resolved
[Fri Jun 16 09:26:35 2017] Crash report submission failed: An error occurred in the secure channel support
[Fri Jul  7 18:39:41 2017] Crash report submission failed: An error occurred in the secure channel support
[Thu Jul 27 14:33:11 2017] Crash report submission failed: The server name or address could not be resolved
[Tue Sep  5 16:38:15 2017] Crash report submission failed: An error occurred in the secure channel support
[Thu Sep 21 10:05:55 2017] Crash report submission failed: An error occurred in the secure channel support

The crash reporter may have some code change between 2016-9 and 2017-4 (timestamp format is changed), which caused the bug.","(In reply to Lu Wei from comment #0)
> 
> First I tested whether it is due to the great firewall blocking. ""Nightly
> tester tools"" addon seems uses IE proxy setting instead of Firefox' proxy
> setting, so I set a wall breaker proxy in IE proxy setting. Submission still
> failed, but the error log changed from ""An error occurred in the secure
> channel support"" (or sometimes ""A connection with the server could not be
> established"") to ""The server returned an invalid or unrecognized response"".
> So it seems not related to blocking.
> 

ps: Another wall breaker proxy got ""An error occurred in the secure channel support"" too.","Hi Lu Wel,

Based on the following official declaration (https://support.mozilla.org/en-US/kb/end-support-windows-xp-and-vista ) Firefox no longer supports Windows XP, the last complete update was version 52.

Due to the above information, I bilieve that the development team is no longer involved in investigating issues encountered on Windows XP.","I seems to have understood and resolved the issue recently, after I applied PosReady hack to WindowsXP. The problem should be caused by the TLS protocol upgrade of mozilla's server, which WindowsXP failed to follow. After I updated WindowsXP to current, system can support TLS to 1.2, then crash report could be sent out, although it will not got any handling. Just for notification.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1472420,Firefox crashes when trying to save something,INVALID,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0
Build ID: 20180621125625

Steps to reproduce:

Possibility a) Save a download file, crashes after the file save dialog, b) context menu save-as on a displayed image.


Actual results:

Crash.

Console output:

###!!! [Parent][DispatchAsyncMessage] Error: PClientSourceOp::Msg___delete__ Route error: message sent to unknown actor ID


###!!! [Parent][DispatchAsyncMessage] Error: PClientSourceOp::Msg___delete__ Route error: message sent to unknown actor ID


(firefox:25793): Gtk-WARNING **: Could not load a pixbuf from icon theme.
This may indicate that pixbuf loaders or the mime database could not be found.
**
Gtk:ERROR:/build/gtk+3.0-NmdvYo/gtk+3.0-3.22.11/./gtk/gtkiconhelper.c:493:ensure_surface_for_gicon: assertion failed: (destination)
Redirecting call to abort() to mozalloc_abort

ExceptionHandler::GenerateDump cloned child 26004
ExceptionHandler::SendContinueSignalToChild sent continue signal to child
ExceptionHandler::WaitForContinueSignal waiting for continue signal...

(crashreporter:26005): Gtk-WARNING **: Could not load a pixbuf from /org/gtk/libgtk/icons/16x16/status/image-missing.png.
This may indicate that pixbuf loaders or the mime database could not be found.
**
Gtk:ERROR:/build/gtk+3.0-NmdvYo/gtk+3.0-3.22.11/./gtk/gtkiconhelper.c:493:ensure_surface_for_gicon: assertion failed: (destination)




Expected results:

App should not crash.","Identified as a problem of another software which introduced lacking permission for some of the icons. Not ideal, but absolutely no fault of Firefox.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1473391,"Intense ""Gah! your tab just crashed"" storms I can't duplicate",INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0
Build ID: 20180621125625

Steps to reproduce:

Sorry, I've never been able to reproduce one of these. 


Actual results:

Since about May 2018 I experience isolated but intense ""Gah! your tab just crashed"" storms. They only happen when I have several complex pages open in multiple tabs at the same time. I've never been able to recreate one intentionally, so I don't think it is the actual pages. It really does seem to correlate with how hard the browser is working. It does use _lots_ of system memory, but it never gets close to using it all. Close the complex tabs and it runs fine for more days. 

For instance, 
https://www.amazon.com/Sarjana-Handicrafts-Cotton-Bedspread-Bedding/dp/B072612R5R/ref=pd_sbs_201_5?_encoding=UTF8&pd_rd_i=B072612R5R&pd_rd_r=V6BSK8426T4G0A1ZDKDJ&pd_rd_w=eKMCa&pd_rd_wg=0ETfI&psc=1&refRID=V6BSK8426T4G0A1ZDKDJ&dpID=51xbyO5bBBL&preST=_SX300_QL70_&dpSrc=detail
works fine today. It is a good example of the kind of page than fails - images that change in response to mousing over other parts of the content. 

A unique thing that sometimes happens is that most of a page turns black, and only a few squares of content get drawn. Mousing over black areas sometimes causes new squares to be drawn. Yesterday at one point the entire screen turned black, Windows taskbar and all - maybe Firefox put itself in full screen mode? Toggling to another app ended that. 

For another example, 
https://www.pinterest.com/pin/209347082663219420/
also works fine outside a ""storm"" period. But it illustrates a really interesting thing I've seen a few times: 

This is NirSoft ""BrowsingHistoryView""
Visit Time	Title	URL	Visited From	Visit Type	Visit Count	URL Length	Typed Count	

I tried to open the page in Firefox: 
7/3/2018 3:33:48 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420/	https://www.google.com/search?q=king+flat+cotton+brown+pattern+sheet+-set&num=100&newwindow=1&client=firefox-b-1-ab&tbm=isch&source=iu&ictx=1&fir=0GnjLTTVdP1ybM%253A%252CX4d4mImfB3-o_M%252C_&usg=__ln8r1v-EDS6GyIhbCZ4dHrcwm9k%3D&sa=X&ved=0ahUKEwjo2Zyg-YPcAhWFro8KHYY7AsAQ9QEIkgIwAg&biw=1629&bih=1052#imgdii=jBRX2-seLm8fvM:&imgrc=zdhf0_exlf_xRM:	Link	1	49		

The tab crashed and re-opened:
7/3/2018 3:34:30 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420	https://www.pinterest.com/pin/209347082663219420/	Link	1	48		

And immediately crashed again. I gave up and tried Chrome:
7/3/2018 3:35:35 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420		Link	1	48	0	
7/3/2018 3:35:35 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420/	https://www.pinterest.com/pin/209347082663219420	Link	2	49	0	

The Chrome page load failed, and automatically tried to reload:
7/3/2018 3:36:46 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420/		Reload	2	49	0	

But the reload tab crashed:
7/3/2018 3:36:58 PM	Fix ""Aw, Snap!"" page crashes and other page loading errors - Computer - Google Chrome Help	https://support.google.com/chrome/answer/95669?visit_id=1-636662542183728790-2017400790&p=e_awsnap&rd=1	https://support.google.com/chrome/?p=e_awsnap	Link	1	103	0	
7/3/2018 3:36:58 PM	Fix ""Aw, Snap!"" page crashes and other page loading errors - Computer - Google Chrome Help	https://support.google.com/chrome/?p=e_awsnap		Link	1	45	0	

I manually opened a new Chrome tab and pasted in the URL, and it worked fine: 
7/3/2018 3:40:16 PM	Multicoloured Rawawork Cotton Flat Bed Sheet - Super King | Flat bed, Small mirrors and Cotton	https://www.pinterest.com/pin/209347082663219420/		Link	2	49	0	

--> I've seen that several times - if Firefox is having a tab crash storm, and I give up and try Chrome, the first Chrome tab will also crash! How can that possibly happen? There has to be a clue there...  


Another site with complex graphics that seems a frequent victim of crash storms:

6/30/2018 6:25:00 PM	National Hydrography Dataset Plus High Resolution (NHDPlus HR) Availability Map	https://usgs.maps.arcgis.com/apps/MapTools/index.html?appid=41a5c2ca49bd4a83b239450e61022d53	https://nhd.usgs.gov/NHDPlus_HR.html	Link	1	92		

I remember the tab crashing and trying to restore itself several times, but only that one line made it into my history. I only have two crash reports despite way more attempts: 
Submitted:
bp-484a4063-579b-4017-8527-40d5f0180701	6/30/2018	6:25 PM
Unsubmitted:
4b113193-14b3-408c-a99e-2ee3b92191e5	6/30/2018	6:25 PM

Seems like after a couple of reports it stops making them? 


Also...  If I manually submit those, the time and date change to the time I manually triggered the upload, which makes it impossible to correlate the report with what I was doing when it happened. Can it be that the actual event time is not preserved anywhere? 


So this is probably not very helpful, but the usual debugging strategies are pretty hopeless when Firefox will work fine for days and then suddenly get a storm of tab crashes that can't be duplicated. Is there some ""stress level"" indicator I could check? Some app that could correlate all my crash reports and suggest what they have in common? Something else a reasonably technical user could do while a storm is happening to help with this? 


In case it might hold clues, here is my report list. These are not nearly all the times I've seen a tab crash, lots of times the report dialog doesn't appear...  

Unsubmitted Crash Reports
Report ID 	Date Crashed
a666369a-6faf-4c19-85b4-853d6790166f
	6/30/2018	6:47 PM
4b113193-14b3-408c-a99e-2ee3b92191e5
	6/30/2018	6:25 PM
ae3acdb7-ca6b-4262-9118-78b36fa49d48
	6/30/2018	12:24 PM
49e0b47f-6daf-42a9-b4cf-83210b193c18
	6/11/2018	2:22 PM
0148ca08-ecea-4212-814d-12b21b32ce67
	6/9/2018	6:19 PM
28cfce4f-f3b6-4011-b57e-27d174c9bcdd
	6/3/2018	5:05 PM
91f88cea-9a72-4aca-bae0-b81023b5f931
	6/1/2018	6:15 PM
44d204b9-2694-4322-9ee2-8ed9ac155bbe
	5/28/2018	11:17 PM
89dc094d-42f7-47d0-afec-aa6900f6f5be
	5/20/2018	5:57 PM
27ac2b27-c9f3-4d96-a43f-5fd0062d4575
	5/6/2018	10:23 PM
a4bbc020-d0b4-4fde-bb39-ed0a91a2ad0f
	5/6/2018	10:23 PM
f2833d07-93d8-4acb-8922-786ccf29a67d
	5/6/2018	10:23 PM
cf761af8-8d04-46ba-9848-dabc728f5703
	5/6/2018	10:23 PM
451ad7fa-844c-4f88-aa0e-96f0b8408417
	5/6/2018	10:23 PM
ab1d3542-249d-429b-ae92-885c91b2af53
	5/6/2018	10:23 PM
99af75d6-0631-4cd0-b8b3-880dabad771f
	5/6/2018	10:23 PM
88bd11b0-55d1-4312-a7bb-206b71075e6a
	5/6/2018	10:23 PM
c568e8eb-ee38-46c8-8c29-5c2634172b5c
	5/6/2018	10:23 PM
5d0e6340-94df-4228-aca9-027711bf6450
	5/6/2018	10:23 PM
fbd6a08d-240b-4ce8-a1db-3e0748fbec1c
	5/6/2018	10:23 PM
aa019783-0b56-46a3-a6b0-6849c829ede1
	5/4/2018	10:08 PM
eff8e42c-880b-4bd3-8eab-8344768b9995
	4/9/2018	11:05 PM
60ce589c-349c-462e-8ede-769a286d88e1
	3/30/2018	1:49 PM
f8881dac-6f92-494b-bca9-1363d13683d1
	3/30/2018	1:49 PM
d1839a80-9d56-4c93-98cf-d85604676a51
	3/19/2018	12:23 AM
1bd82a75-6841-46ff-923b-228e3b6fb025
	3/7/2018	4:13 PM
419a2e2a-beba-46e4-98de-cd1f1c35fffd
	3/7/2018	4:13 PM
552a6589-9f32-4ace-b50d-56044aed370f
	3/7/2018	4:13 PM
91788312-c439-4ece-b38f-eabe00b764d0
	2/23/2018	12:51 PM
7bd14f6a-c8ad-4145-b75e-3c95703be38b
	2/23/2018	12:51 PM
ad740fbf-6862-4c96-ab30-b79a22bbb738
	2/23/2018	12:51 PM
55f886f7-7fbf-46e7-ac9b-09cd6bf731cf
	2/8/2018	7:15 PM
7003786c-d048-490e-858e-9c2cf28b8a29
	1/2/2018	11:13 PM

Submitted Crash Reports
Report ID 	Date Submitted
bp-9b55a918-3e31-4b34-9cc4-473660180704
	7/3/2018	5:30 PM  <-- manual submit time
bp-cbae6723-6013-49d2-90af-397620180703
	7/3/2018	3:18 PM
bp-d1171c95-7bed-4dbd-b170-8d0620180703
	7/3/2018	2:51 PM
bp-35616a29-b749-41c4-9086-929140180703
	7/3/2018	2:03 PM
bp-36c935c8-4929-4296-9e9a-28f680180701
	6/30/2018	6:50 PM
bp-b71c5c1e-6064-4e22-a3d2-43b080180701
	6/30/2018	6:49 PM
bp-484a4063-579b-4017-8527-40d5f0180701
	6/30/2018	6:25 PM
bp-4c1dd5e3-c316-4dd9-8a09-5ec710180630
	6/30/2018	12:27 PM
bp-3c1fa0a5-3bef-4e8b-83d8-8c5f91180616
	6/15/2018	8:49 PM
bp-d4eac249-31a6-4ada-9dfc-74f8b1180612
	6/11/2018	5:50 PM
bp-214358dd-a11e-4f75-8c75-481eb1180612
	6/11/2018	5:13 PM
bp-23ab72d7-fc0b-46f5-82b9-8f19e1180611
	6/11/2018	3:18 PM
bp-f8ff978f-9512-4a99-9c38-d5f880180611
	6/11/2018	1:36 PM
bp-789c3854-afa5-4a05-bb09-8948a0180610
	6/9/2018	6:19 PM
bp-9d8bf33a-78e0-48d1-82ba-fb77e1180604
	6/3/2018	5:09 PM
bp-848b9817-69fc-490d-86c4-e2cf11180602
	6/1/2018	8:04 PM
bp-90b62012-439b-4d1d-8240-c00381180529
	5/28/2018	11:17 PM
bp-507ce200-1489-426f-9654-f1db20180527
	5/27/2018	1:29 PM
bp-5612ecb4-f165-405d-9e2c-1c0d90180520
	5/20/2018	3:41 PM
bp-362c77a0-033a-44bf-a2cf-0eb4f0180514
	5/13/2018	7:56 PM
bp-33135ebd-be83-4718-9cf2-025310180507
	5/6/2018	10:18 PM
bp-edf8ee87-588c-4cc8-badb-445d60180505
	5/4/2018	10:13 PM
bp-978d8d6d-cd78-46e6-9b3b-5e5880180505
	5/4/2018	10:10 PM
bp-7285fc40-d853-4b91-8358-69a130180407
	4/7/2018	11:52 AM
bp-8a19dbf1-7451-48ca-9f17-9927f0180330
	3/30/2018	3:07 PM
bp-9c6314f4-2e7b-48b2-817b-cc34b0180329
	3/29/2018	1:04 PM
bp-d402ebdd-b0fd-4819-89ec-fe8500180308
	3/7/2018	9:20 PM
bp-093d1f0b-68aa-430b-8610-5580e0180308
	3/7/2018	9:19 PM
bp-baaebb10-cb78-4a23-b6f3-acfc21180301
	3/1/2018	12:56 AM
bp-ade2f8a8-8db6-42ab-8509-57b6a0180223
	2/23/2018	2:07 PM
bp-14acb657-b803-4cc3-8207-7d6270180223
	2/23/2018	12:57 PM
bp-87c3402b-4efe-4d1f-b672-8ac720170418
	4/18/2017	4:19 PM
bp-238cb394-ae67-480f-ab07-348c82170415
	4/14/2017	9:30 PM
bp-2eb3aaf9-6fee-4258-b626-1ce7c2161027
	10/27/2016	2:07 PM
bp-10e0268f-275a-4b52-a424-27cc52161027



Expected results:

If Firefox is hitting some resource limit due to intensive use or complex pages, it should provide warnings.","Hi, I tried to reproduce this issue in version 61.0.1 (64-bit), but also in Nightly version 63.0a1 (2018-07-08) without any success, there are a few things that might help you and us at the same time :

Please test if the issue is reproducible in safe mode, here is a link that can help you:
https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode

also if you could download the latest version of Firefox Nightly from here https://nightly.mozilla.org/ and retest the problem it might help us as well.

If you still have the issue please create a new profile, you have the steps here:https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles?redirectlocale=en-US&redirectslug=Managing-profiles#w_starting-the-profile-manager

and try it again.","I have some news to report...  Which may explain this problem. I hope!

Firefox couldn't handle 
http://www.russianriverisrp.org/
(Where mousing over links changes the font size, reformats the whole page...  )
Drew it at first opening, and redrew it many times after mouse movement, but later even refresh page only drew blank white. 
Download of the linked 600 page pdf failed repeatedly - not sure if that is relevant, but it is why I kept going back to the page. 

Opening Chrome while Firefox was (blank white) failing to show the Russian River site blacked the entire screen, taskbar and all. 
No response to mouse or keyboard or touch, though apparently Ctrl+Alt+Del was invisibly received. 
Tapping the proper spot on the screen with the Surface Pen showed (only) an error message from Task Manager: ""couldn't draw sign-on page""...  Which I believe went away by itself. 

<https://www.drivereasy.com/knowledge/dxgmms2-sys-blue-screen-error-on-windows-10-solved/>
Shows the eventual error screen that appeared in its place: 
""display driver failed - dxgmms2.sys""


That cleared itself, and the screen went back to black for awhile, then returned with ""basic driver"" and chaotic screen scaling, and let me close apps, all except TextPad, which just wouldn't close (though it saved the open file!)

While trying to close TextPad, bsod appeared...  


I used DevMgr to update the NVIDIA driver to 10/19/2017 23.21.13.8808. (Sorry, I neglected to check which version was there before.) It said the Windows part of the graphics driver was up-to-date. The problem has always been triggered by having lots of complex tabs open simultaneously, and always involved pages that changed with mouse movement, so a graphics driver issue makes sense. 

So maybe this won't happen again...  It is far too early to tell, so I'm not going to say the problem is solved. Will definitely comment here if it still happens.","Thanks for reporting, I already reported 2 other issues recently. This problem also happens randomly to me on Linux (Xubuntu) since May if I remember correctly (https://twitter.com/baptx/status/1001472286493429760).
It is really annoying, sometimes I cannot use a new tab for a few minutes because of this problem. The workaround is to restart the browser, clear all browsing data or not use a new tab at all and use another already opened tab instead...
I hope you will fix this problem soon.","Since updating my NVIDIA driver, I have not seen a ""crash"". But I have seen the black screen with only a few rectangular bits of the page drawn several times. My new strategy is whenever I see that, I go close some (successfully loaded) background tabs. The blocky page then loads properly and Firefox works normally again on new tabs. I suspect if I kept pushing on the overloaded situation it would still crash...  

But what is overloaded? Not main memory, I've checked. CPU loading often goes way up, but not totally maxed out. 

I just grabbed GPU-Z from here: https://www.techpowerup.com/download/techpowerup-gpu-z/

Not totally sure what I'm looking at, but it appears my Surface Book is not using the NVIDIA GeForce GM108, it has reverted to the Intel HD520 that it is only supposed to use when detached as a tablet. That might explain why the CPU loading goes way up during the tab storms, and where the resource limits are...  More to learn...  

Should Firefox be essentially paralyzed if the GPU gets overloaded?","(In reply to LorenAmelang from comment #2)
> I have some news to report...  Which may explain this problem. I hope!
> 
> Firefox couldn't handle 
> http://www.russianriverisrp.org/
> (Where mousing over links changes the font size, reformats the whole page...
> )
> Drew it at first opening, and redrew it many times after mouse movement, but
> later even refresh page only drew blank white. 
> Download of the linked 600 page pdf failed repeatedly - not sure if that is
> relevant, but it is why I kept going back to the page. 
> 
> Opening Chrome while Firefox was (blank white) failing to show the Russian
> River site blacked the entire screen, taskbar and all. 
> No response to mouse or keyboard or touch, though apparently Ctrl+Alt+Del
> was invisibly received. 
> Tapping the proper spot on the screen with the Surface Pen showed (only) an
> error message from Task Manager: ""couldn't draw sign-on page""...  Which I
> believe went away by itself. 
> 
> <https://www.drivereasy.com/knowledge/dxgmms2-sys-blue-screen-error-on-
> windows-10-solved/>
> Shows the eventual error screen that appeared in its place: 
> ""display driver failed - dxgmms2.sys""
> 
> 
> That cleared itself, and the screen went back to black for awhile, then
> returned with ""basic driver"" and chaotic screen scaling, and let me close
> apps, all except TextPad, which just wouldn't close (though it saved the
> open file!)
> 
> While trying to close TextPad, bsod appeared...  
> 
> 
> I used DevMgr to update the NVIDIA driver to 10/19/2017 23.21.13.8808.
> (Sorry, I neglected to check which version was there before.) It said the
> Windows part of the graphics driver was up-to-date. The problem has always
> been triggered by having lots of complex tabs open simultaneously, and
> always involved pages that changed with mouse movement, so a graphics driver
> issue makes sense. 
> 
> So maybe this won't happen again...  It is far too early to tell, so I'm not
> going to say the problem is solved. Will definitely comment here if it still
> happens.

Hi, it seems this issue is caused by the system itself, it does not seem like an actual Firefox issue, since Opening Chrome while Firefox was in a blank state caused issues with that as well, and an outdated graphics driver or a wrong driver entirely could definitely cause the type of issue.

Also if it reverts back from Nvidia to the Intel HD520 might cause a Chain reaction to other parts of the system causing the above mentioned issue with browsers, apps or games.

I will mark this issue as INVALID since I wasn't able to reproduce it in any way and the reporter mentioned it no longer crashes after updating the Nvidia drivers.

Please Reopen this issue if it will reoccur, and maybe add a few more steps and info, like system used, web pages loaded or other steps that might help us get to the bottom of this issue.","Created attachment 8998941
""GPU-Z tilted Google Earth.gif"" shows the GPU load from Google Earth when a complex sat view is tilted and spun around - GPU hasn't budged from the minimum 202/135 Hz.","Created attachment 8998943
""GPU-Z Chrome Pocket, video, fullscreen.gif"" shows Chrome playing a video - more load, but not extreme.","Created attachment 8998944
""GPU-Z Pocket, video, fullscreen.gif"" shows Firefox - clocks pegged at maximum, temperature rising, significant load.","@Rares,

I was just going to add an update here, when I saw your comment. I think you're right, the Surface Book and its complex graphics situation is the root cause. But Firefox is definitely the trigger...  The latest NVIDIA driver has not solved anything. Probably because the system is set to use the Intel graphics chip for Firefox. There is an NVIDIA Control Panel which lets you choose which GPU is ""preferred"" per app - nvcplui.exe. Unfortunately, using the NVIDIA driver for Firefox (or Chrome) causes a huge delay between a scroll command (via touch, mouse, or scrollbar) and the content moving - you slide your finger up the whole screen height, nothing happens, and about the time you reach the top the content jerks up so fast you lose your place in what you're reading. I haven't seen any tab crash storms using the NVIDIA driver, but I can't tolerate actually using the scrolling it provides so I keep turning it off. 

I do notice no other program (that I use...) loads the graphics system like Firefox. ""GPU-Z tilted Google Earth.gif"" shows the GPU load from Google Earth when a complex sat view is tilted and spun around - GPU hasn't budged from the minimum 202/135 Hz. ""GPU-Z Chrome Pocket, video, fullscreen.gif"" shows Chrome playing a video - more load, but not extreme. ""GPU-Z Pocket, video, fullscreen.gif"" shows Firefox - clocks pegged at maximum, temperature rising, significant load. And that is usually sent to the Intel chip, not the supposedly more capable NVIDIA system. 

Intel is on driver version win64_24.20.100.6194. Windows insists that 22.20.16.4811 is ""current"", and tries really hard to replace my updated version. None of the usual policy changes or registry hacks would stop it. I was finally able to hide the ""update"" using WinUpdateShowHide.diagcab. But yesterday I saw another tab crash storm using the newest Intel driver. 

This one began like many others, with https://www.sciencebase.gov/catalog/item/543e6b86e4b0fd76af69cf4c and https://viewer.nationalmap.gov/basic/ being used heavily. The screen got black/blocky, and I opened GPU-Z. It showed _both_ GPU systems pegged! And after a minute or two, the entire screen went black. When it came back it was at full brightness and could not be adjusted. Close the complex Firefox tabs, and the rest of my programs seemed fine. But the Intel driver was gone! I had to re-install it before I could get the brightness back down from blinding! 

So obviously Windows is a big part of my problem. But the trigger is always Firefox. Should it be the heaviest GPU load on my system? I'm absolutely not a gamer, so I'm not used to struggling with this...",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1492456,The browser crashes if the payment widget is opened while there is already an ongoing payment process,INVALID,"Created attachment 9010233
Video of the issue

[Affected versions]: 
Nightly 64.0a1

[Affected platforms]:
Platforms: Windows 7/10 x 64, Mac OS 10.13, Ubuntu 16.04.

[Preconditions]:
1. Set the pref dom.payments.request.enabled to ""true"";
2. Make sure you have at least one Shipping Address and one Credit Card saved in your browser.
3. Open 2 separate windows 

[Steps to reproduce]:
1. Go to ""https://rsolomakhin.github.io/pr/us/"" page on both windows
2. On window 1 click on Buy (fill in all the field) and after on Pay
3. Click on ""Buy"" on window 2 immediately 
4. Check the state of window 1 after the payment was processed
5. Click on Cancel or X on window 2

[Expected result]:
The payment widget should be closed on window 2 while window 1 should be responsive.

[Actual result]:
After the payment is processed,  window will no longer be responsive.
When the payment widget is closed on window 2 the browser crashes. 

[Note]:
Timing is essential in reproducing the issue, please see the attached video.","Now I am working on bug 1478740, and once fixing that bug, I think there is only one payment dialog at the same time.
That means this bug will not be reproduced anymore.
I will set this bug as invalid after bug 1478740 land.","Set this bug as invalid. Since bug 1478740 has landed, the second payment dialog should not popup.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1497399,Bug that is making application crash,INVALID,"User Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0

Steps to reproduce:

In my application, there is a button which generates a report. I clicked on that


Actual results:

the application got crashed.


Expected results:

the reports should have been generated","
Would you have a test case to reproduce it?
Do you have a crash report in about:crashes? if so, could you please share it?","Closing for now as we don't have enough information to act on it, please reopen with more information.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1497478,Dragging/moving/rearranging tabs crashes the browser,INVALID,"Created attachment 9015479
troubleshooting info.txt

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0

Steps to reproduce:

I open multiple tabs and drag one of them. Upon lifting the mouse button the browser crashes. Happens in safe mode and with a refreshed profile too.


Actual results:

The browser closes, and on next start it offers window restoration as if it had crashed, although no crash report is created - I'm not sure if it's technically a crash or not.


Expected results:

Tab is moved elsewhere (or stays where it was if it wasn't moved enough).",Discovered it was my workstation's setup affecting the browser: dev software which had an issue with drag&drop actions.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1498324,firefox crash,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36

Steps to reproduce:

1. I tried to open multiple web pages on firefox browser. 


Actual results:

My browser crashed.


Expected results:

Browser should not have crashed",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1502264,"running firefox esr on Debian Jessie, crashes.",INVALID,"User Agent: Mozilla/5.0 (X11; CrOS armv7l 11151.11.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.21 Safari/537.36

Steps to reproduce:

Opened any website that wasnt a Mozilla site


Actual results:

Tab or entire browser crashed upon loading
https://crash-stats.mozilla.com/report/index/bp-6f178d53-12fc-4efb-99ce-6a4570181026


Expected results:

Sites should have ran","It seems that you are using a build compiled by debian because the Mozilla server doesn't have the debug symbols for your crash report.
Can you please download a Mozilla.org build, extract it to example into /tmp/ and run the Mozilla.org build from there ?
Be also sure that you have closed the Debian Firefox first.

The crash report from that build should be hopefully much more usable.

A starting point for the download is here: http://ftp.mozilla.org/pub/firefox/releases/60.3.0esr/","You crash report is from ESR52.8 but ESR52 is EOL at least from Mozilla.org and that is the reason why i pointed you to 60.3.
You have to ask the Debian support for further assistance if this is a crash in their 52.8.1 version.","(In reply to Matthias Versen [:Matti] from comment #2)
> You crash report is from ESR52.8 but ESR52 is EOL at least from Mozilla.org
> and that is the reason why i pointed you to 60.3.
> You have to ask the Debian support for further assistance if this is a crash
> in their 52.8.1 version.

i cant even get into my email to copy the link so i think my linux escapades are over",marking invalid (bug report from an EOL version),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1504441,page Crashes - product pages particular site (SIGSEGV 0x7f3800000000),INVALID,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0

Steps to reproduce:

Basically you just have to go to nearly ANY product page.  e.g. https://www.grainger.com/product/E-Z-LOK-3-8-2-Fin-Brass-Finsert-with-4ZU50

Logged in or not.  Just wait or manipulate the scoll bars.  Crash.  You have to use the page quickly and get out of it.

Crash report: https://crash-stats.mozilla.com/report/index/7000b45f-8940-412d-91ff-3a0730181103



Actual results:

Crash - multiple times after sitting and/or moving the scroll bar.  Takes a couple of minutes.


Expected results:

No crash.","Hi, I tried reproducing this issue in Firefox 63.0, Firefox Beta 64.0b7 as well as Nightly 65.0a1 (2018-11-07) but without any success, can you try our latest versions of Firefox and check if the issue still occurs ? 
You can find the release version here: https://www.mozilla.org/en-US/firefox/63.0.1/releasenotes/
Also the latest Nightly version you can find here: https://nightly.mozilla.org/.","
Thanks for looking into this.

Right now, I can use both at the same time, just not very well.  firefox within the downloaded directory will launch 63.x if 52.x isn't launched.  The ICON will launch 52 always.

I did find some stuff on the net required to install the latest version or two versions, but it seems messy.  A lot more effort than I've been using.

Turns out that the big does not exist in 63.  63 fixes video playback in other places too, namely here: www.cbs.com.  Starting at about episode 4, Magnum PI was unwatchable under 52.  I can't reach CBS right now.  You do have to disable trackers to watch anything and I have ""media.libavcodec.allow-obsolete"" set.

It also fixed other video issues namely with sites that use some sort of DRM.

I did briefly have have issues where when both 52 and 63 were running at the same time the audio got really messed up.  I've seen it happen rarely before.  The headphone jack would only work when partially plugged in.  So, who knows?
And 52 ran was able to run videos it wasn't able to run before.  Not sure how I managed both versions to be able to run at the same time.

FF 63 is a lot faster.

I'm using Ubuntu 12.04 LTS and use

sudo apt-get update
sudo apt-get -y install firefox

to Install firefox from a CD boot and  it always installs 52. Why?

63 really messed up Google mail with respect to magnification and the ability to move the right vertical scroll bar horizontal window expansion.  It cuts off text instead of wrapping it and I have to set firefox's magnification to see the entire line and then it's too small.  I cant expand the window to see the hidden text.  I need to verify again under 52.

Guess I need to file a bug for that?  It seems to work correctly when composing a message using ""Add comment"" on Bugzilla.

I'll mark as resolved after a response.  Thank you.","Hi, regarding the first issue:

Right now, I can use both at the same time, just not very well.  firefox within the downloaded directory will launch 63.x if 52.x isn't launched.  The ICON will launch 52 always.

This issue might occur if you have both Firefoxes installed, probably the Path from the Icon is set to Fx52 Directory.



Regarding the issue at hand, its a bit unclear if this issue is Fixed for you with Fx63 or not, I am still unable to reproduce it in the latest versions of Firefox Nightly 65.0a1 (2018-11-28) or Release version 63.0.3. 
Please let us know if you can still reproduce this issue in older versions of Firefox, if it does occur can you please also try Google Chrome and see if the crash occurs there as well it would help us as well.

Regarding the Gmail page, I tried reproducing the issue on Firefox and Chrome and they behave in the exact same way, Im not sure if its a bug but you can file a new issue and maybe add a screencast or a few screenshots showcasing the problem.","Based on the Lack of response from the Reporter and the fact the I couldnt Reproduce it in any of the later versions of Firefox, I will mark this issue as Resolved - Invalid but Please reopen this issue if It still occurs on your end on the latest versions of Firefox, also a few more steps might be helpful.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1516169,Firefox crash to Windows 10 BSOD (versions 60+),INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0

Steps to reproduce:

Resized firefox windows.
(And sometimes opening multiple tabs also makes the same error)

This bug is related to Firefox versions 60+, on every version of Windows 10.
Firefox 59- versions are not effected.


Actual results:

Windows crashed to BSOD
Warning: WHEA_UNCORRECTABLE_ERROR
Dump files only explain about Kernel-power errors, no further info is detected.


Expected results:

Nothing, just not to crash!","A BSOD is not a bug of the application that triggers the BSOD.
It's always a bug in the windows kernel or more likely in one of the device drivers on your system.

In this case Firefox triggered the bug in the driver/ windows kernel but it may happen with other applications.

You can try to disable the hardware acceleration in the Firefox options (options/general/Performance) or update your graphic card driver.

I will mark this report invalid because this is no bug in Firefox and we can't fix this on our side.","(In reply to Matthias Versen [:Matti] from comment #1)
> A BSOD is not a bug of the application that triggers the BSOD.
> It's always a bug in the windows kernel or more likely in one of the device
> drivers on your system.
> 
> In this case Firefox triggered the bug in the driver/ windows kernel but it
> may happen with other applications.
> 
> You can try to disable the hardware acceleration in the Firefox options
> (options/general/Performance) or update your graphic card driver.
> 
> I will mark this report invalid because this is no bug in Firefox and we
> can't fix this on our side.

My graphic card drivers (and all other drivers) are always up to date, and I've tested all the outcomes on firefox hardware acceleration. When I'm running the Firefox versions 60+, BSODs always happen. When I install (roll back to) Firefox version 59.0.3 (and earlier) BSODs never happen. How could you conclude it is not related to a Firefox Bug?","It doesn't matter if you get a BSOD only with one application or only with one version of an application, it's still not the fault of the application unless it's an application that installed system drivers. 
The application triggers only the bug in the driver/kernel/hardware.

>How could you conclude it is not related to a Firefox Bug?
Because it's that is the definition of a BSOD: It's a system crash and a usermode application can not crash the system.

- https://en.wikipedia.org/wiki/Blue_Screen_of_Death
- https://en.wikipedia.org/wiki/Protection_ring","I forgot: I would suggest you something other than disabling the hardware acceleration in Firefox if I would know a solution.
You may want to use a different browser if disabling HWA in Firefox doesn't help and you may have luck and the other browser doesn't trigger the bug.","and as reference, this is the Microsoft information for your BSOD:

https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/bug-check-0x124---whea-uncorrectable-error","I don't have any problems with others browsers. But, I like FF most, so I want to find a solution.
I've tested changing various PC components like; SSD and Graphics Card, nothing solved the problem I'm facing, and no further help I could get from various sources.

Maybe it's a BIOS fault or RAM.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1371800,[Photon] Inconsistent layout with menus for add-ons (AdBlock Plus) on the toolbar,INVALID,"Steps to Reproduce: 
1. Install the Adblock Plus add-on
2. Install the uBlock Origin add-on
3. Left-click the ""Adblock Plus"" in the toolbar / observe the menu shown
4. Left-click the ""uBlock Origin"" in the toolbar / observe the menu shown

Expected Result:
There is a consistent menu that shows an arrow that matches the Photon spec 

Actual Result:
A standard inconsistent window is shown on Adblock Plus that does not match the style with the other Firefox toolbar functions and other add-ons.

This behavior is reproducible in Windows and Ubuntu.","Hey Grover, can you provide some screenshots?","Created attachment 8879254
Screenshot from 2017-06-19 10-28-37.png

Here's the look of AdBlock Plus menu.","Created attachment 8879258
Screenshot from 2017-06-19 10-28-21.png

Here's the look of the uBlock plus menu.","Adblock plus still uses a menu, so the styling matches that of the toplevel menus (menubar) rather than panels (the things we have hanging off buttons). This is an adblock plus thing, but it will go away when ABP switches to webextensions. We don't need to track this.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1369039,Firefox layout is disturbed when “Report Site Issue” button is moved to the Tab Bar,INVALID,"[Affected versions]:
- latest Nightly 55.0a1 (2017-05-31)

[Affected platforms]:
- Mac OS X 10.12

[Steps to reproduce]:
1. Launch Firefox and open Customize. 
2. Enable Title Bar. 
3. Move the ""Report Site Issue"" button to the Tab Bar. 
4. Click on the ""Report Site Issue"" button. 

[Expected result]:
- No issues occur. 

[Actual result]:
- Firefox layout is disturbed by “Report Site Issue” button. Please see here: http://i.imgur.com/ImEsvlU.png

[Regression range]:
- nightly regression window to [2017-05-14, 2017-05-15] 

Last good revision: 73b3fc64525b6816842c737e104ef2ac5482d217 (2017-05-14) 
First bad revision: e66dedabe582ba7b394aee4f89ed70fe389b3c46 (2017-05-15) 

Pushlog: 
https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=73b3fc64525b6816842c737e104ef2ac5482d217&tochange=e66dedabe582ba7b394aee4f89ed70fe389b3c46

[Additional notes]:
- The issue is reproducible only on Mac.",This will be made obsolete by Bug 1373650.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1367469,downloadable font: Layout: tags aren't arranged alphabetically,INVALID,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0
Build ID: 20170508114559

Steps to reproduce:

Custom web font from Fontello

used this way

@font-face {
  font-family: 'websymbol';
  src: url('fonts/websymbol.eot?v1');
  src: url('fonts/websymbol.eot?v1#iefix') format('embedded-opentype'),
		url('fonts/websymbol.woff?v1') format('woff'),
		url('fonts/websymbol.ttf?v1') format('truetype'),
		url('fonts/websymbol.svg?v1#websymbol') format('svg');

  font-style: normal;
	font-weight: normal;
}

then classes like
.ico-help-circled:before { content: '\e804';}
.ico-info-circled:before { content: '\e805';}

that I've arranged alphabetically but do not resolve the issue.


Actual results:

Firefox complain

downloadable font: Layout: tags aren't arranged alphabetically. (font-family: ""websymbol"" style:normal weight:normal stretch:normal src index:1) source: http://...


Expected results:

A clearer information of what it wants.

Looking on the web for
""downloadable font: Layout: tags aren't arranged alphabetically.""
I found only 2 results that don't explain anything.

I don't even know where does it find properties such as stretch:normal that is not in any piece of code I'm running (searched in the entire project with CTR+SHIFT+F in Netbeans). (Maybe FF shows an inplicit default?)

What do I have to do to remove such warning? Do you have any links that explain that?",The message appears to be originating from https://dxr.mozilla.org/mozilla-central/source/gfx/ots/src/layout.cc,"The OpenType specification requires several lists of tags (scripts, language systems, features) to be ordered alphabetically in the GSUB and GPOS tables; see https://www.microsoft.com/typography/otspec/chapter2.htm. The OpenType Sanitizer issues a warning if the font resource you're using does not conform to this, but AFAICS this shouldn't prevent it working; it's a warning rather than a fatal error.

The solution is to fix the font (or to regenerate the font with a better tool, as the tool that created it is apparently generating a font that doesn't conform to the specification).","Thanks for the reply, both useful.
I can't do anything about that then. I'll try to report the problem to Fontello.","The great Puzrin of Fontello has fixed the problem that was actually what Jonathan exposed above.
Thanks again for pointing me on the right direction.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1366749,[Unix] Button layout on error pages,INVALID,"User Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0
Build ID: 20170517123028



Actual results:

I've seen the Photon rework. On the error pages like [1], the preferred buttons are on the left side.

[1] https://www.soeren-hentzschel.at/wp-content/uploads/2017/05/firefox-57-content-neu-3.png


Expected results:

With the improved usage of GTK in Firefox, it would be great if the preferred buttons could be placed on the right side, according to the GTK style guideline [2] (“When a dialog includes an affirmative and a cancel button, always ensure that the cancel button appears first, before the affirmative button. In left-to-right locales, this is on the left.”). Then it would be a more consistent experience throughout the system.

[2] https://developer.gnome.org/hig/stable/dialogs.html.en","Button ordering in in-content pages is not done by widget, moving to Fx::Theme.",The buttons currently use the correct order. This bug seems to have been filed purely based a mockup rather than what's actually implemented.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1317663,multi-column layout in RTL: first column smaller than the rest,INVALID,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0
Build ID: 20161019084923

Steps to reproduce:

I created a multi-column layout using `-moz-column-count: 3` in a RTL HTML document, with 11 items.

Because this is a RTL column, when I refer to the ""first column"", I mean the column that is the furthest to the right.

I have attached a demo.html and screenshots. I experience this bug on Firefox 49.0.2 on macOS, and on Firefox Developer Edition 51.0a2 (2016-11-14) (64-bit) on macOS. I've also attached a screenshot of the same page in Chrome, which behaves as expected.


Actual results:

The first column had three items, the second column had four items, and the third column had four items.


Expected results:

I expected the first column to have four items, the second column to have four items, and the third column to have three items.","Created attachment 8810800
demo.html a small reproducible test-case","Created attachment 8810801
This is a screenshot of the unexpected buggy behaviour of demo.html","Created attachment 8810802
This is a screenshot of the expected behaviour of the demo.html in Chrome",Note that this bug only seems to manifest itself at certain browser widths. Try resizing the browser if you don't see the buggy behaviour.,"I just noticed that the bullet item decorations are missing from the Chrome screenshot. Obviously, the bug report is not about that :)","I think this is a bug in Chrome actually.

https://drafts.csswg.org/css-break/#break-margins
""When an unforced break occurs between block-level boxes,
any margins adjoining the break truncate to the remaining
fragmentainer extent before the break, and are truncated
to zero after the break.""

What you see in Firefox is the ""truncated to zero after
the break"" bit.

You can file a bug on Chrome here:
https://bugs.chromium.org/p/chromium/issues

(Also, you can simplify the test by removing the dir=rtl
because the behavior is the same in LTR.)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1315569,line-height with em or rem could break layout,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0
Build ID: 20161019084923

Steps to reproduce:

1. set a div container with one font size and in that div container another div container with another font size
place in the first container a line height with em

<div with font-size:, line-height:>
<div with another font size></div></div>

2. set this element to an area that is not visible when you open that site.
3. scroll down to it
4. hover over a link (outside or inside these divs)


Actual results:

the layout seems to get refreshed and the text is rearranged


Expected results:

text should stay fixed",addon bug,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1311070,#NAME?,INVALID,"Created attachment 8802193
Improper positioning

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:49.0) Gecko/20100101 Firefox/49.0
Build ID: 20160922113459

Steps to reproduce:

Example here: http://codepen.io/Lexicality/pen/NROYPg

Having several position: fixed elements on the page and `-webkit-filter: contrast(105%);` on the bodoy


Actual results:

Fixed position elements are no longer fixed


Expected results:

Fixed position elements should remain where they should be","Created attachment 8802194
Correct positioning","Created attachment 8802196
Offending styles","Created attachment 8802197
Example Page","This was reported by a customer running Windows, then verified on Linux and OS X.","Created attachment 8802244
testcase 1 (with ""-webkit-filter"")","That's due to the support of -webfix properties through layout.css.prefixes.webkit=true. If you disable that pref in about:config, the normal rendering is back.

Daniel, your opinion?","Created attachment 8802277
testcase 2 (simplified, unprefixed)

Looks like this is simply a difference in how Chrome & Firefox treat the ""filter"" property (regardless of whether it's prefixed).

Here's a more targeted testcase that. In Firefox, the two lines of text are superimposed. In Chrome, ""FIXED-POS"" is at the top of the page.","Looks like what we're doing is correct, according to the spec (and Chrome is non-conforming on their ""filter"" implementation).

This was previously discussed in bug 1281068.  See bug 1281068 comment 14 in particular, for the working-group resolution that we're honoring.  I guess Chrome hasn't implemented that behavior yet. (And the resolution may not have made it into the spec yet, since https://github.com/w3c/fxtf-drafts/issues/11 is still open. I've just pinged the spec editors on that bug.)

--> Resolving as INVALID, since Firefox is correct here.

(Ideally, the site should be updated to accommodate the possibility that the filtered element may be an abs-pos/fixed-pos containing block.  The easiest way to fix this is to move this ""body"" style to apply to ""html"" instead -- because that's actually the element that you want to be the fixed-pos containing block. i.e. you want to drop the .body filter rule, and instead use:
  .html {
    -webkit-filter: contrast(105%);
    filter: contrast(105%);
  }

Lex, any chance you're a developer involved with this site & have the ability to make that change? Thanks for reporting this, BTW!","(In reply to Daniel Holbert [:dholbert] from comment #8)
> Lex, any chance you're a developer involved with this site & have the
> ability to make that change? Thanks for reporting this, BTW!

(by ""this site"" I mean ""the site in question, for which customers were reporting problems, per comment 4"")","(In reply to Daniel Holbert [:dholbert] from comment #8)

Thanks, that fixes it.
I do consider this very surprising behaviour though, especially since it appears only to be documented in a bug that I somehow wasn't able to find with several searches.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1291673,layout-geometry-editor position,INVALID,"Created attachment 8777303
layout-geometry-editor-position.png

User Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0
Build ID: 20160802030437

Steps to reproduce:

1. Start Nightly
2. Go to about:home
3. Open DevTools > Inspector > Computed
4. Select #searchSuggestionTable node
    --> layout-geometry-editor icon appears in Box model


Actual results:

Currently, layout-geometry-editor position is next to ""Box Model"". But, it was next to layout-element-position in previous design. (49.0b1)


Expected results:

Is current position correct? If it is not, move its position.","Regression range:
https://hg.mozilla.org/integration/fx-team/pushloghtml?fromchange=e2ddf53209916302a81ca331f88b4df8df0ca7c7&tochange=48d51227912b8ec3600758d59a995521e2fbea1c","I made a similar comment in Bug 1247729 comment#32, but this is actually the new correct position (see https://bugzilla.mozilla.org/show_bug.cgi?id=1247729#c36)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1288070,sidebar-tab-layoutview is gone in about:home,INVALID,"Created attachment 8772819
sidebar-tab-layoutview is gone.png

User Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0
Build ID: 20160720030208

Steps to reproduce:

1. Start latest Nightly (e.g. Build ID: 20160720030208)
2. Open DevTools > Inspector
3. Check ""Box Model"" tab


Actual results:

sidebar-tab-layoutview is gone


Expected results:

Is this bug intentional? If this is not, sidebar-tab-layoutview should be displayed.","Regression range:
https://hg.mozilla.org/integration/fx-team/pushloghtml?fromchange=a35a15008f0c37488cfc5f907f6d553aab028eb8&tochange=48d51227912b8ec3600758d59a995521e2fbea1c",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1277315,website layout problem,INVALID,"Created attachment 8758809
lfs-site_layout.jpg

User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:46.0) Gecko/20100101 Firefox/46.0
Build ID: 20160511224433

Steps to reproduce:

Open http://www.linuxfromscratch.org/ website. I have set the override option in Firefox content settings. My font size is 24 and I have enabled ""Allow pages to choose their own fonts, instead of my selections above""


Actual results:

The menu and text part are overlapping.


Expected results:

They should not overlap.
If I reduce the font size in my settings the layout is proper.
Is this a problem with website or the Firefox settings?","Does it render normally in a fresh profile with default settings?
https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles","Reproduced on Chrome w/ min font24px.

So, this is the site problem(poor coding)",Thank you! I have informed the team about this issue. Hopefully it will be resolved.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1263181,Long layout/rendering times on site when compared to other browsers,INVALID,"User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36

Steps to reproduce:

Steps to reproduce: 
1. Visit https://console.developers.google.com/ and go to the Logs viewer. 
2. Try to interact with the page, i.e. clicking on log rows, type in the filter bar, etc.


Actual results:

Interaction with the page is very sluggish, upwards of seconds of delay when clicking on elements in the page, typing text into the filter bar has 10's - 100's MS delay between keystrokes. After a quick profile in the developer tools I notice a large portion of the time, several seconds, is spent in layout.


Expected results:

Interaction with the page should not be sluggish. I tested a few other browsers and the page did not exhibit the same behavior.","When I created this bug it used my personal account... I wanted to mention that I am one of the engineers at Google that works on the logs viewer. I've spent a good bit of time trying to track down the root cause of the issue but haven't been able to gain any significant traction.

Also, when I created the bug it injected my user agent. Here is the user agent of the browser that I am actually experiencing the issues on: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0

Note that I've also tried in a few other versions of Firefox and am experiencing the same issue. To date I've tried Firefox 43, 44, 45, and the developers edition, 47.0a2.",Creating a new bug with proper contact info,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1567481,Accessibility: Firefox doesn't track cursor movement for certain page layouts properly with Assistive Technology,INVALID,"User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

Tested on both Windows 7 and 10 X64 with the latest downloadable release of the NVDA screen reader and Firefox 68.

Whilst using the NVDA screen reader to navigate through several sites powered by WordPress, I've noticed that when sites use a certain WordPress theme Firefox doesn't appear to track keyboard focus properly. When using NVDA in Browse Mode (the default for navigating through web-based content) and using either the Applications key or shift + F10 to invoke the context menu on any link running this particular theme, Firefox won't open the standard right-click menu that allows for links to be copied to the clipboard and various other actions; instead, a different right-click menu will be opened. However, when moving the mouse pointer to the same link in question and then performing a right-click, the correct menu is opened. This makes me think that Firefox isn't properly tracking focus of the keyboard on these sites for some reason - I'm more than happy to relog this with the NVDA project if it is felt that NVDA is in fact the issue here. To reproduce what I've just mentioned:

1. Navigate to the following example URL: http://www.AndreLouis.com/

2. With NVDA enabled, cursor down until you reach the second item in the first list - entitled ""FF Shorts Project""

3. Press either the Applications key, or hold down shift and hit F10


Actual results:

A menu does appear - however, this only contains options including ""Take a Screenshot"" and ""Select All"" which don't usually appear when performing a right-click on a link.


Expected results:

When the right-click menu was invoked, Firefox should pop up the standard right-click menu that allows for copying of the selected hyperlink to the clipboard. When manually using the mouse pointer to move to the link in question and then right-click, the expected menu appears.","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
NVDA: 2019.1.1

Could you please be more specific about step 2? By cursor down, do you mean hover your mouse over the link and then press the Application key? The menu that I see when I hover the mouse over the link and I hit the Application key, is indeed different by the menu that I see when I right click the link. But, I see the same behavior on other browsers too. Not sure what the expected behavior should be in this case.","(In reply to Simona Badau from comment #1)
> Could you please be more specific about step 2? By cursor down, do you mean hover your mouse over the link and then press the Application key? The menu that I see when I hover the mouse over the link and I hit the Application key, is indeed different by the menu that I see when I right click the link. But, I see the same behavior on other browsers too. Not sure what the expected behavior should be in this case.

No, by cursor down, elliottabarnes literally means cursor down, meaning the arrow keys. With NVDA active, the blind user is in what we call virtual or browse mode, where the web page is being rendered in a more screen-reader friendly manner inside a single-column, invisible (to the sighted user) document with headings, links, and many other elements annotated for speech and braille. The arrow keys are then trapped by the screen reader for reading purposes. So cursoring down actually walks through the page virtual line for virtual line, which in some cases means one link per line. So cursoring down here really means cursoring until you hear link text.

In normal circumstances, NVDA will try to set visible keyboard focus (browser focus) to the element it reads, if that is focusable. So since links are normally focusable on Windows, NVDA tries to set focus to the FF short ..."" link on the page, but fails. For some reason, keyboard focus cannot be set on anything other than the main document. Even when the screen reader is off, and you press the tab key, focus doesn't move once it is on the document. Normal behavior would be to be able to tab through the links and form controls on the page. But something on this website prevents Firefox, and other browsers as well, to set focus to anything other than the document. I've reproduced the same problem in Chrome.

Mousing over something and clicking still works, but keyboard focus is totally broken on this website. And as a rule of thumb: Blind users don't use the mouse unless they absolutely have to, since it is a very insecure mechanism for us to navigate by.

I suspect this is neither a screen reader nor a Firefox bug, but one that is a bug in the WordPress theme or some third-party element that has been included. I see SoundCloud and Twitter embeds on the site. I do not see (or feel) a popup that might be blocking keyboard focus, but still something traps all keyboard input and keyboard focus handling of browsers. Never seen something like this before.","Confirming bug, although as I said, I am not even sure this is our problem or that of NVDA.","Authoring error. The website uses this script:
http://www.andrelouis.com/wp-content/themes/piano-black/js/jscript.js

The first two lines of that script:

```
jQuery(function(){
  jQuery(""a"").bind(""focus"",function(){if(this.blur)this.blur();});
```

That basically translates to ""as soon as a link gets focused, unfocus it"". So the theme is intentionally preventing focus on links.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1635748,"[Hero Layout] Small cards have different heights as expected, at 696px/936px width containers, when sponsored label is displayed on 1 and 2 lines",INVALID,"Created attachment 9146143
cards heights.png

**[Affected versions]:**
- Firefox Beta 77.0a1 Build ID 20200505174119;

**[Affected Platforms]:**
- Windows 10;
- Mac OS 10.14;
- Ubuntu 18.04 x64;

**[Prerequisites]:**
- Have a Firefox Beta 77 build installed;
- Have a new profile created;
- Have the following prefs set in about:config
-- Browser.search.region to “US”
-- Browser.newtabpage.activity-stream.discoverystream.spocs-endpoint to https://spocs.getpocket.com/spocs?country=US&region=US-CA 
-- Browser.newtabpage.activity-stream.discoverystream.config to {""api_key_pref"":""extensions.pocket.oAuthConsumerKey"",""collapsible"":true,""enabled"":true,""show_spocs"":true,""hardcoded_layout"":false,""personalized"":true,""layout_endpoint"":""https://getpocket.cdn.mozilla.net/v3/newtab/layout?version=1&consumer_key=$apiKey&layout_variant=hero-layout"",""unused_key"":""unused_2""}

**[Steps to reproduce]:**
1. Open the browser with the profile from prerequisites.
2. Open about:newtab page.
3. Tap “F12” key to open the browser Inspector.
4.     
 a. Have the **696px-width container** visible and: 
-- observe small cards height when the sponsored label is on 1 row (title on 2 rows)
-- observe small cards height when the sponsored label is on 2 rows (title on 2 rows)
 b. Have the **936px-width container** visible and :
-- observe small cards height when the sponsored label is on 1 row (title on 2 rows)
-- observe small cards height when the sponsored label is on 2 rows (title on 2 rows)

**[Expected result]:**
Based on the [specs] (https://www.figma.com/file/3c4TF1eRf8y2DhwySP4lkA/Firefox-77-Spec?node-id=0%3A1 ) 
- 696px-width container
-> sponsored label is on 1 row (title on 2 rows) => card height is 194px
-> sponsored label is on 2 rows (title on 2 rows) =>card height is 212px
- 936px-width container
-> sponsored label is on 1 row (title on 2 rows) => card height is 222px
-> sponsored label is on 2 rows (title on 2 rows) =>card height is 240px

**[Actual result]:**
- 696px-width container
-> sponsored label is on 1 row (title on 2 rows) => card height is 185px
-> sponsored label is on 2 rows (title on 2 rows) => card height is 204px
- 936px-width container
-> sponsored label is on 1 row (title on 2 rows) => card height is 222px
-> sponsored label is on 2 rows (title on 2 rows) => card height is 234px

**[Notes]:**
This issue generates different values, than those from specs, for Hero card height for both cases: 
- we expect a increase of the Hero card height of **15px** for 936px-width container and the real value is 12px;
- we expect a increase of the Hero card height of **18px** for 639px-width container and the real value is 19px;","Thanks for catching this Valentina!

I think this is an instance where the design tool is not 100% the same as the way things are being rendered. The actual height of the cards and component are not as important as if the cards in each row align perfectly. As long as everything aligns, some variation in pixel height is OK here.",Let's close this ticket as the discrepancy is not important,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1497084,Content Blocking Doorhanger Doesn't disappear,INVALID,"Created attachment 9015146
contentblockingdoorhanger.mp4

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0

Steps to reproduce:

1. Open Firefox Nightly 64.0a1 (2018-10-07) (win64-bit) with a new profile.
2. Visit any website like (https://9gag.com).
3. Content Blocking door-hanger will be appeared. (click on next > next)
4. From the Content Blocking tour page. Click on URL info icon.
5. Click on setting icon from content blocking or permission section on door-hanger.


Actual results:

Door-hanger doesn't disappear. (Also it doesn't appear on the third step)


Expected results:

It should be disappeared normally.","The ""doesn't appear"" part is due to FastBlock (which we disabled just now), but thanks for filing this. It is expected that the site identity popup does not disappear when clicking the (i) icon, I think.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1627185,ContentBlockingController addException stopped working for private sessions,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0

Steps to reproduce:

This works flawlessly for regular sessions but it doesn't work for private sessions.
STRs:
- Open a private session
- Add a ContentBlockingController exception for that session.
- Get the stored exceptions via saveExceptionList or check a session via checkException


Actual results:

The exception hasn't been added


Expected results:

The exception should have been added",Seen in 76.0.20200330094747 but also in 76.0.20200402095145,This is a ship blocker for FxR.,"Based on discussion, `saveExceptionList()` will not contain the private browsing session exceptions, however `checkException` should still work with a PB session.","Created attachment 9138945
Bug 1627185 - [1.0] Add a private mode content blocking exception test.",The issue was found to be that FxR was recreating the session when the exception list changed for private browsing sessions. Unfortunately the PB exception list is cleared when the last PB session gets closed so recreating the session was clearing the list when only on PB tab was open.,Let's add the test in this bug anyways. The test is covering the general private mode exception use case.,Move `GeckoView::Tracking Protection` bugs to the `GeckoView::General` component.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1436700,webRequest.onBeforeRequest blocking doesn't affect redirects from other blocking request handlers,INVALID,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0
Build ID: 20180131010234

Steps to reproduce:

Loaded a WebExtension with the following code and navigated to any domain.

let redirected = false;
browser.webRequest.onBeforeRequest.addListener((request) => {
  if (!redirected) {
    console.log('redirect', request);
    redirected = true;
    return {redirectUrl: 'http://example.com'};
  }
},  {
  urls: ['<all_urls>'],
  types: ['main_frame']
}, [
  'blocking'
]);

browser.webRequest.onBeforeRequest.addListener((request) => {
  console.log('blocking', request);
  return {cancel: true};
},  {
  urls: ['<all_urls>'],
  types: ['main_frame']
}, [
  'blocking'
]);


Actual results:

The blocking request handler sees the redirect to example.com


Expected results:

Since the blocking request handler blocked the request, the redirect should not happen (and thus not be seen by the blocking handler).

The request that comes in from the redirect has the same requestId as the initial request, indicating that it indeed is the same request that the blocking handler already decided to block.

When the redirect handler has no ""blocking"" as ""extraInfoSpec"" this works as expected.","When multiple blocking handlers modify a request, only one set of modifications take effect. Redirects and cancellations have the same precedence.","Thanks for letting me know. Unfortunately I wasn't able to find that information on https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/webRequest/onBeforeRequest or other pages about webRequest. Did I just miss it? And if not, would it be maybe possible to add it?","Nevermind, one can just edit pages on MDN and I just did. Thanks again!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1390135,annoying ad blocking firefox,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0
Build ID: 20170628075643

Steps to reproduce:

Go to :
http://www.support.microsoft8089yfrmsrbs6232.com.s3-website.eu-central-1.amazonaws.com/01234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000100110021003100410051006100710081009101010111012101310141015101610171018101910201021102210231024102510261027102810291030103110321033103410351036103710381039104010411042104310441045104610471048104910501051105210531054105510561057105810591060106110621063106410651066106710681069107010711072107310741075107610771078107910801081108210831084108510861087108810891090109110921093109410951096109710981099110011011102110311041105110611071108110911101111111211131114111511161117111811191120112111221123112411251126112711281129113011311132113311341135113611371138113911401141114211431144114511461147114811491150115111521153115411551156115711581159116011611162116311641165116611671168116911701171117211731174117511761177117811791180118111821183118411851186118711881189119011911192119311941195119611971198119912001201120212031204120512061207120812091210121112121213121412151216121712181219122012211222122312241225122612271228122912301231123212331234123512361237123812391240124112421243124412451246124712481249125012511252125312541255125612571258125912601261126212631264126512661267126812691270127112721273127412751276127712781279128012811282128312841285128612871288128912901291129212931294129512961297129812991300130113021303130413051306130713081309131013111312131313141315131613171318131913201321132213231324132513261327132813291330133113321333133413351336133713381339134013411342134313441345134613471348134913501351135213531354135513561357135813591360136113621363136413651366136713681369137013711372137313741375137613771378137913801381138213831384138513861387138813891390139113921393139413951396139713981399140014011402140314041405140614071408140914101411141214131414141514161417141814191420142114221423142414251426142714281429143014311432143314341435143614371438143914401441144214431444144514461447144814491450145114521453145414551456145714581459146014611462146314641465146614671468146914701471147214731474147514761477147814791480148114821483148414851486148714881489149014911492149314941495149614971498149915001501150215031504150515061507150815091510151115121513151415151516151715181519152015211522152315241525152615271528152915301531153215331534153515361537153815391540154115421543154415451546154715481549155015511552155315541555155615571558155915601561156215631564156515661567156815691570157115721573157415751576157715781579158015811582158315841585158615871588158915901591159215931594159515961597159815991600160116021603160416051606160716081609161016111612161316141615161616171618161916201621162216231624162516261627162816291630163116321633163416351636163716381639164016411642164316441645164616471648164916501651165216531654165516561657165816591660166116621663166416651666166716681669167016711672167316741675167616771678167916801681168216831684168516861687168816891690169116921693169416951696169716981699170017011702170317041705170617071708170917101711171217131714171517161717171817191720172117221723172417251726172717281729173017311732173317341735173617371738173917401741174217431744174517461747174817491750175117521753175417551756175717581759176017611762176317641765176617671768176917701771177217731774177517761777177817791780178117821783178417851786178717881789179017911792179317941795179617971798179918001801180218031804180518061807180818091810181118121813181418151816181718181819182018211822182318241825182618271828182918301831183218331834183518361837183818391840184118421843184418451846184718481849185018511852185318541855185618571858185918601861186218631864186518661867186818691870187118721873187418751876187718781879188018811882188318841885188618871888188918901891189218931894189518961897189818991900190119021903190419051906190719081909191019111912191319141915191619171918191919201921192219231924192519261927192819291930193119321933193419351936193719381939194019411942194319441945194619471948194919501951195219531954195519561957195819591960196119621963196419651966196719681969197019711972197319741975197619771978197919801981198219831984198519861987198819891990199119921993199419951996199719981999200020012002200320042005200620072008200920102011201220132014201520162017201820192020202120222023202420252026202720282029203020312032203320342035203620372038203920402041204220432044204520462047204820492050205120522053205420552056205720582059206020612062206320642065206620672068206920702071207220732074207520762077207820792080208120822083208420852086208720882089209020912092209320942095209620972098209921002101210221032104210521062107210821092110211121122113211421152116211721182119212021212122212321242125212621272128212921302131213221332134213521362137213821392140214121422143214421452146214721482149215021512152215321542155215621572158215921602161216221632164216521662167216821692170217121722173217421752176217721782179218021812182218321842185218621872188218921902191219221932194219521962197219821992200220122022203220422052206220722082209221022112212221322142215221622172218221922202221222222232224222522262227222822292230223122322233223422352236223722382239224022412242224322442245224622472248224922502251225222532254225522562257225822592260226122622263226422652266226722682269227022712272227322742275227622772278227922802281228222832284228522862287228822892290229122922293229422952296229722982299230023012302230323042305230623072308230923102311231223132314231523162317231823192320232123222323232423252326232723282329233023312332233323342335233623372338233923402341234223432344234523462347234823492350235123522353235423552356235723582359236023612362236323642365236623672368236923702371237223732374237523762377237823792380238123822383238423852386238723882389239023912392239323942395239623972398239924002401240224032404240524062407240824092410241124122413241424152416241724182419242024212422242324242425242624272428242924302431243224332434243524362437243824392440244124422443244424452446244724482449245024512452245324542455245624572458245924602461246224632464246524662467246824692470247124722473247424752476247724782479248024812482248324842485248624872488248924902491249224932494249524962497249824992500250125022503250425052506250725082509251025112512251325142515251625172518251925202521252225232524252525262527252825292530253125322533253425352536253725382539254025412542254325442545254625472548254925502551255225532554255525562557255825592560256125622563256425652566256725682569257025712572257325742575257625772578257925802581258225832584258525862587258825892590259125922593259425952596259725982599260026012602260326042605260626072608260926102611261226132614261526162617261826192620262126222623262426252626262726282629263026312632263326342635263626372638263926402641264226432644264526462647264826492650265126522653265426552656265726582659266026612662266326642665266626672668266926702671267226732674267526762677267826792680268126822683268426852686268726882689269026912692269326942695269626972698269927002701270227032704270527062707270827092710271127122713271427152716271727182719272027212722272327242725272627272728272927302731273227332734273527362737273827392740274127422743274427452746274727482749275027512752275327542755275627572758275927602761276227632764276527662767276827692770277127722773277427752776277727782779278027812782278327842785278627872788278927902791279227932794279527962797279827992800


Actual results:

firefox freezes :
- infinite script
- invitation to enter username/pwd
- full screen mode
- annoying sound
- malware installation offer
- impossible to close the window


Expected results:

We should be able to close the window by using the ""X"" button",Unfortunately this Bugzilla cannot solve such an issue.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1376777,"Thunderbird has blocked some files from loading into this message. Unblocking a file will include it in your sent message.""",INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:54.0) Gecko/20100101 Firefox/54.0
Build ID: 20170608105825

Steps to reproduce:

Upgraded t bird, open my business address.  


Actual results:

I click on options, but I must do this everytime I try to write a message.  I have no OPTIONS.  I click then send the message.  I cannot find the mentioned file on my pc as it is an old file from my old pc, so it does not exist any longer.  when I open any current signature files, they say read only and cannot be changed.


Expected results:

NO error message and send the email","This looks like a support request.

Please note: Bugzilla is NOT a support forum. It is a tracking system for bugs in Mozilla products.
This is a support question. You can get support here:
https://support.mozilla.org/en-US/products/thunderbird

That said, looks like you're having trouble with the changed handling of file-based embedded images which is clearly stated in the release notes:
https://www.mozilla.org/en-US/thunderbird/52.0/releasenotes/

Signatures referencing files should still work, any templates referencing images from files need to be rebuilt.

I don't understand how you ""open"" signature files, and we don't have the resources to go through a questionnaire with you to gather the necessary information to help you.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1333609,"Neither media.block-play-until-visible or media.block-autoplay-until-in-foreground config keys are blocking videos from automatically playing in Firefox 51.0, 32-bit version",INVALID,"User Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0
Build ID: 20170118123726

Steps to reproduce:

I opened multiple youtube videos in new tabs (pressing ctrl + left clicking on link).


Actual results:

All the videos started playing even though their tabs were not selected/active.


Expected results:

The videos should not have played until their tabs had been selected/active. I've had ""media.block-play-until-visible"" set to true for a long time in about:config and after a little research, I read that this string was being shifted to ""media.block-autoplay-until-in-foreground"" in Firefox 51 but neither strings being set to true is preventing the youtube videos from autoplaying. In fact on one instance the audio kept playing for the video even after I had paused the video causing me to restart Firefox.","Simona,
Can you help check if you can repro this problem or not?","Weird I'm not getting this problem anymore. I played around with values in about:config and now I have both media.block-play-until-visible and media.block-autoplay-until-in-foreground set to true (this seems to have done the trick).
But a problem I still notice is if you open multiple YouTube video tabs (ctrl + link or right-click link and hit ""open in new tab"") and reload all tabs (I have Tab Mix Plus add-on meaning I just right-click on a tab and hit ""Reload All Tabs""), once you to go the video and press pause the audio continues to play...Now sure this could be the add-on at fault but I just want to note that this didn't happen in the previous version on Firefox.
Another problem I see is once a video starts playing in a tab (meaning once a tab has been set to ""active"") and you reload the tab and quickly switch tabs (before the video player even loads) or just go to another tab and reload the tab that had been set to ""active"" using an add-on (such as Tab Mix Plus), the video will start playing and not stop until finished or unless paused. Meaning the media.block-autoplay-until-in-foreground works until a tab has been to active after that even if you switch to another tab and reload, it will not work. Seems like a bug.
I truly hope you understand what I'm trying to say. It might take a few reads to understand what I mean. Sorry that I couldn't word it better.","(In reply to Blake Wu [:bwu][:blakewu] (OoO from 1/27 - 2/1) from comment #1)
> Simona,
> Can you help check if you can repro this problem or not?

I can see why this might be confusing. If ""media.block-play-until-visible"" was changed from the default state by being set to true on Firefox 50.0.2 and then Firefox is updated to Firefox 51, after the update both preferences (the old one - ""media.block-play-until-visible"" and the new one - ""media.block-autoplay-until-in-foreground"") are kept in about:config as:
""media.block-play-until-visible"" = true
""media.block-autoplay-until-in-foreground"" = false

The videos are not blocked since ""media.block-autoplay-until-in-foreground"" is set by default to false (expected behavior). 

If the preference ""media.block-play-until-visible"" is not changed from the default state (remains as false), after updating to Firefox 51 it becomes unavailable in about:config. In this case, only ""media.block-autoplay-until-in-foreground"" is present in about:config.

I'm not sure how the clean up of the old preference should have been done after the update and if the new preference  (""media.block-autoplay-until-in-foreground"") should have been borrowed the value of the old one (""media.block-play-until-visible"").","(In reply to Simona B [:simonab ] from comment #3)
> If the preference ""media.block-play-until-visible"" is not changed from the
> default state (remains as false), after updating to Firefox 51 it becomes
> unavailable in about:config. In this case, only
> ""media.block-autoplay-until-in-foreground"" is present in about:config.

I saw a new version of Firefox available (51.0.1) and set both preferences to default before updating Firefox. The ""media.block-play-until-visible"" preference was gone when Firefox restarted. I then set ""media.block-autoplay-until-in-foreground"" to true again. But the issues that I mentioned in the previous comment still exist:
> But a problem I still notice is if you open multiple YouTube video tabs
> (ctrl + link or right-click link and hit ""open in new tab"") and reload all
> tabs (I have Tab Mix Plus add-on meaning I just right-click on a tab and hit
> ""Reload All Tabs""), once you to go the video and press pause the audio
> continues to play...Now sure this could be the add-on at fault but I just
> want to note that this didn't happen in the previous version on Firefox.
> Another problem I see is once a video starts playing in a tab (meaning once
> a tab has been set to ""active"") and you reload the tab and quickly switch
> tabs (before the video player even loads) or just go to another tab and
> reload the tab that had been set to ""active"" using an add-on (such as Tab
> Mix Plus), the video will start playing and not stop until finished or
> unless paused. Meaning the media.block-autoplay-until-in-foreground works
> until a tab has been to active after that even if you switch to another tab
> and reload, it will not work. Seems like a bug.
But I did want to note that the audio that starts playing even when video is paused only lasts for a couple of seconds, so it's kind of like a lag of sorts.
I don't understand what you mean by:
> The videos are not blocked since ""media.block-autoplay-until-in-foreground""
> is set by default to false (expected behavior).
I tried setting the preference to false and the videos don't get blocked...","(In reply to u587807 from comment #4)
> I saw a new version of Firefox available (51.0.1) and set both preferences
> to default before updating Firefox. The ""media.block-play-until-visible""
> preference was gone when Firefox restarted. I then set
> ""media.block-autoplay-until-in-foreground"" to true again. But the issues
> that I mentioned in the previous comment still exist:
> > But a problem I still notice is if you open multiple YouTube video tabs
> > (ctrl + link or right-click link and hit ""open in new tab"") and reload all
> > tabs (I have Tab Mix Plus add-on meaning I just right-click on a tab and hit
> > ""Reload All Tabs""), once you to go the video and press pause the audio
> > continues to play...Now sure this could be the add-on at fault but I just
> > want to note that this didn't happen in the previous version on Firefox.

I can't reproduce this issue, tried with and without having the Tab Mix Plus add-on installed. Could you please try to reproduce the issue using Firefox in Safe mode? (this way we can eliminate the actions of add-ons and even resets some settings). If the issue is still reproducible in Safe mode, could you please write here the exact steps you are doing?(a screen cast will be even better). You can find here more details about how to start Firefox in safe mode:
https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode

> > Another problem I see is once a video starts playing in a tab (meaning once
> > a tab has been set to ""active"") and you reload the tab and quickly switch
> > tabs (before the video player even loads) or just go to another tab and
> > reload the tab that had been set to ""active"" using an add-on (such as Tab
> > Mix Plus), the video will start playing and not stop until finished or
> > unless paused. Meaning the media.block-autoplay-until-in-foreground works
> > until a tab has been to active after that even if you switch to another tab
> > and reload, it will not work. Seems like a bug.

Not a bug. Is the way the preference media.block-autoplay-until-in-foreground preference is working. Once a tab is in foreground, media on that tab will not be blocked anymore.

> But I did want to note that the audio that starts playing even when video is
> paused only lasts for a couple of seconds, so it's kind of like a lag of
> sorts.
> I don't understand what you mean by:
> > The videos are not blocked since ""media.block-autoplay-until-in-foreground""
> > is set by default to false (expected behavior).
> I tried setting the preference to false and the videos don't get blocked...

The videos are only blocked (if opened in a background tabs) if the preference is set to true.","(In reply to Simona B [:simonab ] from comment #5)
> Could you please try to reproduce the issue using Firefox
> in Safe mode? (this way we can eliminate the actions of add-ons and even
> resets some settings). If the issue is still reproducible in Safe mode,
> could you please write here the exact steps you are doing?(a screen cast
> will be even better).

Sorry for the late response. I tried starting Firefox in Safe Mode and the problem still exists.
I have made 2 screencasts and uploaded them to YouTube. The first is with me reloading the tabs using Tab Mix Plus add-on ( https://www.youtube.com/watch?v=eb9QCAc4OXA ) and the second is with Firefox in Safe Mode ( https://www.youtube.com/watch?v=y3zzYENQL18 ), the videos are titled appropriately. To not make this comment too long, I've added relevant video information in the descriptions for both videos.

> Not a bug. Is the way the preference
> media.block-autoplay-until-in-foreground preference is working. Once a tab
> is in foreground, media on that tab will not be blocked anymore.

But wouldn't opening a second tab (foreground), make the first tab a ""background"" tab?","Thank you for all the additional details, I think I understand now what you mean. The functionality of the old preference (media.block-play-until-visible) was different by the functionality of the the new one (media.block-autoplay-until-in-foreground). With this new functionality, videos which autoplay in the background will now have their load deferred until the tab is visible for the first time. This is the reason why after opening a video and reloading it, the video still plays. 

Please let us know if you still have any questions related with this.","(In reply to Simona B [:simonab ] from comment #7)

Do you know of any work arounds for this? I prefer the old preference! xD","(In reply to u588159 from comment #8)
> (In reply to Simona B [:simonab ] from comment #7)
> 
> Do you know of any work arounds for this? I prefer the old preference! xD
Sorry. We will not have any workarounds for it and media.block-autoplay-until-in-foreground is the one we continue to use.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1559658,Turn content blocking off on individual sites does not work,INVALID,"Created attachment 9072417
Screen Shot 2019-06-15 at 10.39.11 PM.png

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:67.0) Gecko/20100101 Firefox/67.0

Steps to reproduce:

I tried to open one of the articles shown on the home page, and it ONCE AGAIN requires me to disable content blocking to read the article, so I disabled my ad block add ons, but it wants me to disable Firefox Native Ad Blocker, and this is not possible because the tooltip opened upon clicking the i in the address bar does not provide that option....


Actual results:

I could not continue because the option to unblock the site was not available....


Expected results:

I would have liked to be able to unblock the site to read the article, but Firefox did not provide that option....","I had two separate screenshots that I wanted to attach to my report, but it would not allow more than a single attachment....
I took a screenshot of what Firefox's instruction page claimed should be done, and what was really made available to show that they were not the same....","Why do you even bother to place those article on the home page for the browser, if they are always going to be blocked??","Hi @Zack, the results after testing the issue:
[Platform affected]: Mac OS X, Ubuntu 18.04, Windows
[Environment]: latest nightly 69.0a1, beta 68.0b11, release 67.0.3
- reproducible on all above
Note: It can be reproduced only when nothing is blocked (Content blocking is set to block only trackers on private window, but finds trackers or cookies in normal window). Ehsan, this is an enhancement made on Content blocking from what I know, what do you think we should do with this issue?","You're not blocking anything in that screenshot, so there's no point in unblocking. It wouldn't make a difference. I'm not sure what Washington Post is detecting there, but it's not Firefox doing the blocking. Maybe you haven't fully disabled your add-ons after all? If you open the [Developer Console](https://developer.mozilla.org/en-US/docs/Tools/Web_Console/Opening_the_Web_Console), is there any mention of ""blocked resources""?

When trying this out on Washington Post I don't get any instructions to unblock. If you try this in a new profile, does the problem persist?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1750748,Always open is not respected if the file is blocked (after unblocking download),INVALID,"##### [Description:]
In the case in which we are blocking the download due to security issues, after unblocking we should apply Always Open similar files, if the option is checked.

##### [Environment:]
Windows 10


##### [Steps:]
1. New profile.
2. Open https://www.imperial.ac.uk/computing/csg/guides/java/jsp-tutorial---some-examples-of-java-servlet-pages/
3. Scroll down to Using JDBC in JSP section, right click on Postgres.jsp or MSSQL.jsp and save link as.
4. Unblock download, afterwhich use ""Alawys Open similar files"" option from the Download panel with setting a default app.
5. Save as again any of the jsp files, unblocking the download.


##### [Actual Result:]
4. File.jsp is saved
5. File.jsp is saved

##### [Expected Result:]
4. File.jsp is saved
5. File.jsp is saved and opened.","A few additional notes for this scenario, which have potential for new issues:

1. Save link as triggers Potential security risk, but opening http://www.doc.ic.ac.uk/csg-res/static/jdbc/Postgres.jsp and cotext save as would not. Also, the file saved with content Save as would not have ""Always Open"" option. (bug 1738918 ?)
2. The Application handler would list the entry as ""Text Document"".
3. Low severity due to the fact that it's an edge case.
4. Since now Chrome also has an Always Open option, the save as for Note 1 would save the file.jsp.txt, while Firefox saves correctly file.jsp","I'm a bit confused. Can you re-check if bug 1563141 was ""fixed"" here and now we no longer open files that get unblocked in general? Or...?

And can you check if the behaviour is different with the download improvements pref turned off, and if so, can you run mozregression with that pref enabled, to see which specific change ""broke"" this?","I don't think this is a regression. The fix from bug 1563141 holds water and I don't think it's regressing anything in relationship with ""Always Open similar files"" which is a new functionality, which is not available with the download improvements pref turned off.

Giving more thought to this case: do I really want to auto-open a file that it was initially automatically blocked? Considering the high risk potential here, maybe ignoring the ""always open similar files"" when in this case makes perfect sense. @Gijs, calling it a feature and won't fix then ? :D

Later edit: Chrome for example auto-opens in this case, but given the above reasoning and additional thought, I think we are doing it right and we shouldn't.","(In reply to Adrian Florinescu [:aflorinescu] from comment #3)
> Giving more thought to this case: do I really want to auto-open a file that it was initially automatically blocked? Considering the high risk potential here, maybe ignoring the ""always open similar files"" when in this case makes perfect sense. @Gijs, calling it a feature and won't fix then ? :D

Not that my opinion is really needed here, but I think I agree with this; I don't know if it was ever intentional behavior to refuse to automatically open things after we decided they're suspicious, but it seems like a decent policy regardless.","Thanks Molly! I think so to. 
I'll move this towards WFM, let's reopen if we think that's still something to fix here.","Discussing this more in detail with Gijs the other day, this issue is actually invalid, due to the fact that most likely (don't have any non-malware to test with), we would probably still honor auto-open on download (not save link as).",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1295026,SIMD performance broken :(,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2829.1 Safari/537.36

Steps to reproduce:

I tried tests here:
https://github.com/PeterJensen/mandelbrot
https://github.com/acterhd/rock-js
Tested in x64, SIMD broken. Also slow with typed arrays and classes. 



Actual results:

Slow, very slow with SIMD


Expected results:

Should be faster or slightly equal speed.","Pardon, mandelbrot is valid, but in chrome anyway slower. Also, problems with rock-js is have.","I found issue - Firefox very slow working ""concat"" and ""apply"" functions. Pls fix. But anyway, very slow works and all another functions. For example, typed array creation instances and classes very slow.","Can you tell me which testcase do you use?
What's the difference between this bug and bug 1295037 ?","I have troubles with performance with classes or typed arrays. I tried pure SIMD - very fast. And classed SIMD (i.e. wrapper) - slower in 10x. In chrome blurred difference with performance (as I know, chrome does not support SIMD through SSE/AVX, and use simple operations), so I can resolve that chrome have faster class operations. I optimized libs to maximum, so pure numbers (that faster) and typed arrays have difference only with 100ms (in Chrome).","I can safely say there is no problem in SIMD, I checked on a fractal over and carefully. The problem turned out to be a different kind. And more in-depth than I thought.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1294399,Debugger - Toolbox - poor performance,INVALID,"User Agent: Mozilla/5.0 (Windows NT 5.1; rv:48.0) Gecko/20100101 Firefox/48.0
Build ID: 20160726073904

Steps to reproduce:

Firefox 48. Went I have Toolbox opened and not paused there is bad performance at particular situations.

I often hit situations that Firefox is very slow. I will report this situations here.

First situation since now happened when I wanted to add a bookmark from menu Bookmarks. I had to wait some time till the dialog window was open.

Second situation has happened when I wanted to use Inspector Ctrl+Shift+I. Not the inspector in Toolbox, but that inspector which is in the Developers Tools. It takes about 4 seconds to open (when I have a luck). Then in this inspector, when I found html->head->link I wanted to open stylesheet in Style editor. I clicked with secondary mouse button so context menu opened. Then I clicked on Open File in Style editor and it took few seconds to open this file. 

Another situation, when I open new www page and the CSS Editor is open and I click on Inspector, it can took about 10 seconds to open the Inspector.

Another already known problem is with Preferences:
https://bugzilla.mozilla.org/show_bug.cgi?id=1288965
This does the similar thing like in the previous cases.

What I say is that I must wait often and long so debugging in Firefox sucks.


Actual results:

Delays when I have Toolbox open and I use Debugger Tools, Inspector, Styles Editor, Bookmarks, Preferences.


Expected results:

No delays when I have Toolbox open and I use Debugger Tools, Bookmarks, Preferences.","I don't think this in an actionable bug report as it stands, for a few reasons:

* There are many potential problems mixed together in this report, but we should really have separate reports for each
* It sounds like you are saying Firefox in general outside of the DevTools is also slow

If general Firefox usage is slow all around, either you have an older computer or there is something more fundamental going wrong, such as lots of background work in the OS taking up CPU time, etc.

It doesn't sound like this issue is _specific_ to DevTools, at least not in a way that we can make a change to improve it.","I have 8 core computer and it is cca 1.8 years old. My RAM is at least 4GB RAM (3.5GB in Windows). I think I have pretty fast computer and I have no problems with the classic Debugging tools or Firefox, but with the Toolbox. There are obvious problems when the Toolbox is on. When I close it or do not open it so the other modules like Bookmarks or Debuging tools work without problems. I just wonder how you could push this tool to version 48 when there is so many performance problems. I don't say it is unusable, but it makes a lot problems during debugging. Which makes developping extremly slow. Working with Visual Studio or Codeblocks is still 3x faster because I do not need to solve 4 major bugs in the IDE as in FF48.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1586488,"Each instance of FF uses up 15 - 20% CPU, wile no tasks are open and about:performance reports no to little load.",INVALID,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0

Steps to reproduce:

I updated my Arch install with FF going from 69.0.1 to 69.0.2 when I recognized that FF used up 20% CPU. I've an eye on my CPU as I'm using 6 of my 8 cores for BOINC workloads which stop when the overall load exceeds 20%. 



Actual results:

I restarted the browser and the machine but there was still a load without any page open, just an empty tab. When I start my other profile, the second instance uses 15 - 20% also.

https://perfht.ml/33f6iRB


Expected results:

No CPU load without anything open.","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.","Just realized that the load isn't present when in safe mode. When about:performance isn't reporting anything, how to deduct which add-on is the culprit?","Your profiling results are not useful, they do not contain information about content/extension processes. Please run another profiling session and do not remove key information from the profiling results before generating a link to them.",Had to explicitly add those parts. I hope this contains the information you need. https://perfht.ml/2pOLz8D,"When disabling the KeePassXC-Browser extension the load vanishes. I opened a bug report on their Github https://github.com/keepassxreboot/keepassxc-browser/issues/629

Sorry for the inconvenience. Please close the bug at your discretion.","Thanks for looking into the issue and filing the addon issue.
Closing this one.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1677351,Poor WebRender graphics performance in Nightly 84 on GNOME w/ Wayland,INVALID,"User Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:82.0) Gecko/20100101 Firefox/82.0

Steps to reproduce:

I went to https://fishgl.com/ and tested performance with WebRender enabled. 


Actual results:

I noticed that in Firefox 82.0.3, I had a buttery 60 fps. When I opened the same profile in Nightly, I noticed that the fps had dropped by more than half to about 20.

Note: when I had WebRender disabled, performance was also poor on Stable 82.0.3, so this seems to be a WebRender issue in newer versions.


Expected results:

I should have had the same performance on both browsers.

System information:
* Ryzen 7 1700
* MSI B350 PC Mate
* 16GB RAM
* Gigabyte RX 5700 XT

Video demonstration: https://streamable.com/udpeqd","Profiler of Stable 82 while messing around in https://fishgl.com/: https://share.firefox.dev/3eYPeWZ

Profiler of Nightly 84 while messing around in https://fishgl.com/: https://share.firefox.dev/3f2HjYs",Moving to graphics for a closer look.,"Please open about:support in Nightly, click on ""Copy text to clipboard"" and paste it [here](https://bugzilla.mozilla.org/attachment.cgi?bugid=1677351&action=enter). Thanks!","Do you by any chance use Fedora? :)

Good WebGL performance only comes in combination with EGL + DMAbuf. Thus you need to:
 - have either `MOZ_X11_EGL=1` or `MOZ_ENABLE_WAYLAND=1` set (the later obviously only working in a wayland session - note that Fedora does this by default)
- check that `widget.dmabuf-webgl.enabled` is enabled in `about:config` (should be by default these days

Does that work for you?","(In reply to Robert Mader [:rmader] from comment #4)
> Do you by any chance use Fedora? :)
> 
> Good WebGL performance only comes in combination with EGL + DMAbuf. Thus you need to:
>  - have either `MOZ_X11_EGL=1` or `MOZ_ENABLE_WAYLAND=1` set (the later obviously only working in a wayland session - note that Fedora does this by default)
> - check that `widget.dmabuf-webgl.enabled` is enabled in `about:config` (should be by default these days
> 
> Does that work for you?

I used Fedora in the test, but now am on Arch and unfortunately have the same issue in Firefox 83, w/ about 30fps on FishGL. MOZ_ENABLE_WAYLAND=1 is on, and so is `widget.dmabuf-webgl.enabled`.","Created attachment 9189444
about:support on Nightly 85

I switched to Arch but have the same issue there. I hope this helps.","And yes, if it wasn't clear, I have this issue on Stable 83 now, albeit in Arch (on GNOME Wayland). I therefore assume this issue started in 83.","Ugh, I'm a little stupid. Indeed, starting Firefox with `MOZ_ENABLE_WAYLAND=1` does indeed fix the issue on Wayland, and starting Firefox with `MOZ_X11_EGL=1` fixes the issue in Xorg. I'm sorry for multiple incorrect comments. :(",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1513875,The about:performance tooltips information is not visible with High Contrast #2 theme,INVALID,"Created attachment 9031108
HighContrast#2.gif

[Affected versions]:
Firefox 65.0b4 (BuildId:20181211223337).
Firefox 66.0a1 (BuildId:20181212215507).

[Affected platforms]:
Windows 10 64bit.

[Unaffected platforms]:
macOS 10.14
Ubuntu 16.04 64bit.
Windows 7 64bit.

[Preconditions]
Enable High Contrast #2 theme.

[Steps to reproduce]:
1. Launch Firefox.
2. Access the about:performance page.
3. Hover over an available task.

[Expected result]:
The tooltip is successfully displayed.

[Actual result]:
The tooltip's text is not visible.

[Regression range]:
This is not a regression.

[Note]:
This is not reproducible with High Contrast #1, High Contrast Black and High Contrast White themes in Windows 10.

This is also reproducible with the ""Show in Add-ons Manager"" and ""Close Tab"" tooltips.","Is this specific to about:performance, or does it also happen with tooltips elsewhere in the browser?",Indeed..this is not about:performance specific (reproducible with about:preferences tooltips as well).,"There are longstanding Gecko bugs about not everything being invalidated when changing themes. You likely just need to restart the browser. Unless this regressed in the last year or so, there's probably no point in keeping this open. We could also dupe this against one of the old known bugs, but I don't have them handy.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1411948,Onboardin Performance is not translated on local romania build,INVALID,"[Affected versions]:
 Fx 57.0b11
 Fx 58.0a1

[Affected platforms]:
 Windows 10 x64

[Steps to reproduce]:
 1. Launch Firefox-ro. 
 2. Open a new tab.
 3. Open the Onboarding tour.
 4. Select the performance tab.

[Expected result]:
 The interface is translated in romanian.

[Actual result]:
 The description is written in english.

[Regression range]:
 This is not a regression.

[Additional notes]:
 a. Screenshot with the issue: https://imgur.com/a/j0Zai
 b. Private Browsing is also affected.",https://wiki.mozilla.org/Bug_Triage/Projects/Bug_Handling/Bug_Husbandry#Update_affecteds,"Incomplete translations are expected, not really a bug.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1708693,PDF printing performance are poor,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0

Steps to reproduce:

I open an three PDF files and try to print them.


Actual results:

Files printed about 10 seconds.


Expected results:

In my opinion, printing time shouldn't pass 5 seconds.","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Core::Printing: Output' component, and is moving the bug to that component. Please revert this change in case you think the bot is wrong.","Do you have a PDF that reproduces the issue? If not, can you take a profile using https://profiler.firefox.com so that we can see where time is spent?","(In reply to Emilio Cobos Álvarez (:emilio) from comment #2)
> Do you have a PDF that reproduces the issue? If not, can you take a profile using https://profiler.firefox.com so that we can see where time is spent?

https://share.firefox.dev/3xAiY5i","That profile doesn't really show anything interesting. Afaict there's no real performance issue here, this may just be about the printer driver. Does other software print faster?","(In reply to Bas Schouten (:bas.schouten) from comment #4)
> That profile doesn't really show anything interesting. Afaict there's no real performance issue here

I think the profile may have just been zoomed to a non-interesting portion.  Zooming out, I can see some print-dialog screenshots with associated red jank bars, like this section:
https://share.firefox.dev/3Y9mDTH

> this may just be about the printer driver.

I think that's true, yeah. In my profile link, the jank bars seem to correspond to us spending time (several seconds) in some `BRUIMB0A.DLL` functions, which is a Brother printer driver.

> Does other software print faster?

This is indeed the key question here.  Reporter: if you're still seeing this bug, it'd be super useful to know what sort of comparative performance you get from other software vs. Firefox when printing the same PDF file to the same printer.  Right now, the profile seems to show a performance issue in the printer driver, not in Firefox.","(also: if you do happen to still be seeing a substantial performance difference between Firefox vs. other software when printing a particular PDF: it'd be great if you could share a sample PDF that reproduces the problem, if you've got one that you can share publicly.)","Redirect a needinfo that is pending on an inactive user to the triage owner.
:jwatt, since the bug has recent activity, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).","(In reply to Release mgmt bot [:suhaib / :marco/ :calixte] from comment #7)
> Redirect a needinfo that is pending on an inactive user to the triage owner.

For now, I think we've got to the root of the issue in comment 5; the performance profile shows that the print driver itself was hanging for seconds-at-a-time, for some reason.

That's unfortunate, but not Firefox-specific and it's outside of our control.

Hence, closing as not-a-Firefox-bug.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1279959,Firefox slow to the point of constant freezes and crashes,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586

Steps to reproduce:

1. Run Firefox.


Actual results:

As of late (this has actually been going on for a while, but it only seems to get worse with every version), Firefox is getting ridiculously slow and CPU consuming, to the point where it keeps freezing every couple of seconds, crashing, and usually also taking huge amounts of RAM with it.

The number of tabs or their content does not seem to matter at all.

When running a fresh copy of Firefox (using the Refresh option), this still happens.

However, when running in Safe Mode, it doesn't happen, and Firefox works as smooth as it used to.

At the same time, if I don't run in safe mode, and instead manually go and disable all extensions and plugins, which is presumably what safe mode does, this issue still happens.

Beside running in safe mode, I couldn't find any solution or setting that helped mitigate the issue.

I am not sure what more information I can give, or what files I should attach.


Expected results:

It should run properly.","You should consider resetting your current profile to keep only private data and reinstall the add-ons one by one.
https://support.mozilla.org/en-US/kb/reset-firefox-to-fix-most-problems","Not only did I reset (why did I call it refresh?), but this also happens on an actual freshly installed copy of Firefox, on a computer that was just formatted.

Oddly enough, it didn't happen to me so far in the past two days.

I am honestly clueless, but when it happens, Firefox becomes unusable.","Ok, it seems like it has something to do with the HTML5 video player.

I have a tab that loads a video, and for some reason when that tab is active, Firefox becomes so slow that it keeps freezing every couple of seconds for a second or two.

This issue usually only happens when that tab is indeed active, but it seems to also get stuck in this condition sometimes and become useless regardless of what tab is active, or if the buggy tab is closed.

I used to have all tabs open upon starting Firefox, so I could never pinpoint the issue.

I am not sure if there's some funky thing going on with the specific site I am watching the video on, or if it's actually a Firefox issue.

I'll try to look more into it.","Hi,

Can you create a new profile and retest this issue without adding any add-ons? You have the steps here:https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles?redirectlocale=en-US&redirectslug=Managing-profiles#w_starting-the-profile-manager

If you can't reproduce the issue with new profile, you can start adding one by one you add-ons and see which one may cause this problem.  Thanks for your time and help.","Ok, it is not related to Firefox.

The aforementioned site is kisscartoon.me, and some ad-related code seems to obliterate the JS VM when using an ad-blocker.
I am not sure if this is some anti-ad-blocker strategy, or just buggy code, because the code is minified and provides no debugger maps.

Sorry for reporting this.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1278769,slow loading and lockups on some webpages,INVALID,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:46.0) Gecko/20100101 Firefox/46.0
Build ID: 20160504092450

Steps to reproduce:

On both Archlinux and Ubuntu:

1- visit a page like https://inspirehep.net/author/profile/P.C.Rowson.1


Actual results:

The loading may take up to 1 minute and during the loading the system experiences lockup


Expected results:

On other browsers it loads in less than 1 seconds","Hello Marco. I couldn't reproduce the behavior on the latest release version: 47.0 Build ID 	20160604131506.
I'm suspecting one of your addons to be culpable therefore could you try to see if the issue is reproducible with safe mode enabled? (https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode)","Thanks for your answer Adrian. Before submitting the bug I tried with all addons disabled but the problem was still there. Sorry that I forgot to mention that!
Anyhow with the upgrade to v47 now it seems to be solved!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1278075,"Firefox loads Webpages very slow after update to 46.0.1, sometimes not even the whole html source",INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586

Steps to reproduce:

I updated from Version 45 to 46


Actual results:

Pages don't load completely, f12 doesn't bring up the whole html, other Browsers on the same Computer work fine.


Expected results:

Firefox should display and load Webpages just like edge does.","Does it work in safe mode?
https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode

With a fresh profile?
https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles

If that works with a fresh profile, you can try to reset your current profile:
https://support.mozilla.org/en-US/kb/reset-firefox-to-fix-most-problems","Looks like it was a Windows problem, after booting into Linux and then entering windows everything works as intended. Thanks for the help anyways",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1776579,Firefox absolutely stutters and reacts very slowly for some minutes after starting,INVALID,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:101.0) Gecko/20100101 Firefox/101.0

Steps to reproduce:

1. Start Firefox


Actual results:

Firefox stutters and reacts very slowly, scrolling pages is choppy, after hovering over inactive tabs it takes maybe 5-6 seconds until it is highlighted.

Here, some more info: https://share.firefox.dev/3Ad05Jg


Expected results:

Silky smooth Firefox",Looks like tons of time spent in freetype in parent process,"There's also a lot of addons, maybe try disabling some?","Here is another one: https://share.firefox.dev/3ONTMQK

I'm not sure if extensions have something to do with this. Yes, it is true that it takes maybe 10-20 seconds until the extensions load and the first restored tab site loads, but the lagging happens after that, when the extensions have loaded.",Extensions can have an effect after they have finished loading.,"The severity field is not set for this bug.
:lsalzman, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).","It's spending a lot of time in gfxPlatformFontList::InitializeFamily, does this seem out of the ordinary Jonathan?

Lyubomir, can you please attach your ""about:support"" information?","Created attachment 9285880
about:support","It looks like there's a fairly large number of add-ons installed. Have you tried disabling addons/starting in safe-mode to see if the problem goes away? If it does temporarily alleviate the problem, that would tell us that one of the addons is at fault.","I wonder if this is one of those situations where fontconfig is continually rebuilding the default font set, so that we constantly have to reinitialize our fonts. We've seen cases where this is triggered by the existence of an empty ~/.local/share/fonts directory on certain distros; I don't recall the exact details offhand. It seems to be a bug in a particular fontconfig version.","Arch Linux here, FWIW i have no such directory on my system.","This makes Firefox unusable for at least 2-3 minutes after each start, going on for weeks now.",Is there anything i can do to fix this?,Does this behavior still happen in the current release (Fx108)?,"Yes, it does.","Like it can't draw updates to its interface smooth but choppy, not only the webpages.",Moved to Chrome because of this..,"I think Lee was still waiting for an answer in comment 8.  Can you try this using a ""clean"" profile without any extensions to see if it still happens?","Sorry, i've switched to Fedora and decided to give Firefox a new try there. In a new profile on a new Fedora installation this issue doesn't seem to happen. I generally have the same extensions. What might be an issue is that i had 1117 hidden stashed tabs from the Tab Stash extension. Now they're just bookmarks so still visible in its UI but not actually existing as stashed tabs.","But actually i don't know, i've attached performance profiles before and seems like either you didn't look into them or they were not useful...","(In reply to Lyubomir [:mystiquewolf] from comment #19)
> But actually i don't know, i've attached performance profiles before and seems like either you didn't look into them or they were not useful...

I did indeed lot at your profile, which is why I was able to leave comment 2, and comment 2 does indeed seem to have been useful. Glad your issue was resolved.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1673824,PDF.js much slower than Chrome with lots of LaTeX symbols,INVALID,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:81.0) Gecko/20100101 Firefox/81.0

Steps to reproduce:

Visit https://home.uni-leipzig.de/assmann/teaching/SS15/mathmode.pdf in Firefox nightly


Actual results:

Takes around 3s to load (not counting download time)

Bunch of profiles (didn't know what's the correct profiler mode):
https://share.firefox.dev/3mu0sVP
https://share.firefox.dev/3kw6S6l
https://share.firefox.dev/37RCQGD
https://share.firefox.dev/31P1CU2


Expected results:

Should take around 1s to load, as in Chrome",I originally reported it for PDF.js but it turns out it doesn't happen when PDF.js is used in Chrome https://github.com/mozilla/pdf.js/issues/12435. Note that I don't see much of a difference with or without WebRender with this version of nightly. The profiles above are with WebRender enabled.,"Hi, 
I was unable to reproduce on latest Nightly version 84.0a1 (2020-11-05) on macOS 10.15.
I will set a component to have a starting point of this. Please feel free to change it if it is not the right component.","I was also unable to reproduce on a Mac Pro and a Linux desktop, both render nearly instantly after download is complete. Have you tried with a clean profile?","Yes my tests are with a clean profile. I just re-checked with FF nightly from yesterday, still have the problem. Loading times:

Chrome: ~2s
FF w/o WebRender: ~5s
FF w/ WebRender: ~4.5s

Performed the test as follows:

Go to https://mozilla.github.io/pdf.js/web/viewer.html; upload the file from local file system; wait for loading indicator to disappear (the one next to the current page indicator on the top left)","Created attachment 9254627
mathmode.pdf

I found the pdf in the pdf.js github: https://github.com/mozilla/pdf.js/issues/12435","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0

I was not able to reproduce the bug on recent nightly, and not with mozregression on FF 81 with & without Web Render (all on Win)

:Jonas H., Are you able to reproduce the bug on your machine with recent FF ?",I can confirm that this is as fast as Chrome and faster than Safari with FF 95 on macOS.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1454542,"When possible, obtain message bodies from cache instead of from imap server.  Especially helping non-autosync profiles and users on slow network",INVALID,"User Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0
Build ID: 20180327091359

Steps to reproduce:

For folders without offline storage (no mbox or maildir files containing a local copy of the message) when messages are accessed having attachments or other ""mime"" content, the main message body is always fetched from the network even if it was previously accessed and stored to cache.

Also, when a message with attachments and/or mime content is displayed with ""show source"" or it is ""saved to file"",  the main body and mime parts are not completely stored to cache. So when main body or attachments are accessed again, they are obtained from the network again and then stored to cache.




Actual results:

On a fast network this unnecessary network activity may not be noticed.  However, on a metered network, this redundant network activity may add some cost.  Also, it just kind of bothers me to see unneeded network activity.


Expected results:

When re-accessing a message, obtain as much as possible from cache instead of going to the network to obtain the content. Also, when saving or displaying the source for a message, ensure the full message is saved to cache and that it is fully accessible.

Note: Currently attachments are, in general, properly saved to cache and later accessed from cache.  However, the main message body is not, which is addressed here.

See Bug 1443750 for more discussion on this issue (search: ""world""). Also, Bug 1300402 is somewhat related.","I have a fix for this that I have been running for a couple weeks. I need to review it, test it some more and clean it up. Then I will probably submit a patch.",Sounds promising!,"This could also benefit users who run without local offline store and possibly have a slower network connection such as DSL or maybe even dialup and have messages that have large attachments to view or save. For example, I have a chromebook that I run tb on, via linux in a chroot, that has a small flash drive (about 30G I think) so I don't have my emails locally stored in mbox or maildir files; with network speeds throttled down to DSL speeds I get good performance with the fix.

Another thing this fixes is that sometimes the url information that is relevant to cache handling (part and filename) occurs more than once in the url with different values and only the last values in the url should be extracted and used for the cache key. The original code always found the first occurrence. My changes finds the last occurrence.

Also, when an attachment is opened, the current code always fetches the the attachment twice. After the first fetch begins, the cache is written to but then a pseudo interrupt occurs that dooms the entry and causes it to be downloaded again. This pseudo interrupt, called from FetchMimePart() in nsImapService.cpp only seem to interrupt the transfer of the currently selected message. Removing it seems to cause no harm and avoids the 2nd fetch. Now instead of a 2nd imap fetch, the attachment (part) is read back from its cache.

Here is the only documentation I could find of what a pseudo interrupt really is and does, from Bug 386514 Comment #3, specifically: 

""This is what we call pseudo-interruption; you click on one large message; we fetch it in chunks, and when you click on the second message, we ""pseudo-interrupt"" the first fetch, i.e., we stop fetching chunks of the first message, and start fetching chunks of the second message.""

Pseudo interrupt still occurs, in Cancel() of nsImapProtocol.cpp, when another message or folder is selected that stops the transfer and invalidates (dooms) the cache entry if it is not yet complete. However, I have noticed that, with and without my change, this pseudo interrupt has a less than immediate effect unless the transfer is in chunks. If the transfer size is below the chunk threshold, the whole message is transferred in one piece and runs to completion even if another message or folder is selected. (This is the only advantage I have found for the chunking feature!).

My change also solves the problem that was fixed here: Bug 1355350 Comment 36. This requires having a message plus an attachment that exceeds the configured cache entry size. The pseudo interrupt set in FetchMimePart(), now removed, also contributed to this problem. Now, instead of the cache entry getting doomed, an error occurs when the cache is read that causes the data to be read from imap.","Created attachment 8981340
1454542-proposed-changes.patch - original proposal (now with bitrot).

See comment 3 for some details.","I forgot to mention that this is kind of hard to test and really see what is happening in detail without printfs or maybe logging and or a network sniffer.  Jorg suggested that tracing be added, maybe as a separate patch?","(In reply to gene smith from comment #5)
> Jorg suggested that tracing be added, maybe as a separate patch?
Yes, experience has show that we certainly need IMAP cache logging. Yes, that should go into a different bug.

BTW, Wayne is not a developer, so he doesn't compile his own binary and can't give feedback.","Comment on attachment 8981340
1454542-proposed-changes.patch - original proposal (now with bitrot).

> Wayne... doesn't compile his own binary and can't give feedback.

Indeed, that is currently true.

Perhaps Alfred can","Hi Jorg, Maybe you can answer a quick question? With this patch running on about 28-may-2018 comm-central tree I see something different than I saw when my changes were on about 28-feb-2018 tree. 

When an attachment is accessed, typically I see this sequence:

OpenCacheEntry()...: Try to read part from entire message cache.

OpenCacheEntry()...: It's not in the entire message, fetch and write the part to cache.

OpenCacheEntry()...: Read the part one or more times from cache. Helper app pops up to open it.

Now most often the last OpenCacheEntry() doesn't occur and nothing pops up. If I click the attachment again, usually the helper app then pops up and opens the attachment.

I think I saw this with the 28-may tree before I put my changes in, but not sure. I will back out my changes and try again.

Do you know of anything changed since 28-feb that might have caused this?","changeset:   23991:d6ef5265865e
tag:         tip
user:        aceman <acelists@atlas.sk>
date:        Mon May 28 15:10:00 2018 +0200
summary:     Bug 1462923 - Follow-up: Check that add-on options dialog really opens. r=jorgk

I backed out my changes to the above changeset and I see the same thing. Although it doesn't have the printfs, I can see the same thing. Like with no offline store and attachments inline, when I click on a .avi or .mp3 attachment the first time, nothing happens. I do see the appropriate part downloaded with wireshark. I click again and the video or audio play in the external app. I see this with other file types too. However, it seems to be random; sometimes it works OK the first time the attachment is opened.

Also, when a message is selected, often it doesn't open in the display pane. If you move to another message and then go back and select again, it works. Seems to be basically the same thing.","Wow, you've submitted quite a large patch here.

Perhaps we should start with adding logging to the code, as suggested in bug 1443750 comment #23.

As for your question: If I understand it correctly, you're saying that something has changed in behaviour between 28-feb and 28-may. I certainly haven't landed any changes to IMAP of caching or anything lately, besides, you'd be the first person to know.

That said, of course the underlying M-C code changes constantly, maybe also the cache manager. If I read you comments correctly, we're looking at problems which don't reproduce reliably, like in "" ... sometimes it works OK the first time ..."". So surely, if there are timing or other issues, subtle changes in the underlying code can cause changes in behaviour.

I think first we should concentrate on some solid logging and then on some reproducible cases. Sadly, bug 1443750 and bug 1451137 haven't moved, and that code is soon hitting TB 60 ESR with exposure to 10-25 million users.","(In reply to Jorg K (GMT+2) (bustage-fix and urgent reviews only) from comment #10)
> 
> Perhaps we should start with adding logging to the code, as suggested in bug
> 1443750 comment #23.

Will do that now and call it ""IMAPCache"" like you suggested. 

> 
> I think first we should concentrate on some solid logging and then on some
> reproducible cases. Sadly, bug 1443750 and bug 1451137 haven't moved, and
> that code is soon hitting TB 60 ESR with exposure to 10-25 million users.

I did find a reason at bug 1443750 comment 36 although I need to revisit it. Also bug 1451137 I looked at quite a bit a while back but didn't see anything really wrong. Need to revisit this too but I think the reason for the assert might be due to it being hit when not chunking.","Created attachment 8983242
Example failure screenshot

I updated to current tip changeset ""24038:75f2307c2191 (Jun 04)"" and it took a while to see a problem. Probably not that helpful but this screenshot shows one way the problem manifests itself. I had just opened some attachments in the email ""add-attach-Acuse..."" that, this time, worked OK.  Then I moved to the email ""SMITH'S MORE..."" and it failed to appear. At the bottom the progress thing keeps moving and never stops and the ""SMITH'S..."" email never appears.

I don't have logging or printf's now but I am monitoring with wireshark. The entire ""SMITH'S..."" email was fetched in chunks as I would expect, since I have no offline store and attachments viewed inline and all attachments are viewable images.

Just to be clear, this doesn't contain any of my cache or other changes in the attached patch.","Not sure if this is related, but after I submitted comment 12 I noticed tb had shutdown. I saved stdout/err to tb.log file and see this crash info:

End mail message delivery.
Hit MOZ_CRASH(nsWeakReference not thread-safe) at /home/gene/comm-central/mozilla/xpcom/base/nsISupportsImpl.cpp:46

Program /home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/thunderbird (pid = 11932) received signal 11.
Stack:
#01: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x52662f1]
#02: ???[/lib64/libpthread.so.0 +0x121b0]
#03: MOZ_CrashOOL[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/thunderbird +0x21118]
#04: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x10531b2]
#05: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x10642ff]
#06: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xed67b9]
#07: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xed68b1]
#08: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xd97c3f]
#09: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xed6a08]
#10: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xea6b7e]
#11: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xea41bf]
#12: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xea3d63]
#13: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0xea42d3]
#14: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x10cff69]
#15: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x10df0c5]
#16: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x15e435d]
#17: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x15896a9]
#18: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libxul.so +0x10ce40e]
#19: ???[/home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/libnspr4.so +0x29d98]
#20: ???[/lib64/libpthread.so.0 +0x750b]
#21: clone[/lib64/libc.so.6 +0xf516f]
#22: ??? (???:???)
Sleeping for 300 seconds.
Type 'gdb /home/gene/comm-central/obj-x86_64-pc-linux-gnu/dist/bin/thunderbird 11932' to attach your debugger to this thread.
GetDiskSpaceAvailable returned: 643910381568 bytes
Begin mail message delivery.
End mail message delivery.
Done sleeping...","Created attachment 8983617
video opens ok (log file)

I created a new log category IMAPCache and made the printfs we were using MOZ_LOGs on the tip version. Here's the detailed comparison between when a video attachment opens (and plays) OK vs. when it is opened it and nothing happens from the user's view. This attachment is the successful case and the next attachment is when it fails. I have included the raw log output and an annotated version in both files.
Note: Other attachments (and sometimes messages) also sometimes fail to open in a similar way. However, when re-accessed they always open. I have tried to duplicate this with the 52.* version but haven't seen it. It is kind of rare so that might not mean anything.","Created attachment 8983618
video fails to open (log file)","Comment on attachment 8981340
1454542-proposed-changes.patch - original proposal (now with bitrot).

I think this is going in the right direction and cancelling the feedback shouldn't be taken as discouragement here.

I believe the subject matter is so difficult that we really need solid logging added to IMAP caching and then present this patch again with the new logging also added to the new code.","Created attachment 8984929
1454542-IMAPCache-logging-v0.patch

Here are the MOZ_LOG() for the new logging category called IMAPCache. These include most of your original DEBUG printf texts plus several others I have added to help with observing the issues that occur when caching is going on.

You may notice a few uses of MOZ_LOG_TEST(). I use this to skip a block of logging-only related code in order to minimize the overhead when the MOZ_LOG env variable is not defined.",Thanks for the updated patch. The review will be delayed since all our efforts currently go into bug 1466705 to fix the subscribe dialogue for IMAP and NNTP which is long overdue and urgently required for TB 60.,"Comment on attachment 8984929
1454542-IMAPCache-logging-v0.patch

Review of attachment 8984929:
-----------------------------------------------------------------

My sincere apologies for the delay here. I didn't realise that these are ""only"" the logging changes.

I think we need to make the output more consistent and hence easier readable. Yes, this came from a messy debug patch which had grown over time, so now is the time to do it right. Logging in cache2, like in CacheStorage.cpp, can serve as an example here.

Cancelling the review for now, this needs another round.

::: mailnews/imap/src/nsIMAPBodyShell.cpp
@@ +216,5 @@
>      NS_ASSERTION(GetIsValid());
>  #endif
>      m_generatingWholeMessage = true;
>      uint32_t messageSize = m_protocolConnection->GetMessageSize(GetUID().get(), true);
> +    MOZ_LOG(IMAPCache, LogLevel::Debug, (""Setting NOT MODIFIED in Generate()\n""));

I don't think you need the \n here and elsewhere, see for example:
https://searchfox.org/mozilla-central/rev/403038737ba75af3842ba6b43b6e2fb47eb06609/netwerk/cache2/CacheStorage.cpp#96

@@ +451,5 @@
>      bool fetchingSpecificPart = (generatingPart && !PL_strcmp(generatingPart, m_partNumberString));
>  
>      aShell->GetConnection()->Log(""SHELL"",""GENERATE-Part-Inline"",m_partNumberString);
> +    MOZ_LOG(IMAPCache, LogLevel::Debug,
> +        (""FTC() is called from nsIMAPBodyShell.cpp, partLen=%d, partNumStr=%s\n"", m_partLength, m_partNumberString));

Please don't use cryptic abbreviations like FTC.

::: mailnews/imap/src/nsImapProtocol.cpp
@@ +1565,2 @@
>        cacheEntry->AsyncDoom(nullptr);
> +      MOZ_LOG(IMAPCache, LogLevel::Debug, (""Did doom in DoomCacheEntry()\n""));

Maybe:
DoomCacheEntry: Called AsyncDoom().

@@ +1833,2 @@
>        DoomCacheEntry(mailnewsurl);
> +      MOZ_LOG(IMAPCache, LogLevel::Debug, (""SigDeath: called DoomCacheEntry()\n""));

Make consistent with the suggestion above.

@@ +2643,2 @@
>                SetContentModified(IMAP_CONTENT_NOT_MODIFIED);
> +              MOZ_LOG(IMAPCache, LogLevel::Debug, (""1 -- set NOT MODIFIED\n""));

What are these numbers?

@@ +2682,5 @@
>                    Log(""SHELL"",NULL,""Loading part, shell not found in cache!"");
>                    //MOZ_LOG(IMAP, out, (""BODYSHELL: Loading part, shell not found in cache!""));
>                    // The parser will extract the part number from the current URL.
>                    SetContentModified(modType);
> +                  MOZ_LOG(IMAPCache, LogLevel::Debug, (""4 -- set IS MODIFIED\n""));

Why 4? You have 1, 5, 3, 2 elsewhere, but I don't get the significance.

@@ +2756,5 @@
> +                if (MOZ_LOG_TEST(IMAPCache, LogLevel::Debug))
> +                {
> +                  // For logging the running URL
> +                  nsresult rv;
> +                  nsCOMPtr<nsIMsgMailNewsUrl> mailnewsurl = do_QueryInterface(m_runningUrl, &rv);

What class is m_runningUrl here? Do you need the QI or does that class have a GetSpec() method?

@@ +2759,5 @@
> +                  nsresult rv;
> +                  nsCOMPtr<nsIMsgMailNewsUrl> mailnewsurl = do_QueryInterface(m_runningUrl, &rv);
> +                  nsAutoCString urlSpec;
> +                  mailnewsurl->GetSpec(urlSpec);
> +                  MOZ_LOG(IMAPCache, LogLevel::Debug, (""m_runningUrl = |%s|\n"", urlSpec.get()));

Maybe we shouldn't mention names of variables in the debug. Also below.

@@ +9254,5 @@
>          nsCString annotation;
>          rv = entry->GetMetaDataElement(""ContentModified"", getter_Copies(annotation));
>          if (NS_FAILED(rv) || !annotation.EqualsLiteral(""Not Modified""))
>          {
> +          MOZ_LOG(IMAPCache, LogLevel::Debug, (""===Entry is not complete and cannot be used\n""));

Let's use a consistent set of prefixes. Here you have === with no space following.

@@ +9296,5 @@
> +      {
> +        int64_t size = 0;
> +        rv = entry->GetDataSize(&size);
> +        if (rv == NS_ERROR_IN_PROGRESS)
> +          MOZ_LOG(IMAPCache, LogLevel::Debug, (""*******OnCacheEntryAvailable: concurrent read, no size available\n""));

And here a few asterisks.
Also, we should make the prefix consistent. Here you have the function name 'OnCacheEntryAvailable', on other occasions you have nsImapMockChannel::OnCacheEntryAvailable() and then there are cases with no prefix.","Sorry for the delay in getting back to this. I pretty much left the log messages the way I was used to seeing them print since I was doing a lot of debugging and testing at the time and didn't want to change them quite yet. But I figured you would want them changed. :)

Anyhow, I will go ahead and incorporate your suggestions and submit another logging related patch.","Created attachment 8998718
1454542-IMAPCache-logging-v1.patch

(In reply to Jorg K (GMT+2) from comment #19)

I think I addressed your comments but Not sure about this one:
 
> 
> @@ +2756,5 @@
> > +                if (MOZ_LOG_TEST(IMAPCache, LogLevel::Debug))
> > +                {
> > +                  // For logging the running URL
> > +                  nsresult rv;
> > +                  nsCOMPtr<nsIMsgMailNewsUrl> mailnewsurl = do_QueryInterface(m_runningUrl, &rv);
> 
> What class is m_runningUrl here? Do you need the QI or does that class have
> a GetSpec() method?

I did make both places I did this using the code lines.

Also, as a prefix I used only the function name. Having also the class name maybe makes the log string too long.","Created attachment 8998728
1454542-IMAPCache-logging-v2.patch

Fixed some errors in v1 patch: Missed some still present \n's and a couple lines were changed that shouldn't be.","> I did make both places I did this using the code lines.

Sorry, this should be:
I did make the two places I did this use the same code structure like this:

if (MOZ_LOG_TEST(IMAPCache, LogLevel::Debug))
{
  // For logging the running URL
  nsCOMPtr<nsIMsgMailNewsUrl> mailnewsurl = do_QueryInterface(m_runningUrl);
  nsAutoCString urlSpec;
  if (mailnewsurl)
  {
    urlSpec = mailnewsurl->GetSpecOrDefault();
    MOZ_LOG(IMAPCache, LogLevel::Debug, (""ProcessSelectedStateURL(): Fetch entire msg; url = |%s|"", urlSpec.get()));
  }
}","Comment on attachment 8998728
1454542-IMAPCache-logging-v2.patch

Review of attachment 8998728:
-----------------------------------------------------------------

Sorry about the delay. Looks good but there are a few inconsistencies:
- I think the logging should come before the function call.
- Not sure how to best print a bool.

::: mailnews/imap/src/nsIMAPBodyShell.cpp
@@ +223,1 @@
>      m_protocolConnection->SetContentModified(IMAP_CONTENT_NOT_MODIFIED);  // So that when we cache it, we know we have the whole message

You're inconsistent on whether you call the function first or do the logging first. Here we have logging first.

@@ +453,5 @@
>      bool fetchingSpecificPart = (generatingPart && !PL_strcmp(generatingPart, m_partNumberString));
>  
>      aShell->GetConnection()->Log(""SHELL"",""GENERATE-Part-Inline"",m_partNumberString);
> +    MOZ_LOG(IMAPCache, LogLevel::Debug,
> +        (""GeneratePart(): Call FetchTryChunking() part length=%d, part number=%s"", m_partLength, m_partNumberString));

%d, needs to be replaced with |""% PRIi32 "",| - or PRIu32 if unsigned.

::: mailnews/imap/src/nsImapProtocol.cpp
@@ +1329,5 @@
>          if (aImapFolder == runningImapFolder && msgWindow == aMsgWindow)
>          {
>            PseudoInterrupt(true);
>            *interrupted = true;
> +          MOZ_LOG(IMAPCache, LogLevel::Debug, (""PseudoInterruptMsgLoad(): Set Pseudo Interrupt""));

Function first.

@@ +1334,4 @@
>          }
>          // If we're interrupted, doom any incomplete cache entry.
>          DoomCacheEntry(mailnewsUrl);
> +        MOZ_LOG(IMAPCache, LogLevel::Debug, (""PseudoInterruptMsgLoad(): Call DoomCacheEntry()""));

Function first.

@@ +1565,2 @@
>        cacheEntry->AsyncDoom(nullptr);
> +      MOZ_LOG(IMAPCache, LogLevel::Debug, (""DoomCacheEntry(): Call AsyncDoom()""));

Function first. I think logging first is better since the function might do it's own logging and then you cause confusion.

@@ +2760,5 @@
> +                  nsCOMPtr<nsIMsgMailNewsUrl> mailnewsurl = do_QueryInterface(m_runningUrl);
> +                  nsAutoCString urlSpec;
> +                  if (mailnewsurl)
> +                  {
> +                    urlSpec = mailnewsurl->GetSpecOrDefault();

Here you use the spec, below the ASCII spec.

@@ +9193,5 @@
>  nsImapMockChannel::OnCacheEntryAvailable(nsICacheEntry *entry, bool aNew, nsIApplicationCache* aAppCache, nsresult status)
>  {
> +  if (MOZ_LOG_TEST(IMAPCache, LogLevel::Debug))
> +  {
> +    MOZ_LOG(IMAPCache, LogLevel::Debug, (""OnCacheEntryAvailable(): Create/write new cache entry=%d(bool)"", aNew));

Not sure whether you can do print a bool with %d. CAn you please check?
I sometimes do: xx?1:0, or we could do xx?""true"":""false"".

@@ +9303,5 @@
> +        int64_t size = 0;
> +        rv = entry->GetDataSize(&size);
> +        if (rv == NS_ERROR_IN_PROGRESS)
> +          MOZ_LOG(IMAPCache, LogLevel::Debug, (""OnCacheEntryAvailable(): Concurrent cache READ, no size available""));
> +        MOZ_LOG(IMAPCache, LogLevel::Debug, (""OnCacheEntryAvailable(): Begin cache READ, size=%"" PRIi64 "" "", size));

Put this into an else branch?

@@ +9378,5 @@
>  
> +  if (MOZ_LOG_TEST(IMAPCache, LogLevel::Debug))
> +  {
> +    nsAutoCString urlSpec0;
> +    m_url->GetAsciiSpec(urlSpec0);

Here you use the ASCII spec.

@@ +9547,5 @@
>  
>    /**
>     * Common processing for full messages and message parts.
>     */
> +  MOZ_LOG(IMAPCache, LogLevel::Debug, (""ReadFromMemCache(): End separate processing: shouldUseCacheEntry = %d(bool)"",

Same comment on bool as above.

::: mailnews/imap/src/nsImapUrl.cpp
@@ +1056,4 @@
>    }
> +  else
> +    MOZ_LOG(IMAPCache, LogLevel::Debug,
> +            (""SetContentModified(): Set annotation FAILED -- no cacheEntry""));

Please add {} here since if the 'if' part has braces, we like to put them on the 'else' part too.","Gene, can we move this along? Cycling NI to cause some noise ;-)","Comment on attachment 8998728
1454542-IMAPCache-logging-v2.patch

I'll rebase this and fix the nits in bug 1519387.

This bug can then address the original problem.","Comment on attachment 8981340
1454542-proposed-changes.patch - original proposal (now with bitrot).

Original proposal, need to be rebased and moved forward.","Sorry, been meaning to get back on this. Been working on other things and haven't had a chance to get back to this yet. I will ASAP. (Probably the break from it and then a fresh look will help.)","I noticed something that I don't think I saw before but maybe just missed it. 

I have a message sitting in a folder with no offline store. The message is very simple with a text only body, a zip file attachment and a large text file attachment. I have view attachments inline turned off and the fetch on demand for attachments enabled and the attachment files are larger than the fetch on demand threshold (30k bytes).

With ram cache empty (after tb startup or after clearing cache in advanced setting) and clicking on the message, the body mime part (just 14 bytes) is fetched and both attachments are fetched. The body is stored to a cache entry and the attachments are also stored, each to a separate cache entry. The cache key for the body part starts with imap://username@host... but the attachment cache keys both leave off the username and are just imap://host... 

So two question arise at this point. Why are the non-inline attachments fetched at all at this time and why do the URL's for the attachments not also have a username?

Now the message displays correctly with the short body text and the two links for the attachments. If the zip attachment is clicked, which should be in cache, it is fetched again. This is because the URL for fetching it now contain the username, imap://username@host... so this ""key"" is not found in cache and a new entry is written and the zip file can now be accessed using an external viewer. The same thing occurs when the text file attachment link is clicked.

Subsequent accesses to this message and its attachments are obtained from cache since now all parts have a valid entry key in cache. 

On a fast network this extra activity may not be noticed.

This is  observed with the patch for this bug rebased and applied to the current trunk and also without the patch applied to trunk. I think I see this also with 60.* so doesn't seems to be a regression but need to check closer.","You should be aware of a possibly significant change that landed in 68, the code here:
https://searchfox.org/comm-central/source/mail/base/content/msgHdrView.js#1907
In normal cases, libmime streams the attachment info for various UI purposes. But if not, then it's fetch()ed and fetch() doesn't like credentials in urls.",">This is observed with the patch for this bug rebased and applied to the current trunk and also without the patch applied to trunk. I think I see this also with 60.* so doesn't seems to be a regression but need to check closer.

I also see the problem also with 68.0. I then checked with 60.8.0 and only see the 14 byte main body fetched when the message is accessed. The attachments are only fetched when they are clicked. This is how it should work.

So this seems to be a regression. I can't exactly see the URLs that are received in imap code since the IMAPCache logging isn't in 60.* But based on the fact that the unexpected attachment imap fetches don't occur with 60.8 with the same settings, it does appear that something has affected this.

>You should be aware of a possibly significant change that landed in 68, the code here:
https://searchfox.org/comm-central/source/mail/base/content/msgHdrView.js#1907
In normal cases, libmime streams the attachment info for various UI purposes. But if not, then it's fetch()ed and fetch() doesn't like credentials in urls.

Maybe this change is causing the unexpected URLs for the two attachments to occur in the imap cache handling code (and without the expected username in front)? If so, the fix for bug 1345167 is causing a regression. I can't tell exactly but with 60.8 it appears that only the URL for whole message occurs and **with** the username in front when the message is opened.","I backed out the changesets associated with bug 1345167. Had to make some merge/conflict guesses but I think I got it about right. When I did that and with IMAPCache logging enabled, I can see that it works like it used to.","(In reply to gene smith from comment #32)
> I backed out the changesets associated with bug 1345167. Had to make some merge/conflict guesses but I think I got it about right. When I did that and with IMAPCache logging enabled, I can see that it works like it used to.

up for another go at it?","At some point, yes I want to get back to this. There was another bug recently where this came up and the user's huge attachment was being fetched multiple times. It's in my ""bugs of interest"" bookmark list :).",Some data in bug 1302422.  Maybe we should just duplicate that and bug 1302228 to this bug.,"Wayne, what I'm looking at in this bug isn't the same as bug 1302228. Here I was seeing a message fetched by parts have some parts downloaded more than once on a single access.  Bug 1302228 involves the message getting fetched again to be accessible offline, so not the same.

(Also, FWIW, fetch by parts on demand is now disabled by default due to the new built-in encryption feature. So new users will have to change the pref to see this bug 1454542)","Since imap fetching of parts was completely removed in Bug 1805186, it renders this bug moot.
So I'll take the liberty to close this. I think ""INVALID"" is the best category.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1348287,Too slow (10-15 seconds) marking as not spam (not junk) and deleting messages,INVALID,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Build ID: 20170303012224

Steps to reproduce:

Marked a message as ""not spam"", this problem also occurs when deleting multiple messages (takes an eternity to finish and refresh the window). Version 45.8 - Linux - Ubuntu


Actual results:

message takes about 10 incredible seconds to be moved from the current folder to my inbox folder.


Expected results:

when you mark a message as not spam, the automatic message moving should take less then a second or be immediate to user.","More detail: I have multiple accounts (about 7) and I keep messages from last 2 years. I think quantity of messages should not interfere (so much) in an operation of marking as not spam, because I am marking one unique message, not doing a search.","This has nothing to do with search, unless you are using a filter on the Spam folder.

> I keep messages from last 2 years
Which folder are you talking about - spam folder? inbox?
And how many messages are in the folder?

> message takes about 10 incredible seconds to be moved from the current folder to my inbox folder.
again, what is the current folder?

(please make you comments as precise as possible)","question 1: read again with care: I said I am marking a message as not spam, NOT doing a search. I never said it was a search.

question 2: I have about 400 messages in total, I use also multiple filters for incoming messages. I keep my email files in a different partition. Using symbolic link as Mail folder, pointing to where it is, in the other partition. Does it affect?

question 3: If I am marking a message as not spam, we suppose we are talking about Trash folder. Some filters I made take messages to Trash. But sometimes I decide I want to keep some of them. In this moment I mark as not spam, the current folder is Trash, and it takes about 15 seconds to be moved from Trash to my Inbox folder.

It has nothing to do with this bug, but there is something even more annoying: links can not open firefox. I tried everything to force opening a new tab but thunderbird insists in creating a new firefox process, with is stoped with the message ""Firefox is already open... blablabla""",I have about  20 filters rules. Some of them take filtered messages to Trash,"Multiple partitions does not necessaarily have an effect on performance. But folders on a non-local disk may affeect performance.

Even on a fast system it may normally take 2-5 seconds, depending on the server, to ""unjunk"" a message. (including mine)

Let's narrow what we are talking about:
Q1 - How many messages in Inbox?
Q2 - How many messages in Trash?
Q2 - How many messages in Spam folder? 
Are any folders on non-local disk?","A1- 342
A2- 0
A2- 0
All my messages are in a different partition, same disk. Maybe this clue makes differece: My linux system is on ext3, and the Mail folders partition is NTFS","I gave up keeping my messages in a different disk. My previous intention was to share my thunderbird messages across Linux and Windows and it worked, despite de slowness. Once I passed the messages to the Linux home disk, all got fast again. I opened the bug because a symbolic link should mimic a local filesystem, but we saw that it creates a huge delay.
My doubt is if the blamed is the o.s, thunderbird or a both together when the mail folders are in a different disk.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1606100,Thunderbird 68.3.1 slowness issue,INVALID,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36

Steps to reproduce:

Tried to refresh the Thunderbird and composed the emails as well.


Actual results:

Thunderbird stop responding for 2-3 seconds and works again.


Expected results:

It shouldn't stuck and work smoothly.","Try starting Windows in safe mode, and in safe mode start Thunderbird also in safe mode (Help > restart with add-ons disabled)","(In reply to Wayne Mery (:wsmwk) from comment #1)
> Try starting Windows in safe mode, and in safe mode start Thunderbird also in safe mode (Help > restart with add-ons disabled)

Thank you. Let me try this and validate the issue again.",It's working fine in safe mode... ...,"(In reply to Ashish Kumar from comment #3)
> It's working fine in safe mode... ...

If it only is bad when Windows is started normal then the problem is a Thunderbird add-on.  Otherwise the problem is something that initializes during WIndows startup - typically AV.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1531385,Please allow filtering failed or empty downloads,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0

Steps to reproduce:

Over the course of a few days I usually download several images, videos, music, etc., but occasionally these will fail for various reasons or I’ll get a 0 Byte download. I’d like to see all failed or empty downloads in the Download Manager at once, so I can try downloading them again.


Actual results:

Currently I have to manually scroll through the list and watch for “Failed” or “0 B” or something similar. (Downloaded 404 pages are a related problem, but these can’t be caught trivially.)


Expected results:

The History Manager has sortable columns. Could the Download Manager use a sortable “file size” column, too? Or a state-button or checkbox to filter failed or empty downloads?","The Firefox download experience is not optimized for mass downloading, by design. For our expected use-case simply scrolling a short list of downloads is enough. Other browsers also don't provide search functionalities as well, so we are not below average expectations in that sense.
considered the added complication there's no current plan to add this feature, we may re-evaluate if and when the Library is moved in-content.","> we may re-evaluate if and when the Library is moved in-content

Alright. That’s what I expected.

> not optimized for mass downloading

I should have rephrased that… by “several” I meant “a couple of” — manually. The download list still reaches 50 to 100 downloads or so after about a week.

Anyway, maybe it’s really not worth it, since it would only optimize away half a minute each week. =)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1543238,[New Tab Page] Top Site custom thumbnails take time to load when history is cleared upon exit,WONTFIX,"Created attachment 9057085
Screencast from 09-04-19 21:08:39.webm

User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

1. Set Firefox to automatically clear history upon quitting.


Actual results:

After quitting Firefox, and reopening it, my top sites which have a custom thumbnail, take several seconds to load the thumbnail. This does not occur when:

1. Opening a new tab
2. Making Firefox retain history after quitting.


Expected results:

Custom thumbnails get loaded instantly, like the top sites which don't use custom thumbnails.","Created attachment 9057189
Screenshot 2019-04-10 at 10.27.03.png

It depends on the options you have set to clear on exit.
The custom images are downloaded and cached in your local profile. If `Cache` is checked as in the attached screenshot then the thumbnails get cleared and they will have to be downloaded again on startup.

The behavior is ""as expected"" even though the side effect of these options may not be that obvious there's not much we can do to work around it.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1544509,Google ad iframe not correctly load when we block fingerprinting domain voken.eyereturn.com,WONTFIX,"Affected versions:
68.0a1 (2019-04-15) (64-bit)

Affected platform:
Windows 10
Windows 7
Mac OS 10.14
Ubuntu 18.04

Steps to reproduce:
1.-Open the latest firefox nightly (https://nightly.mozilla.org)
2.-Download the latest flash beta version 
http://labs.adobe.com/downloads/flashplayer.html
3.-Open www.addictinggames.com and let the site finish loading

Expected result:
The google iframe on the lower center of the screen is correctly shown.

Actual Results:
The google iframe on the lower center of the screen is transparent.

Note: firefox has the same behaviour without blocked content. Google Chrome shows the iframe correctly

Regression-range: will try to find it asap.",Could you attach the screenshot?,"Created attachment 9058348
Screenshot_2019-04-15 Games - Free Online Games at Addicting Games.png","Hi, 

The issue is also reproducible in latest nightly on Ubuntu 18.04",Can you try to find a regression range? I don't see the frame at all on Linux.,"Hi,
     here is the link to the mozregression result. Please let me know if you need any other particular.

https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=98d4803bb2de7fcdb0096ddeedaefd29d0fd5fd4&tochange=3b08a133c893b960f15e014a8f36c954d31fda34

Regards
David","I see the ad if I disable tracking protection. I think this is working as expected, but I assume this is a regression from bug 1525458.

ni? Ehsan just to confirm, but I think this is INVALID as it is unless you also don't see the ad if you disable tracking protection.","This has nothing to do with bug 1525458.  It is caused by our fingerprinting blocking feature which is turned on in Nightly.

The page can get different ads in different reloads (at least here for me) but it seems that if the ad includes a resource from voken.eyereturn.com we block it and the ad doesn't show up.  We have the following in the console when this happens:

The resource at “https://voken.eyereturn.com/j4/js?7307986&click=http%3A%2F%2Finsight.adsrvr.org%2Ftrack%2Fclk%3Fimp%3Da13b6976-7de6-4b9e-b144-3d2d74cccbfd%26ag%3Dwt32g9w%26sfe%3Deef0218%26sig%3D3jHLRNHXOfNVtsmO6zo8ZGVKsq5BfsepdOwsEAS0ufE.%26crid%3D2j1vhy1z%26cf%3D681241%26fq%3D0%26td_s%3Dwww.addictinggames.com%26rcats%3D7sp%2C1m2%2Cod8%2Cc6q%2C8hs%2Cuh1%26mcat%3D%26mste%3D%26mfld%3D4%26mssi%3DNone%26mfsi%3Ddyr0m2o9wf%26sv%3Drubicon%26uhow%3D87%26agsa%3D%26rgco%3DCanada%26rgre%3DOntario%26rgme%3D%26rgci%3DToronto%26rgz%3DM6G%26dt%3DPC%26osf%3DWindows%26os%3DWindows10%26br%3DFirefox%26svpid%3D19700%26rlangs%3Den%26mlang%3D%26did%3D%26rcxt%3DOther%26tmpc%3D11.75%26vrtd%3D%26osi%3D%26osv%3D%26daid%3D%26dnr%3D0%26vpb%3D%26c%3DOAE.%26dur%3D%26crrelr%3D%26npt%3D%26svscid%3D225432%26mk%3DMozilla%26mdl%3DFirefox%2520-%2520Windows%26ipl%3D1109038%26ict%3DUnknown%26r%3D&params=682401” was blocked because content blocking is enabled.","Ehsan, this bug looks invalid to me. Do you have a different opinion?","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug is a regression, but please revert this change in case of error.",Ehsan - Can we close this one out as invalid?,"In what sense is this bug invalid, I'm not sure if I understand?  When I looked at the bug, if my recollection is right, we were blocking a fingerprinting domain and that was resulting in an ad on the site getting blocked in some cases.  Please note that our fingerprinting blocking feature isn't intended to be an ad blocker.

Whether or not we want to fix it is a different question.  :-)  Steven, do we have any evidence that this bug affects a lot of websites?  Do you have any thoughts here?","(In reply to :Ehsan Akhgari from comment #11)
> In what sense is this bug invalid, I'm not sure if I understand?  When I looked at the bug, if my recollection is right, we were blocking a fingerprinting domain and that was resulting in an ad on the site getting blocked in some cases.  Please note that our fingerprinting blocking feature isn't intended to be an ad blocker.
> 
> Whether or not we want to fix it is a different question.  :-)  Steven, do we have any evidence that this bug affects a lot of websites?  Do you have any thoughts here?

Hello Ehsan - We reviewed this bug during platform triage and were keying off Comment 8. Happy to keep it open - we were just trying to move it forward :)",During manual testing done by QA (Mozilla-only [doc](https://docs.google.com/spreadsheets/d/1hz7UUJZUR2Fq1o-9Yt3k13PhAtQzNwN4oXN0gNUjpQY/edit#gid=98779779)) we found that a total of 36 out of the 900 websites tested had missing advertisements. This count includes all domains currently on the fingerprinting blocklist. We determined this to be an acceptably low impact for the protection provided.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1546642,Disabling BITS service after finishing the update download process in the background while Firefox is closed triggers the update download to be restarted via nsIIncremental when opening Firefox again,WONTFIX,"**Affected versions**
* Firefox 68.0a1 (20190415213626)

**Affected platforms**
* Windows 10 x64
* Windows 7 x86

**Prerequisites:**
* Set app.update.BITS.enabled and app.update.log to true
* Use Netlimiter to set the Internet bandwidth limit to about 20kb/s.

**Steps to reproduce**
1. Launch Firefox.
2. Open the browser console and check if update download is started via BITS.
3. Close browser while the update download is in progress.
4. Wait for about 30 seconds for the download to finish in the background.
5. Disable and Stop BITS service.
6. Open Firefox and check the browser console.

Expected result
* Firefox update download is completed and the browser is attempting to stage the update. 

Actual result
* The update download gets restarted via nsIINcremental.

**Regression range**
* I don’t think this is a regression.


**Additional Notes**
* Attached a screen recording with the issue: [link](https://drive.google.com/open?id=1hcCnPXci6VVYf9iTMyhZ_aPKLbEZ6tXU)","This is actually the expected behavior. When a BITS download finishes transferring, it has not actually been ""completed"" yet. Firefox has to call the `complete()` method on the job for the job to be completed and saved to the disk.

Firefox does not see the competed download because there is none. It also does not see the BITS job, because BITS is not available. Therefore, falling back to an alternate download mechanism is the expected behavior.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1549231,Paste automatically downloads remote content,WONTFIX,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0

Steps to reproduce:

On Thunderbird 60.6.1 for MacOS.
First, I have the mail client set up to NOT download remote content.
I did a Select All and then a Copy on a message that had remote content that had not been downloaded.  Then I did a Paste into a new message.  (I also did Paste as Quotation and got the same results.)


Actual results:

Thunderbird pasted the contents of the original message that I had copied, and it included all the images that I had not yet downloaded.


Expected results:

I would expect either of two things.  1. the contents to paste as-is, or 2. a pop-up informing me that the clipboard contains remote content and offering me the opportunity to download that content or not.

I'm checking the Security button because if someone copied and pasted a message with malicious links, those links would be downloaded.","This is not a security issue, it's at best a privacy issue.

Stuff inserted into the compose window is typically displayed (and would therefore need to be fetched). No remote content is shown/fetched if you reply or forward.","What do you say, Magnus?",Agreed. I would be inclined not to do anything about this.,"I really should be able to paste without having the content automatically fetched, especially if my settings are not to automatically download remote content in the first place.  After all, what I copied is not what got pasted.

Isn't privacy a component of security?

Thanks,
Dave","> After all, what I copied is not what got pasted.

What do you mean?","Well, he copied an image with a remote source which wasn't display. The result of paste is the same image, but now it's shown.","Yes, that's right.  I copied a message without images and when I pasted, the images were retrieved.  The minor issue is that the images were pasted into the message, even though I hadn't technically copied the images -- just the links.  The major issue is that the mail client fetched those images without my consent, reporting back to the marketing company's server that I opened and read the message.","(In reply to Magnus Melin [:mkmelin] from comment #3)
> Agreed. I would be inclined not to do anything about this.

per comment",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1552776,"add on fix not working unable to dowload because of connection issues,...",WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0

Steps to reproduce:

tried to install the fix for the add on problem for firefox ESR 52.9.0 32bit xp


Actual results:

When you click on download is unable to download due to connection failure


Expected results:

shout have updated the add on issue",sorry it's for windows xp 32 bit sp2,"(In reply to del0012003 from comment #0)
> User Agent: Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0
> 
> Steps to reproduce:
> 
> tried to install the fix for the add on problem for firefox ESR 52.9.0 32bit xp
> 
> 
> Actual results:
> 
> When you click on download is unable to download due to connection failure
> 
> 
> Expected results:
> 
> shout have updated the add on issue

Could you please send me a link to the fix you installed, also the contents of about:support (there is a button to copy to clipboard so you can paste here), thanks!",(this bug will be closed in a week if there is no activity),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1553554,Firefox 67 thinks it's an old version and won't load my profile,WONTFIX,"Created attachment 9066781
compatibility.ini

User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0

Steps to reproduce:

On 2019-05-21 I updated my computer from Ubuntu 18.04 to 19.04. I'm not sure if Firefox was updated to Firefox 67 prior to my upgrade. I was not using any nightly or developer versions.


Actual results:

When loading Firefox an error window came up with the following text: 
> Using an older version of Firefox can corrupt bookmarks and browsing history already saved to an existing Firefox profile. To protect your information, create a new profile for this installation of Firefox.


Expected results:

Firefox should have loaded my profile without issue.",Just a comment that I was directed here from Reddit and told to upload the compatibility.ini file from the old profile.,"Just to check, are you using the Ubuntu provided version of Firefox or are you using one downloaded directly from Mozilla?","This was reported as an ubuntu bug: https://bugs.launchpad.net/firefox/+bug/1830096.

It seems unfortunate that firefox uses MOZ_BUILD_DATE as its build ID (if I followed correctly the code path, see https://hg.mozilla.org/mozilla-central/file/tip/build/variables.py#l15).

The official build from Mozilla might not be affected by that bug, but on Ubuntu we build firefox for each supported release (at present that's 16.04, 18.04, 18.10, 19.04 and the development series, 19.10), which means that the same package of firefox for two different Ubuntu releases will be getting different build IDs, and there's no way to guarantee that the build ID for release X will be < the build ID for release Y, where X < Y (other than building the packages sequentially, instead of in parallel).","I wonder whether setting MOZ_BUILDID to the Ubuntu package version string (e.g. ""67.0+build2-0ubuntu0.19.04.1"") when building would fix the problem, and wouldn't introduce undesirable side effects?","(In reply to Dave Townsend [:mossop] (he/him) from comment #2)
> Just to check, are you using the Ubuntu provided version of Firefox or are you using one downloaded directly from Mozilla?

I'm using the Ubuntu provided version, both before and after upgrading.","(In reply to Olivier Tilloy from comment #3)
> It seems unfortunate that firefox uses MOZ_BUILD_DATE as its build ID (if I followed correctly the code path, see https://hg.mozilla.org/mozilla-central/file/tip/build/variables.py#l15).

My apologies, I hadn't noticed that this was the case.

> The official build from Mozilla might not be affected by that bug, but on Ubuntu we build firefox for each supported release (at present that's 16.04, 18.04, 18.10, 19.04 and the development series, 19.10), which means that the same package of firefox for two different Ubuntu releases will be getting different build IDs, and there's no way to guarantee that the build ID for release X will be < the build ID for release Y, where X < Y (other than building the packages sequentially, instead of in parallel).

If the builds for each release are from the same source then I don't think it would be an issue for the Firefox build ID to match across those builds, though I also imagine that sharing profiles between different Ubuntu releases is going to be rare.

The chief thing that we care about is that if the Firefox code is newer then it should have a larger compatibility version than previously. The compatibility version is defined as `<version>_<appbuildid>/<platformbuildid>` (the latter two are the same in Mozilla builds). We compare as if the string is a valid toolkit version (https://developer.mozilla.org/en-US/docs/Mozilla/Toolkit_version_format), and to make that the case we do some special parsing in the case where the buildid is the expected number of characters that are generated from Mozilla builds, otherwise we just use the literal compatibility version for comparison.

I am not sure about other uses of the build ID in Firefox, but I think one viable option is just to set the build ID to your ""build2"". This would lead to a compatibility version like `67.0_build2/build2`. This would fall back to just interpreting that as a full version string which looks like it compares correctly:

```
""67.0_build1/build1"" < ""67.0_build2/build2""
""67.0_build3/build3"" > ""67.0_build2/build2""
""67.0_build3/build3"" < ""67.1_build2/build2""
""67.0.1_build1/build1"" < ""67.1_build2/build2""
""67.0.1_build1/build1"" > ""67.0_build2/build2""
```

What do you think of that?","(In reply to Dave Townsend [:mossop] (he/him) from comment #6)

> If the builds for each release are from the same source then I don't think it would be an issue for the Firefox build ID to match across those builds, though I also imagine that sharing profiles between different Ubuntu releases is going to be rare.

Indeed this wouldn't be an issue, rather a logical thing: two binary packages of the same version of firefox (sharing a single source package) have the same build ID.


> The chief thing that we care about is that if the Firefox code is newer then it should have a larger compatibility version than previously. The compatibility version is defined as `<version>_<appbuildid>/<platformbuildid>` (the latter two are the same in Mozilla builds). We compare as if the string is a valid toolkit version (https://developer.mozilla.org/en-US/docs/Mozilla/Toolkit_version_format), and to make that the case we do some special parsing in the case where the buildid is the expected number of characters that are generated from Mozilla builds, otherwise we just use the literal compatibility version for comparison.
> 
> I am not sure about other uses of the build ID in Firefox, but I think one viable option is just to set the build ID to your ""build2"". This would lead to a compatibility version like `67.0_build2/build2`.
> 
> […]
> 
> What do you think of that?

This makes sense to me, and sounds like it would work. Note that ""build2"" in that context comes from the upstream build candidate, it's not an Ubuntu-specific thing: https://ftp.mozilla.org/pub/firefox/candidates/67.0-candidates/.","I am testing this suggestion, and it appears to work as expected.
Would the following patch be acceptable?

    --- a/build/variables.py
    +++ b/build/variables.py
    @@ -13,10 +13,12 @@ SOURCESTAMP_FILENAME = 'sourcestamp.txt'
     
     
     def buildid_header(output):
    -    buildid = os.environ.get('MOZ_BUILD_DATE')
    -    if buildid and len(buildid) != 14:
    -        print('Ignoring invalid MOZ_BUILD_DATE: %s' % buildid, file=sys.stderr)
    -        buildid = None
    +    buildid = os.environ.get('MOZ_BUILDID')
    +    if buildid is None:
    +        buildid = os.environ.get('MOZ_BUILD_DATE')
    +        if buildid and len(buildid) != 14:
    +            print('Ignoring invalid MOZ_BUILD_DATE: %s' % buildid, file=sys.stderr)
    +            buildid = None
         if not buildid:
             buildid = datetime.now().strftime('%Y%m%d%H%M%S')
         output.write(""#define MOZ_BUILDID %s\n"" % buildid)

I.e. prioritize the `MOZ_BUILDID` environment variable over `MOZ_BUILD_DATE`, if it is set.","(In reply to Olivier Tilloy from comment #8)
> I am testing this suggestion, and it appears to work as expected.

Ok, so the patch looks ok to me, though it would really need a build config peer to look at it. But we've discovered another issue related to how we compare the compatibility versions in bug 1554029 so we are going to be making changes to that. I suspect that what we change will still work for the suggestion above but while I realise this is an important issue for you it might be worth holding off any changes on your end until there is an accepted patch there. I'm hoping to have something written today.","Fair enough, I'll hold off changes until bug 1554029 is fixed. Thanks Dave!","Ok so it looks like bug 1554029 has landed and stuck and will be rolling out in a 67.0.1 soon. During testing of that I found that the suggestion I made in comment 6 would have actually only worked on some platforms due to a bug in the version comparator code. It probably would have worked on Linux but now the code is fixed it that changes things a little.

If you care about your users being able to upgrade from a version with the old-style build ID (14 digits based on the date) then either you need to: 

1. Continue to use a purely numeric build ID that is larger each time you build (and the first must be larger than the last build ID your users have).

2. Switch to a build ID that can be parsed by the toolkit version code (https://developer.mozilla.org/en-US/docs/Mozilla/Toolkit_version_format) and must contain a character that is not a digit in it (or Firefox will just parse it as a number) and do the above.

For the second option in the first upgrade where users are switching from the old build ID to your new one the version comparator will consider the old build ID to be ""0"" because the number is too large and overflows. So for your new build ID to be larger than that then it has to be a valid version considered larger than or equal to 0. Mostly that means it must start with at least one digit so ""1build1"" would work (and then after ""1build2"" etc. would be considered larger.

It's a little uglier than I'd like unfortunately but it should work.",*** Bug 1557014 has been marked as a duplicate of this bug. ***,Based on this needing an ubuntu change at this point I'm going to close this out.,*** Bug 1555986 has been marked as a duplicate of this bug. ***,"I also experienced similar, but in my case I have my usual aarch64 client with /home on a NFS mount using ff67.
What happens is upon occasion mozilla apps (amongst others) from the server direct (using, for example, ssh -Y).

Firefox seems to change the LastOSABI  in compatibility to Linux_x64_86-gcc3 from Linux_aarch64-gcc3 whereupon
the next time I launch firefox from my habitual client I get the message (like above)
> Using an older version of Firefox can corrupt bookmarks and browsing history already saved to an existing Firefox profile. To protect your 
> information, create a new profile for this installation of Firefox.","Created attachment 9077386
Bug 1553554 - Allow overriding the default build ID with a MOZ_BUILDID environment variable.","Dave, I have submitted https://phabricator.services.mozilla.com/D37722 for review, I hope you and other build config experts can comment.

I have tested this with Ubuntu packages, setting the build ID to e.g. ""build3"". Your suggestion of prefixing the build ID with a number (i.e. 1build3) doesn't seem necessary if we ensure that this change becomes effective only in a new version of firefox, because the build ID won't matter in the version comparison, e.g. from 68.0_20190701120911/20190701120911 to 68.0.1_build1/build1.

Or am I missing a use case?","(In reply to Olivier Tilloy from comment #17)
> Dave, I have submitted https://phabricator.services.mozilla.com/D37722 for review, I hope you and other build config experts can comment.
> 
> I have tested this with Ubuntu packages, setting the build ID to e.g. ""build3"". Your suggestion of prefixing the build ID with a number (i.e. 1build3) doesn't seem necessary if we ensure that this change becomes effective only in a new version of firefox, because the build ID won't matter in the version comparison, e.g. from 68.0_20190701120911/20190701120911 to 68.0.1_build1/build1.
> 
> Or am I missing a use case?

Ah yes, you are right. As long as for a single ""version"" you use the same build id style you should be fine.","I'm confused at to why a MOZ_BUILDID ""override"" is necessary for you, and why the build date is a problem in the first place.","Created attachment 9078090
Bug 1553554 - Minor syntactic change (use ""not"" instead of ""is None"").

Depends on D37722",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1563293,Firefox should not Reload Focused Page upon Crashing when Restore Previous Session is Disabled,WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0

Steps to reproduce:

Tested on both Windows 7 and 10 X64.

Currently, even when I have the ""Restore previous session"" checkbox unchecked and Firefox restarts abnormally, the last page that I was on is still loaded the next time that the browser starts. This has the potential to cause a privacy/security risk; the browser appears to use any previously-saved cookies for that session. This shouldn't happen when explicitly unchecking the previously-mentioned option from within the Options page.

To reproduce:

1. Ensure that the ""Restore previous session"" checkbox is unchecked from within the Options dialog

2. In a standard (i.e. non-Private Browsing) tab, open any URL

3. Now, kill the firefox.exe process and restart the browser as you normally would

Expected: Considering that the ""Restore previous session"" checkbox has been unchecked, the user should be presented with their default homepage (I should also note that I have my setting for both new tabs and my homepage set to ""Blank"")


Actual results:

See above


Expected results:

See above","The priority flag is not set for this bug.
:mikedeboer, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","Hi elliotabarnes, thanks for filing this bug!

I don't quite understand the privacy concern here, but regardless, a crash is an unexpected interruption for the majority of our users and in the vast majority of cases a restored session upon restart will yield a sigh of relief to learn that no work was lost by the crash.
At this point we don't intend to change this behavior.","I understand that from a user perspective, this may behaviour may be preferred. From a security perspective, however, the concern would be that due to the way that Firefox handles crashes in this way, session information is written to disk and in the event that a user's volume isn't encrypted and a machine is physically taken before the user has re-opened the browser, this information would be readily accessible. Would somebody be able to confirm whether encryption of any kind is performed on this session information?","If your machine is physically taken without any other protection (system password, disk encryption, etc), then you've other things to worry about than just an accessible session store, like all documents you've ever created, photos, your wedding ring research materials, etc.
There's is no privacy sensitive information to be found in the sessionstore cache file other than your open windows, tabs, their URLs and navigation history. No passwords. Active logins to, for example, your bank portal are likely to have expired in this scenario, but sure, there is a small window of risk there. But again, your entire hard drive full of more valuable treasure is open for any thief to be plundered.","Of course - and I totally understand that it's down to a user to ensure that all of their data (not just Firefox browsing history!) is secure - that's their choice. However, if a user has explicitly unchecked ""Restore previous session"" from within Options, this would suggest that they know what they're doing; the average user who simply uses the browser without modifying anything would arguably have left this at the default. In this case, should we not take this as confirmation that a user doesn't want their session reloaded upon a crash, and stop recording session data if this is unchecked?","(In reply to elliottabarnes from comment #5)
> Of course - and I totally understand that it's down to a user to ensure that all of their data (not just Firefox browsing history!) is secure - that's their choice. However, if a user has explicitly unchecked ""Restore previous session"" from within Options, this would suggest that they know what they're doing; the average user who simply uses the browser without modifying anything would arguably have left this at the default. In this case, should we not take this as confirmation that a user doesn't want their session reloaded upon a crash, and stop recording session data if this is unchecked?

Sure, it's a double-edged sword. I do think it's good to optimize for the generally expected behavior, which is to restore after crash.
So perhaps we should add a bit of messaging to about:preferences to highlight that crashes are exempt from the 'Restore previous session' option?",Sure - this would have definitely made things a lot clearer to me if I'd seen this text when I disabled the option. :) I think that this is a good compromise.,Filed bug 1570591 to track that enhancement.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1566666,Using #nav-bar{ display: none; } in userChrome.css causes pages to never load,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

I added the entry:

`#nav-bar{ display: none; }'

to my userChrome.css


Actual results:

After the update to Firefox 68, all pages fail to load.



Expected results:

Pages should load normally and never display the nav-bar.
Pages still load normally and don't display the nav-bar if the nav-bar is set to be autohidden. However, this means that often the autohidden nav bar is awkwardly displayed when one is trying to click on links near the top of the page.

Thus, the desired result of pages loading and hidden nav-bar could be achieved by allowing users to set a delay for the nav-bar to be unhidden, perhaps a few seconds.","""Don't do that.""

We're not going to make this work. Supporting it, rewriting and/or complicating existing, working code to do so, and adding test coverage and having to take it into account when it could break, etc. etc. - that ends up being a significant engineering cost, with no upshot for 99.9999% of users.",*** Bug 1576896 has been marked as a duplicate of this bug. ***,"Someone on the enterprise list reported this and they said:

I also found, shortly after sending the question, that setting

user_pref(""browser.urlbar.quantumbar"", false); 

Lets thing work as before, at least until I learn the ins and outs of quantumbar 🙂

I'll investigate other solutions.","(In reply to Mike Kaply [:mkaply] from comment #3)
> Someone on the enterprise list reported this and they said:
> 
> I also found, shortly after sending the question, that setting
> 
> user_pref(""browser.urlbar.quantumbar"", false); 
> 
> Lets thing work as before, at least until I learn the ins and outs of quantumbar 🙂
> 
> I'll investigate other solutions.

Wow, thanks a lot Mike, it seems to work on our side. We'll test further things but that's a huge help already !

Cheers",*** Bug 1657294 has been marked as a duplicate of this bug. ***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1570162,browser.download.dir should be readable by add-ons,WONTFIX,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

I want to read browser.download.dir from an add-on's background page.


Actual results:

browser.download.dir is visible in about:config, but add-ons cannot read this value.


Expected results:

It would be useful if add-ons could read browser.download.dir","(In reply to hans_squared from comment #0)
> It would be useful if add-ons could read browser.download.dir

How would it be useful? In general, we prefer not to give access to filesystem details that they can easily do without.","I want to write an add-on that does the following:
When the user downloads a file, its URL is automatically saved in a sidecar file.
https://en.wikipedia.org/wiki/Sidecar_file

I realize that I'm supposed to do this with Native Messaging.

But the user has to set up the native app, and maybe install a scripting language first.
I wanted a simpler way, so the user can test the add-on immediately.

If the user saves the file in the default downloads directory, or one of its subdirectories, it's possible without Native Messaging.
And if the add-on knows the default downloads directory, it's trivial to implement.

I'll just let the user set the default downloads directory in the add-on's options.","As Kris said, we do generally not provide access to the filesystem without a good reason.

In this case, the use case is to figure out the location of the download.
This information is already available in the downloads API: The full path to the filename is available in the ""filename"" property,
see https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads/DownloadItem
and https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1579670,Loading local file from local file results in CORS error,WONTFIX,"Created attachment 9091268
xhr.html

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36

Steps to reproduce:

1. load attached file
2. create a textfile called foo.txt and place it in the same directory as the attached html file
3. notice a CORS error


Actual results:

Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at file:///C:/Users/ruudp/Downloads/foo.txt. (Reason: CORS request not http).


Expected results:

The html file is loaded from local file system. It loads a text file also located on the local file system. There is not cross-site request. The text file on the local file system should be loaded as it is located on the same origin (local file system) as the requesting html file.

Chrome has the same bug: https://bugs.chromium.org/p/chromium/issues/detail?id=990606#c2

I understand CORS enables secure cross-site requests. But I believe in this case the security settings are too stringent. Furthermore, it disables development of certain products.",Allowing this led to exploits such as https://www.mozilla.org/en-US/security/advisories/mfsa2019-21/#CVE-2019-11730,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1590916,Automatically download and install dictionaries for languages available on the system,WONTFIX,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0

Steps to reproduce:

Automatically download and install dictionaries for languages available on the system

This will help with the Thunderbird flatpak version
Automatically download and install dictionaries for languages available on the system
https://github.com/flathub/org.mozilla.Thunderbird/issues/90#issuecomment-544394095

Similar to how Thunderbird automatically downloads and installs multi-language UI
https://bugzilla.mozilla.org/show_bug.cgi?id=1590206


Actual results:

Dictionaries for languages available on the system not automatically available


Expected results:

Dictionaries for languages available on the system automatically available","Given that Firefox doesn't have this functionality, I wouldn't expect this to exist in Thunderbird any time soon either. I mean, I don't even think we provide dictionaries in general except for en-US? They're community maintained, with various levels of maintenance, and sometimes there's more than one for a given language, and also some for things that aren't languages(medical terms, etc).","This is somewhere between invalid and wontfix. I was under the impression that some language packs also contained a dictionary, but that was wishful thinking.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1592347,Library downloads window doesn't display progress inside taskbar,WONTFIX,"Created attachment 9104962
Taskbar Screenshot.PNG

User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0

Steps to reproduce:

1. Download any files with an open tab
2. Notice progress bar inside windows taskbar
3. Open library (downloads)
4. Close any tabs except the library
5. Notice no progress bar for the library window


Actual results:

The downloads library window doesn't have a progress bar indicator in the Windows taskbar like a normal tab does. This makes it inconvenient to check for download progress, since I'm required to maximize the library window or open a normal tab.


Expected results:

The library (downloads) window should display a progress bar inside the Windows task bar.","The long term plan is to move the Library in-content, thus it's not worth spending time on this.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1593592,code evaluation is resumed on page reload after breakpoint is hit,WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0

Steps to reproduce:

hit a breakpoint and reload the page


Actual results:

when a breakpoint is hit and you then reload the page, the breakpoint is released and the code is allowed to continue to run. This is weird behavior. You might have a bug behind the breakpoint and you are trying to hinder that from running. Maybe it is a bug that creates an endless loop. In that case you will fall in that loop even if you have a breakpoint and then reload the page. Because firefox then continues code evaluation and gets stuck in the loop. 



Expected results:

I do think that if you have halted the code evaluation and then reload the page, firefox should NOT try to resume running the code. Just don't start it again, and reload the page.","Jim, I'm curious what you think? If we did want to immediately bail, I believe we have the functionality...","If I'm reading right, the original poster is saying that we continue execution *in the old code*. That is highly weird behavior, and definitely should not be possible. That data should be in the BF cache, and should be completely frozen.

Certainly we can have the server return `null` (terminate) as the `Debugger` handler's resumption value, and kill the page that way. That's what I would have expected to happen.","We explicitly resume execution explicitly at https://searchfox.org/mozilla-central/rev/8b7aa8af652f87d39349067a5bc9c0256bf6dedc/devtools/server/actors/thread.js#1779 on page navigation, so this seems like expected behavior to me.

Without a debugger, do we block navigation on any already-executing JS jobs? If so, I'm not sure cancelling on navigate from a breakpoint seems better to me than resuming and letting the JS run to completion. Cancelling the currently-executing JS is viable in some circumstances, and does happen right now, but only in the explicit case of the debugger being closed, rather than on page navigation (which is weird and tracked in https://bugzilla.mozilla.org/show_bug.cgi?id=1571637). 

> Maybe it is a bug that creates an endless loop. In that case you will fall in that loop even if you have a breakpoint and then reload the page. Because firefox then continues code evaluation and gets stuck in the loop.

Is that something that other browsers resolve? It seems like in an ideal world there'd be some eventual timeout if navigation takes too long due to a long-running task, but it doesn't seem like behavior the debugger itself should define, to me.","So, do I understand this correctly?
If you have stopped execution on a breakpoint; maybe resolved the problem that you had in the code ( by examining the state at the breakpoint ) and then reload the page to execute the new/fresh source code, the browser should still continue execution of the old/faulty code first?

Why?

It you wanted that,  wouldn't you just resume execution first, before reloading. It seems to me that if the code is halted then it should stay halted until explicitly started. 

Am I missing something?

/m","> the browser should still continue execution of the old/faulty code first?

And what if the code wasn't faulty and you were simply using the debugger to inspect the behavior of something before refreshing? Say for example you're freshing the page expecting the code from the previous page to have finished, setting some state that persists across refreshes, like setting a value in localstorage or a cookie? Cancelling execution of the code would then cause your application to behave erroneously.

> It you wanted that, wouldn't you just resume execution first, before reloading. It seems to me that if the code is halted then it should stay halted until explicitly started.

I'd pose the same ""Why?"" question back to you. Why should the presence of the debugger cause the JS to evaluate differently on page navigation? The debugger is a means to inspect the runtime behavior of code. While you can use that to manipulate the variables, you can't manipulate the code itself, and that's what cancelling execution of the currently-paused JS would accomplish.","I do see your point. It's logical. And I thank you for pointing that out to me. 

But still. There is an issue here. We have two use cases and we try to merge them into one. When that happens to me I usually try to find a third way. 

Say that you are debugging and find some critical flaw. Maybe if the code continues running you will corrupt the localstore or something like that.  Then it would be very useful to be able to bail.

You can reload from the browser and you can also reload from the debugger(F5). 
Maybe if you reload from the browser you get the default behavior, but if you reload from the debugger you say ""don't continue executing from here, reload and start again""?

/m","> Why should the presence of the debugger cause the JS to evaluate differently on page navigation?

Yeah, contrary to what I said above, Logan's argument makes sense to me. Interrupting evaluation isn't something that can happen except under unusual circumstances (the slow script dialog), so it would be weird if ordinary use of the debugger caused it to happen.

I assume the navigation is delayed until the current JS task completes?","The priority flag is not set for this bug.
:jlast, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1599812,"The ""Download Mobile Browser"" card is still displayed on the first opened tab after logging in the Firefox Mobile browser",WONTFIX,"Created attachment 9111996
Mobile_card_not_replaced.gif

[Affected Platforms]:
- All Windows
- All Mac
- All Linux

[Affected Versions]:
- Firefox Nightly 72.0a1, Build ID 20191126093448

[Prerequisites]:
- The trailhead.firstrun.branches pref is set to ""join-dynamic"".
- Firefox is installed on a mobile device.

[Steps to reproduce]:
1. Open the browser with the profile from prerequisites and click the ""Sign in to Sync"" button.
2. Complete the sign-up process with a new email address.
3. Open a new tab and click the ""Sign Up for Alerts"" button.
4. Click the ""Sign In"" and ""Continue"" buttons.
5. Open a new tab.
6. Log in with the same email address on Firefox mobile.
7. Open a new tab on the desktop browser and observe the behavior.

[Expected result]:
- The ""Download Mobile Browser"" card is replaced with another card.

[Actual result]:
- The ""Download Mobile Browser"" card remains displayed.

[Notes]:
- Opening a second new tab causes the ""Manage Your Logins"" card to appear correctly.
- The behavior is also reproducible using the ""full_page_d-dynamic"" branch.
- This issue is not reproducible if the ""about:newtab"" page is refreshed or if the ""Download Mobile Browser"" button is clicked.
- I have attached a screen recording of the issue:",Can you add this as a known issue and de-prioritize the bug if we consider this high effort / low impact?,Updated tech plan with Mobile Card targeting conditions change reflected on opening second tab or refresh as known issue https://docs.google.com/document/d/1sP-kHacof7uReBJCaZwYYPzF2it-Q2ZWG9BYPnCrMJY/edit#heading=h.kfs658tvf5pk,Resending back to triage,Closing as we no longer have triplets on new tab,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1605960,Plug-in startup child process dll load path order,WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36
Firefox for Android

Steps to reproduce:

I wrote a firefox plugin and started a child process on the plugin. When the child process starts, the default search path for dll is not the current path first, but C: \\ WINDOWS \\ SYSTEM32; C: \\ WINDOWS; The current path. Then, my plugin started child process failed.


Actual results:

my plugin started child process failed,The reason is that C: \\ WINDOWS \\ SYSTEM32; C: \\ WINDOWS; There is a file with the same name as the dll that my child process depends on, such as: C: \\ WINDOWS \\ SYSTEM32 \\ content.dll. When my child process loads this dll, it reports an exception, because this is not the dll it really wants. As a result, the child process cannot start normally.


Expected results:

This may not be a bug, but it is normal for my plugin to run on chrome or ie, because on both browsers, the default path to search for dlls is the path where the current child process exe exists. I want to know if there is a way to modify the default search dll path to the path where the current child process exe exists.","The priority flag is not set for this bug.
:jld, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","Assuming this is about Native Messaging, this probably isn't IPC; WebExtensions have their own mechanism for launching child processes.  I'll try WebExtensions : Untriaged, but this might also be Toolkit : Async Tooling, which owns `Subprocess.jsm`.","Along the same lines as comment 2, assuming this is about loading a DLL into a native messaging EXE, the executable should be in full control of what whee and how it loads, including setting any path variables, or even spawning a new executable with a desired environment.

If on the other hand we misinterpreted the bug, feel free to reopen and provide further details.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1606642,the amount of the history.VisitItem don't increase when you reload the page,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0

Steps to reproduce:

I'm developing an extension

1. visit certain page
2. using browser.history.getVisits() to get the amount of the visitItems
3. and then, reload the page, using browser.history.getVisits() to get the amount of the visitItems again





Actual results:

you will find that the amount don't change


Expected results:

the amount of the visitItems of the HistoryItem should increase by 1 when you reload the page each time.","Hi,

Thanks for submitting this bug to us! I've set a component so that the development team reviews this issue since I'm not able to use  browser.history.getVisits() 

Can you please confirm this happens visiting any website and not a specific one?  Does it also occur in the latest Nightly version? You can download it  from here: https://nightly.mozilla.org/ Thanks!

Clara","@tcstory@163.com can you please provide the extension you are creating so we can try to reproduce the issue on our end?

I am also changing the component to Webextensions since it seems to be more related to Addons.

Thanks!

Clara","this problem will happen in any page and in Nightly version.

here is my extension: https://github.com/tcstory/time-tracker

clone it into your computer and run the following commands:

1. npm install
2. npm run build

the outputed files will be placed in a named `build` directory.

when you load the extension, you should enter the dashboard page(for example moz-extension://1cf1ee9b-0ef4-b443-bb0d-fb0b1cc99f56/dashboard.html).

each time you reload the dashboard page, it will call the getPageVisits of the history service, the history service is placed in `src/services`,  you can place your code in the `getPageVisits` method","for me, I will place the code `console.log(historyItem.url, visitItems);` in the line 85 bellow of the `src/services/history.ts`.

After my observation, I found that if you wait for a while before you reload the page, the amount will increase, but I'm not sure how long to wait","@tcstory

I was able to reproduce the issue using FF 72.0.1 on Windows 10x64 so I will change the bug to New from Unconfirmed, waiting for triage.

Thanks, 
Victor","The priority flag is not set for this bug.
:jimm, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","This behavior is expected. The `history` API provides a view of the history as known by Firefox, and the history count does not increase upon reload.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1606802,Security exception for preloaded HSTS certificate not working after untrusting CA,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

Steps to reproduce:

I have deleted all default certificates by compiling libnssckbi.so with an empty lib/ckfw/builtins/certdata.txt. This was necessary because there are many rogue certificates among these. If I visit now a site I can acknowledge individual site certificates one by one. Unfortunately this does not work for all sites. It does not work for mail.dotplex.com, for amazon.com and similar site like google.com or qwant.com.


Actual results:

I get the error SEC_ERROR_UNKNOWN_ISSUER. As far as good; I can add the required CAs with certutil. For SEC_ERROR_UNKNOWN_ISSUER it should suffice to add with -t ""c,,"" as we do not want to trust these certification authorities. They could be rogue CAs. However if I add with ""c,,"" I still get SEC_ERROR_UNKNOWN_ISSUER while adding with ""C,,"" does not give that error. However adding the CA as trusted CA is worthless because then Firefox accepts all certs from this CA without warning. 


Expected results:

This is a bug. SEC_ERROR_UNKNOWN_ISSUER says that the issuer is unknown and not that the issuer must be a trusted one. Please make Firefox search all issuer CAs, also untrusted ones or allow to ignore this error message by allowing to manually accept these certificates.","`SEC_ERROR_UNKNOWN_ISSUER` is the error Firefox uses to indicate that no trusted issuer could be found, which is the situation you're describing, as far as I can tell (the algorithm can't differentiate between ""the trust bits were removed from this certificate"" and ""there exists a path to a trusted certificate, but it requires an intermediate certificate we're not aware of"").

That said, what you're describing is not a supported configuration of Firefox. Accepting each site's certificate one-by-one is not secure (how do you know a network attacker hasn't intercepted your connection and replaced the real certificates with their own?)","I use DANE to acknowledge individual certificates and on a secure computer I only visit a restricted number of sites.
This is an error. Please fix.",It is a shame that Mozilla compromises the security of those who need it most! Comparing the sha256 hash and accepting user picked certificates is currently the only way to be secure with Firefox.,It should be possible to add a manual security exception for HSTS (HTTP Strict Transport Security) sites as is possible for any other site in the web. Manually acknowledged sites are most trustworthy since it is the user on his own who has acknowledged access rights. You are  not forbidden to visit a site hosted via pure http either. It is scorn to the ordinary user that something which pretends to provide elevated security does actually compromise the security of users who care the most about it.,This is not an invalid report. Please reopen quickly!,"If you want to trust individual server certificates, you should be able to do so using certutil as you've described in comment 0.

Again, though, what you're describing is not a supported way to operate Firefox. We have a limited amount of engineering resources, and this is not something we're going to spend time on.","You can add user certificates with certutil -t ""P,,"" to the database and they will be displayed correctly as trusted server certificates. However when you try to connect to such a site you get a warning as if these certificates would not be present at all. Fortunately this is a non-fatal bug and you can accept these peer certificates manually after comparing the sha256 hash of these certs. It is different with HSTS certificates: You can currently neither add a user exception for them nor add the required CAs in untrusted mode to the database. If you do currently not have the resources to fix this bug please mark as WONTFIX, and not as resolved invalid. I would lovingly like to try to approach a fix on my own but unfortunately I do not have the resources to do so at the moment. My computers are currently under heavy attack and I have already had to wrack two operating system installations.","First off, there are no ""HSTS certificates"" but there is a ""Strict-Transport-Security"" aka ""HSTS"" HTTP header. What you are probably running into is section 8.4 of RFC 6797 that states:

8.4.  Errors in Secure Transport Establishment

   When connecting to a Known HSTS Host, the UA MUST terminate the
   connection (see also Section 12 (""User Agent Implementation Advice""))
   if there are any errors, whether ""warning"" or ""fatal"" or any other
   error level, with the underlying secure transport.  For example, this
   includes any errors found in certificate validity checking that UAs
   employ, such as via Certificate Revocation Lists (CRLs) [RFC5280], or
   via the Online Certificate Status Protocol (OCSP) [RFC2560], as well
   as via TLS server identity checking [RFC6125].

However, I cannot trigger the behaviour described in comment 7 using Firefox 72.0.1. 

I created https://self-signed.vdberg.org/ which has a certificate signed by my untrusted Test CA. I also created https://hsts-test.vdberg.org/ which additionally sends a Strict-Transport-Security HTTP header. For both sites Firefox displays ""Warning: Potential Security Risk Ahead"" and after selecting ""Advanced"" the ""Error code: SEC_ERROR_UNKNOWN_ISSUER"" you mentioned. In both cases I can still select ""Accept the Risk and Continue"" option and Firefox will create an exception for the site.","I was able to reproduce the scenario in comment 7 after all. It has to do with preloaded HSTS certificates, see https://hstspreload.org/

For example: gmail.com is an HSTS preloaded certificate that is signed by ""GlobalSign Root CA - R2"". 

To reproduce the issue:

1) In about:preferences#privacy -> View Certificates -> Authorities -> GlobalSign Root CA - R2 -> Edit Trust -> Uncheck ""This certificate can identify websites.""
2) Visit https://gmail.com/
3) Firefox now displays ""Did Not Connect: Potential Security Issue"" and the ""Advanced"" section has no ""Accept the Risk and Continue"" option
4) In about:preferences#privacy -> View Certificates -> Servers -> Add Exception -> Enter https://gmail.com/ as Location -> Get Certicate -> Confirm Security Exception
5) Visit https://gmail.com/
6) Firefox still displays ""Did Not Connect: Potential Security Issue""

The bug here is that for preloaded HSTS certificates the user has to trust the CA to be able to visit the site. Only trusting the server certificate should be enough though.","Created attachment 9121778
Bug_1606802-fix1.patch

This bug boils down to a narrow interpretation of section 12.1 of RFC 6797. This states ""the user should not be presented with a dialog giving her the option to proceed"". Nowhere does the RFC state or imply that a manually added and approved server certificate should not be allowed.

I've attached a patch that allows the site to be visited in such situation. If the root CA is not trusted and no server certificate has been added and manually approved by the user RFC 6797 is respected and no ""Add Exception"" option is being offered.","Created attachment 9121781
Bug 1606802 - Honor manual server certificate exceptions for HSTS and HPKP sites","Created attachment 9121783
Bug 1606802 - Honor manual server certificate exceptions for HSTS and HPKP sites

Currently if a server has HSTS preloading or HPKP enabled and the user
untrusts the CA the site cannot be visited. Visiting such server should 
still be possible if the user manually adds an exception for the server
certificate.","The priority flag is not set for this bug.
:keeler, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","The way to explicitly manually trust a server certificate when you don't trust the CA is to use `certutil` as described in comment 0 (as I've already said in comment 6). The certificate error exception mechanism is not the way to do what you want, and attachment 9121783 removes an important security check in our implementation.

Again, removing the trust settings from the certificate authorities shipped with Firefox is not a supported mode of operation. This is not a bug in Firefox. Please do not reopen this bug.","If Google Chrome implements it the way that you can manually acknowledge HSTS certificates I ask you why Firefox can´t? You know yourself that this so called ""security feature"" does in deed compromise security. Please do also not mark as invalid as the originally stated bug - as you have said by your own - is still unresolved.","Richard, can you use your test environment and try setting the about:config pref `network.stricttransportsecurity.preloadlist` to false?

For me, if I set GlobalSign Root CA R2 to not be trusted, then set `network.stricttransportsecurity.preloadlist` to false, I can still click-through and trust individual preloaded-HSTS sites at `.google` (e.g., https://about.google) issued through that root.","Using Firefox 75 I am no longer able to remove the trust of a builtin CA. I can edit the trust bits in the GUI, remove the entire cert using the GUI or certutil. Doesn't matter though, it gets added right back and I can still visit sites with a trust chain to that CA. 

What version of FF are you testing with and how do you remove the trust bits?","If you un-check the websites trust bit for the CA you want to distrust, clear your cache, and visit a website that uses that CA, what is the chain of certificates you see when you click the site identity icon (lock), click the right arrow, click ""more information"", and click ""view certificate""?","Thanks, I was missing that empty cache step. I now see the behaviour jcj describes. With `network.stricttransportsecurity.preloadlist` set to false I can click through, add a security exception and visit the site. This makes sense because in this situation no site qualifies as HSTS preloaded (because the list is not loaded). 

IMHO this is not a valid workaround for this bug. In order to be able distrust a single CA (which seems to be non-permanent in FF 75) you need to give up the HSTS preload list for *all* CA's.","After playing around with certutil some more I was able to make a permanent adjustment in the trust of a builtin CA by using:
```
certutil -d /path/to/profile.default -M -t 'c,c,c' -n ""name of CA""
```
Changes made to builtin CA's in the GUI are reset upon restart. 
Changes made to builtin CA's using `certutil` survive a restart. 
Builtin CA's deleted by either the GUI or `certutil` are readded upon restart.",Changes to the trust bits of certificates in the built-in module should persist in the cert9.db file in your profile. Are your profile and that file writable?,"Yes, I am running both FF and `certutil` under the same user account. The timestamp of cert9.db is updated when I change the trust bits in the FF GUI. `certutil -L` shows they are not changed though, they always display as ',,' which seems to be the default.","Are there any errors in the browser console (tools -> web developer -> browser console)?
Also, which ""security device"" is the certificate you're trying to change on? (second column in the authorities tab of the certificate manager)","(In reply to Richard van den Berg from comment #19)
> Thanks, I was missing that empty cache step. I now see the behaviour jcj describes. With `network.stricttransportsecurity.preloadlist` set to false I can click through, add a security exception and visit the site. This makes sense because in this situation no site qualifies as HSTS preloaded (because the list is not loaded). 

OK, thanks, just making sure this code path is doing the things we all think it's doing.
 
> Changes made to builtin CA's in the GUI are reset upon restart. 
> Changes made to builtin CA's using `certutil` survive a restart. 
> Builtin CA's deleted by either the GUI or `certutil` are readded upon restart.

Editing the trust bits from the UI should persist. It does for me, in two profiles. The ""delete"" mechanism likely causes the edits to the trust bits to be lost, but I haven't confirmed that. Built-in roots can't be deleted, despite what the UI shows, so one should only ever edit the trust bits on built-ins.

> IMHO this is not a valid workaround for this bug. In order to be able distrust a single CA (which seems to be non-permanent in FF 75) you need to give up the HSTS preload list for *all* CA's.

I understand that this isn't a good workaround, but despite the concreteness of your patch, I was still a little confused as to the exact scenario here. Now I am not confused, and I believe I know how to make this do what you're asking, but it's a bit more plumbing than your existing patch:

 `AuthCertificateParseResults` would need to receive a boolean like `isDirectlyTrusted` coming from whether `builtCertChain` is longer than one entry in `SSLServerCertVerificationJob::Run`, and then plumb that boolean down to the `OverrideAllowedForHost` method and let it skip the pin checks when set.

However, even with the above plumbing and a suitable test, I do not expect we would approve such a patch. Per Elmar's request earlier, I agree this is a valid ask, although I imagine we can all admit this is a narrow use-case. I am changing this to WONTFIX, and I'm sorry to disappoint you. I dislike making such calls, but maintenance burden is real -- and a substantial concern, particularly with security-critical code like PSM.","Regarding the trust bit persistence: this seems to be an issue with my profile. With a new profile it works as expected. In my profile I get this error after an edit:
```
Component returned failure code: 0x805a1f65 [nsIX509CertDB.setCertTrust] editcacert.js:53
    onDialogAccept chrome://pippki/content/editcacert.js:53
    _fireButtonEvent chrome://global/content/elements/dialog.js:529
    _doButtonCommand chrome://global/content/elements/dialog.js:508
    _handleButtonCommand chrome://global/content/elements/dialog.js:502
    _handleButtonCommand self-hosted:875
    editCerts chrome://pippki/content/certManager.js:335
    oncommand chrome://pippki/content/certManager.xhtml:1
```
Regarding the WONTFIX: I understand your reasoning although I think it is a shame that this is the final outcome. This bug effectively prohibits an end user to manually distrust a builtin CA. Chrome and Safari have this implemented correctly. I was hoping Mozilla would value end user empowerment in this regard.","There should be a ""distrust all"" button to distrust all default CAs and only add known good ones. This would be the way to go because removing every single known-bad CA is undoable or at least ineffective in practice.","I have just set network.stricttransportsecurity.preloadlist=false with Firefox 102.12.0 but was denied access due to HSTS for a certain site with no option to accept the certificate, although I had reloaded it with Ctrl-Shift-R","The following patch is waiting for review from reviewers who are inactive or resigned from the review:

| ID  | Title |  Author | Reviewer Status |
| --- | :---- |  ------ | :-------------- |
| [D60382](https://phabricator.services.mozilla.com/D60382) |  Bug 1606802 - Honor manual server certificate exceptions for HSTS and HPKP sites | [richard](https://bugzilla.mozilla.org/user_profile?user_id=41300)  |[jcj](https://phabricator.services.mozilla.com/p/jcj/): Resigned from review |
| | | |[kjacobs](https://phabricator.services.mozilla.com/p/kjacobs/): Resigned from review |


:richard, could you please find another reviewer or abandon the patch if it is no longer relevant?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#inactive_reviewer.py).","(In reply to Elmar Stellnberger from comment #27)
> I have just set network.stricttransportsecurity.preloadlist=false with Firefox 102.12.0 but was denied access due to HSTS for a certain site with no option to accept the certificate, although I had reloaded it with Ctrl-Shift-R

You'll have to clear the saved HSTS information (Ctrl-Shift-R doesn't clear that, I believe). Try `History` -> `Clear Recent History` -> `Cache`.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1607201,Dialogs do not appear for places.xhtml library loaded in a tab,WONTFIX,"STR:
1. Go to `chrome://browser/content/places/places.xhtml`.
2. Create a new bookmark folder.

Expected:

Dialog appears requesting name of folder.

Actual:

No dialog, console error:

    [Exception... ""Illegal value""  nsresult: ""0x80070057 (NS_ERROR_ILLEGAL_VALUE)""  location: ""JS frame :: resource:///modules/PlacesUIUtils.jsm :: showBookmarkDialog :: line 328""  data: no]

Regression window:
https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=89b9b3aa3aafb413060c61e381723c0788c07848&tochange=19c33f741d779768f53eed13e5c0f45e0363f537

Regressed by Bug 1553804.

User reports:
https://www.reddit.com/r/firefox/comments/ebwnul/adding_deleting_bookmark_folders_moving_a/
https://www.reddit.com/r/firefox/comments/ebf5pj/bug_in_latest_firefox_prevents_creation_of_folders/


Also affected:
`chrome://browser/content/places/bookmarksSidebar.xhtml`
`chrome://browser/content/places/historySidebar.xhtml` (eg Bookmark Page from context menu)","Hi :kmag, bug 1553804 regressed this. Care to take a look? Thank you.","As far as I know, this document is not meant to be loaded in a tab. The only UI for opening it opens it in a dialog, in which case it works just fine. If it's meant to also support being opened in a tab, then it's a Places bug.","This is a wontfix, because it's not an intended behavior. We still plan to move the Library to an in-content UI long term, see bug 697359.",*** Bug 1616946 has been marked as a duplicate of this bug. ***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1616791,Add-ons sideloaded outside the profile folder are not copied over to the profile folder,WONTFIX,"Created attachment 9127796
add-ons are not copied to the profile folder.png

[Affected versions]:
- Firefox 73.0/20200207195153
- Firefox 74.0b5/20200218224219
- Firefox 75.0a1/20200219215002
[Affected platforms]:
- Windows 10 Pro 64-bit
- macOS Catalina 10.15
- Ubuntu 16.04 LTS

[Prerequisites]:

A
1. Sideload add-ons in all outside the profile locations on an older version of the browser (for example 72.0b11 and/or 73.0a1)
2. Launch the browser and check that the add-on has been successfully sideloaded (the add-on will be installed, present in Add-ons Manager and disabled)
3. Update the browser to the latest version

B
1. Sideload add-ons in all outside the profile locations on the latest release version (73.0)

[Steps to reproduce]:

A
1. Launch the browser
2. Access the Add-ons Manager page (type about:addons in the URL bar)
3. Go to the Extensions tab
4. Notice that the previously sideloaded add-ons (prior to the update) are installed and disabled
5. Access about:profiles and navigate to the currently in use profiles
6. Open the profile folder and check the “extensions” folder
7. Observe that the “extensions” folder is empty i.e. the add-ons sideloaded in the outside the profile locations were not copied to the profile after the update

B
1. Launch the browser
2. Access the Add-ons Manager page (type about:addons in the URL bar)
3. Go to the Extensions tab
4. Notice that the previously sideloaded add-ons are installed and disabled
5. Access about:profiles and navigate to the currently in use profiles
6. Open the profile folder and check the “extensions” folder
6. Observe that the “extensions” folder is empty i.e. the add-ons sideloaded in the outside the profile locations were not copied to the profile

[Description]:
According to https://docs.google.com/document/d/1s7V9olIjZ9VsYVBE10JxLBm71SURcBV2Y1vFt2dbt8E/edit , for the span of the 73 release cycle, Firefox will continue reading sideloaded files, but they will be copied over to the user’s individual profile and then installed as regular add-ons.

Add-ons sideloaded in outside the profile locations on older FX versions or on the current release version, are not copied over to the profile folder.

[Expected results]:
Add-ons sideloaded in outisde the profile locations should be copied over to the profile folder as mentioned in the above document.

[Actual results]:
Add-ons sideloaded in outside the profile locations are not copied over to the profile folder.","That documentation should have been updated.  The reason for the copy in the initial design was to allow for the user to remove the addon.  However, that was possible to implement without doing the copy, so we dropped that approach.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1624560,add pause and resume button for downloads,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:74.0) Gecko/20100101 Firefox/74.0

Steps to reproduce:

try to download a file, then try to pause and then resume download


Actual results:

you can see there is no chance for pause and resume cause there is no button for it


Expected results:

just add buttons resume and pause and make sure they working well","*Pause* is in the context menu for each download item. Once paused, the *Resume* button is next to the download item, replacing the Cancel button.","This was done on purpose because the pause/resume actions are not widely used, so they were moved to the secondary ui.
There's no evidence those facts changed in the meanwhile.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1629660,"Cannot use ""No Style"" to avoid page loading animations",WONTFIX,"User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:75.0) Gecko/20100101 Firefox/75.0

Steps to reproduce:

I followed a link to this page (safety warning, contains animation):

https://degenesis.com/downloads/books/


Actual results:

1. The page fired painful animation as it loaded, and more on mouseover.

2. I tried to use No Style. I opened a new tab, pasted the url, selected Page Style > No Style, and entered. It loaded with its preferred style and pain/animation.

3. (Also) I also tried to use No Style to block zoom on mouseover, but that did not work either.


Expected results:

Since users can get sick from page loading animation, users should have a way to load without animation, rather than have to go through the animation before they can apply options to block the animation.","If it is possible to create a preference to pre-run any page loading animations, and only show the effects after all elements have completed their animations, that would be a useful enhancement and should also resolve the bug.","[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug should belong to this component, but please revert this change in case of error.","The main animations here (i.e. all except for some color animations) appear to be JS-based so I don't know there's much the user agent can do here. That's also the reason No Style doesn't work.

If they were CSS animations, CSS transitions, or Web Animations we could add controls to disable them (we've talked about doing so in the past) but unless that's the case I'm not sure how much we can do. If it's a common enough case we could add heuristics similar to what we have for active layers, but that's quite involved.

In any case, since this is isn't related to declarative animation, I'm moving this back to Untriaged (DOM: Animation is purely for declarative animation).",Resetting severity to default of  `--`.,"Hi,

I will move this over to a component so developers can take a look over it, once 'No Style' is select, the animations remain, but this happens across platforms and browsers, so I'm not sure there's a solution for this as per comment#3. 

Thanks for the report.


Best regards, Clara.","I am afraid there isn't anything that we can do here to help. The only route would be disabling all CSS and all JS, but that would also stop many websites from working that don't have any animations. You may have better luck reaching out to the specific website and asking if they can reduce their animations.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1632333,The fix from Bug 1595652 only works for the first load,WONTFIX,"Created attachment 9142586
E3tfjc9ZpS.mp4

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0

Steps to reproduce:

1) Install the test add-on
2) Click on the icon



Actual results:

It will load the first page as expected. But if you navigate, then it will get blocked by the XFO.


Expected results:

Should also work for navigations.","Created attachment 9142587
manifest.zip","We're not going to automatically lift the X-Frame-Options restrictions for extensions. You'll have to use the webRequest.onHeadersReceived API to remove the header (but make sure to check the details, including `originUrl` to make sure that you're only removing the XFO header for requests from your extension.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1693302,[snap] Cannot open containing folder from a downloaded item if the default path is changed,WONTFIX,"Created attachment 9203705
download

*Affected versions*
* 86.0 (20210215141125)
* 85.0.2 (20210216094005)
* 78.8.0esr (20210217034806)

*Preconditions*
* Download the build from the archive and run  `snap install --dangerous target.snap` 

*Affected platforms*
* Ubuntu 18.04

*Steps to reproduce*
1. Open Firefox and change the default download folder from about:preferences.
2. Download a random file [e.g](https://www.thinkbroadband.com/download). 
3. Click on Open containing folder from downloads pane.


*Expected result*
* Folder is opened as expected.

*Actual result*
* The folder is not opened.

*Regression range*
* I will search for one ASAP.

*Notes*
* Attached a screen recording.
* I tried on another ubuntu 18.04 machine and the issue is not reproducing. Maybe is something related to my station.","Hello! I tried searching for a regression range on my Ubuntu machine and these are the results:
- latest good build is Firefox snap 75.0b11 -> This build opens the folder with the downloaded file as expected
- first bad build is Firefox snap 76.0b1 -> This build opens a Launch Application window instead of the folder containing the downloaded file even when the default download folder is kept.
I made a [pushlog](https://hg.mozilla.org/releases/mozilla-beta/pushloghtml?fromchange=c8d69165e663b8c6e8074ac01151ab4d9c3a5fd2&tochange=b4ef8571957b03316302e9dd21979a0d2612f648) between these two...

This are the results between the bad build wich is opening Launch Application window and the build that is not opening anything when another download folder is set:
- 77.0b4 snap build ->  opens a Launch Application window as well even when is default downloads folder kept
- 77.0b5 snap build -> opens the default download folder as expected but does not open anything when the default download folder is changed as described in comment 0.
Pushlog: [link](https://hg.mozilla.org/releases/mozilla-beta/pushloghtml?fromchange=f2f4bb3f05ec9b0eb185d5825b46874c8730f6b4&tochange=0561052e38b299b6d7b18141d65ed6a32f152a8d)",Can we detect that attempting to reveal an `nsIFile` will be blocked by flatpak/snap? Is there some way to convince it to allow this to happen?,*** Bug 1756817 has been marked as a duplicate of this bug. ***,There was another bug about not being able to use `Open file in folder` and it was just missing feature under snap. Can you verify https://bugzilla.mozilla.org/show_bug.cgi?id=1772063 ? It's likely a dupe.,"Created attachment 9303268
vokoscreen-2022-11-14_10-10-48.gif

(In reply to Alexandre LISSY :gerard-majax from comment #4)
> There was another bug about not being able to use `Open file in folder` and it was just missing feature under snap. Can you verify https://bugzilla.mozilla.org/show_bug.cgi?id=1772063 ? It's likely a dupe.

We tried these steps again on two Ubuntu 18.04 machines and we can still reproduce this issue with Firefox 107.0RC2. Attaching a screen recording as well.","(In reply to Alexandru Trif, QA [:atrif] from comment #5)
> Created attachment 9303268
> vokoscreen-2022-11-14_10-10-48.gif
> 
> (In reply to Alexandre LISSY :gerard-majax from comment #4)
> > There was another bug about not being able to use `Open file in folder` and it was just missing feature under snap. Can you verify https://bugzilla.mozilla.org/show_bug.cgi?id=1772063 ? It's likely a dupe.
> 
> We tried these steps again on two Ubuntu 18.04 machines and we can still reproduce this issue with Firefox 107.0RC2. Attaching a screen recording as well.

Can you try on 22.04 pleaase ?","Created attachment 9303285
image.png

(In reply to Alexandre LISSY :gerard-majax from comment #6)
> (In reply to Alexandru Trif, QA [:atrif] from comment #5)
> > Created attachment 9303268
> > vokoscreen-2022-11-14_10-10-48.gif
> > 
> > (In reply to Alexandre LISSY :gerard-majax from comment #4)
> > > There was another bug about not being able to use `Open file in folder` and it was just missing feature under snap. Can you verify https://bugzilla.mozilla.org/show_bug.cgi?id=1772063 ? It's likely a dupe.
> > 
> > We tried these steps again on two Ubuntu 18.04 machines and we can still reproduce this issue with Firefox 107.0RC2. Attaching a screen recording as well.
> 
> Can you try on 22.04 pleaase ?

Sure. I cannot reproduce the issue on Ubuntu 22.04. One thing worth mentioning is that on Ubuntu 22.04 the downloads folder path is correctly displayed. On ubuntu 18 there is some strange download path displayed. Please see the attached screenshot.","(In reply to Alexandru Trif, QA [:atrif] from comment #5)
> Created attachment 9303268
> vokoscreen-2022-11-14_10-10-48.gif
> 
> (In reply to Alexandre LISSY :gerard-majax from comment #4)
> > There was another bug about not being able to use `Open file in folder` and it was just missing feature under snap. Can you verify https://bugzilla.mozilla.org/show_bug.cgi?id=1772063 ? It's likely a dupe.
> 
> We tried these steps again on two Ubuntu 18.04 machines and we can still reproduce this issue with Firefox 107.0RC2. Attaching a screen recording as well.

Can you share an actual video? It's going way too fast and there's no way to pause ... Please do the recording on a 22.04, and please verify on a brand new setup as well.","Created attachment 9305795
vokoscreen-2022-11-29_15-53-00.mkv

(In reply to Alexandre LISSY :gerard-majax from comment #8)
> Can you share an actual video? It's going way too fast and there's no way to pause ... Please do the recording on a 22.04, and please verify on a brand new setup as well.

Hello! I cannot reproduce the issue on Ubuntu 22.04. I have made a new screen recording on my Ubuntu 18.04 station starting with a new profile and then changing the download folder. Hope it helps. If more information is needed please let me know. Thank you!","(In reply to Alexandru Trif, QA [:atrif] from comment #9)
> Created attachment 9305795
> vokoscreen-2022-11-29_15-53-00.mkv
> 
> (In reply to Alexandre LISSY :gerard-majax from comment #8)
> > Can you share an actual video? It's going way too fast and there's no way to pause ... Please do the recording on a 22.04, and please verify on a brand new setup as well.
> 
> Hello! I cannot reproduce the issue on Ubuntu 22.04. I have made a new screen recording on my Ubuntu 18.04 station starting with a new profile and then changing the download folder. Hope it helps. If more information is needed please let me know. Thank you!

I'm a bit worried you are not able to reproduce anymore, this would suggest it was indeed fixed on 22.04. Can you confirm that ?",FTR Opening in folder was fixed in bug 1772063,"I've been told the situation should have been fixed on 18.04 as well: https://bugs.launchpad.net/ubuntu/+source/xdg-desktop-portal/+bug/1978295

Can you verify if everything is correctly uptodate? And if it's the case, then I guess we should file a bug upstream and link it from there to backport what is missing.","(In reply to Alexandre LISSY :gerard-majax from comment #12)
> I've been told the situation should have been fixed on 18.04 as well: https://bugs.launchpad.net/ubuntu/+source/xdg-desktop-portal/+bug/1978295
> 
> Can you verify if everything is correctly uptodate? And if it's the case, then I guess we should file a bug upstream and link it from there to backport what is missing.

I updated Ubuntu and tried again with 108.0b9 snap on my main Ubuntu profile and the issue still occurs. 
I created a new Ubuntu profile and tried with 108.0b9 snap and I cannot reproduce the issue there. The folder is correctly opened from Firefox after the download directory is changed. Also, the correct path is displayed inside about:preferences > Downloads > Save files to section.
Maybe it's something with my main Ubuntu profile, but unfortunately, I don't know what.","(In reply to Alexandru Trif, QA [:atrif] from comment #13)
> (In reply to Alexandre LISSY :gerard-majax from comment #12)
> > I've been told the situation should have been fixed on 18.04 as well: https://bugs.launchpad.net/ubuntu/+source/xdg-desktop-portal/+bug/1978295
> > 
> > Can you verify if everything is correctly uptodate? And if it's the case, then I guess we should file a bug upstream and link it from there to backport what is missing.
> 
> I updated Ubuntu and tried again with 108.0b9 snap on my main Ubuntu profile and the issue still occurs. 
> I created a new Ubuntu profile and tried with 108.0b9 snap and I cannot reproduce the issue there. The folder is correctly opened from Firefox after the download directory is changed. Also, the correct path is displayed inside about:preferences > Downloads > Save files to section.
> Maybe it's something with my main Ubuntu profile, but unfortunately, I don't know what.

`about:support` on both profile, we should be able to diff ?","(In reply to Alexandre LISSY :gerard-majax from comment #14)
> (In reply to Alexandru Trif, QA [:atrif] from comment #13)
> > (In reply to Alexandre LISSY :gerard-majax from comment #12)
> > > I've been told the situation should have been fixed on 18.04 as well: https://bugs.launchpad.net/ubuntu/+source/xdg-desktop-portal/+bug/1978295
> > > 
> > > Can you verify if everything is correctly uptodate? And if it's the case, then I guess we should file a bug upstream and link it from there to backport what is missing.
> > 
> > I updated Ubuntu and tried again with 108.0b9 snap on my main Ubuntu profile and the issue still occurs. 
> > I created a new Ubuntu profile and tried with 108.0b9 snap and I cannot reproduce the issue there. The folder is correctly opened from Firefox after the download directory is changed. Also, the correct path is displayed inside about:preferences > Downloads > Save files to section.
> > Maybe it's something with my main Ubuntu profile, but unfortunately, I don't know what.
> 
> `about:support` on both profile, we should be able to diff ?

Oh... sorry... I mistakenly opened Firefox 108.0b9 which came installed default with Ubuntu 18... and with that version, it seems that the issue is not reproducible... Sorry for the confusion here.

I can still reproduce the issue with Firefox 108.0b9 Snap installed with `sudo snap install firefox --channel=beta`  command on the newly created Ubuntu profile as well. If more information is needed please let me know. Thank you!","Sorry but this is just adding confusion. You confirmed the issue does not reproduce without snap, and it still reproduces with snap on ubuntu 18.04. So according to my comment 12, you should file an upstream issue so the missing bits are backported (I dont know which ones).",Have you filed an upstream issue ?,"(In reply to Alexandre LISSY :gerard-majax from comment #17)
> Have you filed an upstream issue ?

Unfortunately no, I can still reproduce the issue on Ubuntu 18.04 with Firefox 112.0b2 snap, but unfortunately, I still don't know how to file the issue. If you could provide me with some guidance on how to do this it would be great. Thank you!","(In reply to Alexandru Trif, QA [:atrif] from comment #18)
> (In reply to Alexandre LISSY :gerard-majax from comment #17)
> > Have you filed an upstream issue ?
> 
> Unfortunately no, I can still reproduce the issue on Ubuntu 18.04 with Firefox 112.0b2 snap, but unfortunately, I still don't know how to file the issue. If you could provide me with some guidance on how to do this it would be great. Thank you!

Bouncing needinfo back to Alexandre. :-)","(In reply to Alexandru Trif, QA [:atrif] from comment #18)
> (In reply to Alexandre LISSY :gerard-majax from comment #17)
> > Have you filed an upstream issue ?
> 
> Unfortunately no, I can still reproduce the issue on Ubuntu 18.04 with Firefox 112.0b2 snap, but unfortunately, I still don't know how to file the issue. If you could provide me with some guidance on how to do this it would be great. Thank you!

You need to file an issue on Launchpad https://launchpad.net/ against the Firefox package.","(In reply to Alexandre LISSY :gerard-majax from comment #20)
> (In reply to Alexandru Trif, QA [:atrif] from comment #18)
> > (In reply to Alexandre LISSY :gerard-majax from comment #17)
> > > Have you filed an upstream issue ?
> > 
> > Unfortunately no, I can still reproduce the issue on Ubuntu 18.04 with Firefox 112.0b2 snap, but unfortunately, I still don't know how to file the issue. If you could provide me with some guidance on how to do this it would be great. Thank you!
> 
> You need to file an issue on Launchpad https://launchpad.net/ against the Firefox package.

I hope this helps https://bugs.launchpad.net/ubuntu/+source/firefox/+bug/2011708/","Amin, can you check what is missing to backport to 18.04 and whether this is fixable ?","After discussing with Canonical folks, 18.04 is EOL so this cannot be fixed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1713637,Spellcheck items not available the first time a context menu is opened in a reloaded frame,WONTFIX,"Created attachment 9224321
Gif showing the issue

**Affected versions**
* Firefox 89.0
* Latest Nightly 90.0a1

**Affected platforms**
* Windows 10 64bit
* MacOS 11.3
* Ubuntu 18.04

**Steps to reproduce**
1. Start Firefox
2. Visit https://www.w3schools.com/html/tryit.asp?filename=tryhtml_elem_textarea
3. Right click inside textarea
4. Enable Check Spelling (if not already enabled)
5. Right click inside textarea again
6. Select This Frame and Reload Frame
7. Right click inside the textarea again

**Expected result**
* The same labels are displayed inside contextmenu 

**Actual result**
* Check Spelling and Languages are missing from contextmenu also the left padding used by the checkmark icon is missing as well from both contextmenus.

**Regression range**
* This is not a regression, it also reproduces in the first Nightly where `browser.proton.contextmenus.enabled` pref was first available in about:config (in bug 1698132)

**Additional notes**
* If dismissing the faulty contextmenu and enabling it again, it will be displayed as expected.

**Suggested severity**
* Since this is fixed if context menu is reopened and not sure who many users will run into this I would say it should have an S3 severity since the issue is about missing labels.","Can you still reproduce if you wait 5 seconds after using ""Reload Frame"", before reopening the context menu on the multiline text field?

I suspect this is just a race condition to do with when spellcheck is initialized.

>     This is not a regression, it also reproduces in the first Nightly where browser.proton.contextmenus.enabled pref was first available in about:config (in bug 1698132)

What about non-proton? I expect this reproduces in non-proton, and it should be possible to check if it's a regression pre-proton, or if it's been broken in this way for a long time.","Yeah, this is also reproducible without proton enabled, and yes waiting a few seconds (3 or so) after reload does indeed make the spellcheck options appear but only if I first focus the frame.
If I focus the textarea with left click and then bring up the context will make the spellcheck appear but if I right click inside the textarea without focusing it before, will not display it. (with or without proton) 

Digging a bit more with mozregression I found out that using Nightly from 2018-04-02 is not affected by this issue and 2018-04-03 is. Here is the pushlog between 2018-04-03 and 2018-04-02: https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=445255800255bb13ed096b5b7da36aa835e41dd8&tochange=00bdc9451be6557ccce1492b9b966d4435615380","This was last changed by bug 1448200 (reproducing similar behavior as non-e10s). Initializing the spell checker without any prior interaction will most likely cause performance issues since the vast majority of inputs and textareas are never interacted with.

As such, I'm going to close this bug as 'wontfix'.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1502918,The download button shows no progress status when located inside the Overflow Menu,WONTFIX,"Created attachment 9020796
screencast issue .gif

[Affected versions]: 
- 63.0 (20181018182531)
- 64.0b4 (20181025233934)
- 65.0a1 (20181029100347)

[Affected platforms]:
- Windows 10 x64
- Ubuntu 18.04 x64
- macOS 10.13

[Steps to reproduce]:
1. Go to https://www.ubuntu.com/download/desktop/thank-you?country=EU&version=16.04.2&architecture=amd64 and accept to download the file
2 Observe how the download icon is changing it's color according to the downloading progress
3. Right-click on the download icon and choose the Pin to Overflow Menu option
4. Enter the Overflow Menu and observe the download icon 

[Expected result]:
- The user should be able to still see the downloading progress, without taking another action.

[Actual result]:
- There is no color changing or notification, user can’t tell if any download is in progress.

[Regression range]: 
- This behavior is not a regression.","Due to the complexities of the overflow panel this becomes very hard to implement as you have requested. Clicking on the ""Downloads"" item within the overflow menu actually closes the overflow panel and opens the downloads panel since the downloads panel is so complicated already.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1571730,Autoplay drop down is shifted if opened before the content blocking information is loaded,WONTFIX,"Created attachment 9083351
shiftblockauto.gif

- [Affected versions]:
Nightly 70.0a1
Fx 68.0
Fx 69.0b11

- [Affected platforms]:
MacOS 10.12
Windows 10x64
Ubuntu 18.4

 - [Steps to reproduce]:
1. Launch Firefox with block autoplay enabled
2. Go to https://www.youtube.com
3. Click to open any video in a new tab
4. Click on the autoplay crossover icon
5. Open the autoplay drop down options
6. Wait a second for the content blocking information to load
7. Observe the autoplay dropdown

 - [Expected]:
Autoplay drop downs should not shift when other site information is loaded

 - [Actual Results]:
Autoplay drop down is shifted if opened before the content blocking information is loaded

 - [Note]: Issue is reproducible when autoplay dropdown is opened before the site content blocking is loaded

 - Regression: Not a regression, issue seen on the old autoplay implemented in Fx 66","Created attachment 9083352
blockautoplayWin.png",This is not applicable in Nightly anymore because the content blocking section got moved to a different panel and it's basically impossible to fix for any other release.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1685969,"[UX] - Sign in to account, clears password and might cause confusion until next-page loads",WONTFIX,"Created attachment 9196331
Screen Recording 2021-01-11 at 10.13.07.mov

* after input of user+password for Firefox; pressing the Sign In button clears the "" ****** "" from the password box, users might think it's invalid and try to re-input the password;
Main reason for why this might be an issue is that, with slower connections it might take more than 1 second for the sign-in to go through.

**Affected versions**
* 85.0b6, 86.0a1(2020-01-06);

**Affected platforms**
* macOS11, Windows 10;

**Steps to reproduce**
1. Launch Firefox, access https://accounts.firefox.com
2. Input a valid account, click next;
3. Input a valid password;
4. Click on the Sign In button;

**Expected result**
* user is signed in;

**Actual result**
* password section is cleared, might cause confusion as it is empty; user is signed in without any issue though;

**Regression range**
* can check and provide one if needed, most likely not a regression;

**Additional notes**
* attached recording to illustrate the issue.","Thank you for filing this issue. This is not currently on our roadmap, and in an effort to focus our work, we are closing old issues that we are unlikely to be closed in the future. Thanks again.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1728511,"Bookmarks reloaded in about:support when pressing the Enumerate database, Verify Integrity buttons",WONTFIX,"Created attachment 9238845
bmrk.gif

**Affected versions**
* 93.0a1( 	20210829215733)

**Affected platforms**
* Win10 (did not check on others at this time);

**Steps to reproduce**
1. Launch Firefox and access about:support;
2. Scroll down and click on buttons: Enumerate database, Verify Integrity.

**Expected result**
* in page action, browser not affected otherwise;

**Actual result**
* some links bookmarked on bookmarks bar are reloaded

**Additional notes**
* attached recording with the issue;
* poked QA team for further investigation.","Hm, I don't know how unexpected this is as it's probably touching everything in the Places database, which the toolbar here relies upon. In addition, about:support is a troubleshooting page and behavior like this could be expected or acceptable. As such, I'm going to close this bug as wontfix.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1778021,Download pdf from google search page,WONTFIX,"Created attachment 9284066
ateca.JPG

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0

Steps to reproduce:

good evening
I have just upgraded to firefox 102, and I have noticed something that didn't happen before, first it was blocked with the downloads, after restarting, what happens now is that if I search in google for example, 
""seat ateca pdf"", it shows links that contain pdf's, I select the link with the right mouse button, ""save link as"" and it only saves as html, when before I could ""save as"" and the pdf would download.
if I click on the link, it allows me to download the pdf.
is the problem that it is not showing ""save as"" but ""save link as""?
I think the latest version had some change about this?
in the download settings I have
application/pdf open in firefox
application/json save file




Actual results:

only shows saves html, not the pdf in google search


Expected results:

download the pdf file with save as","The [Bugbug](https://github.com/mozilla/bugbug/) bot thinks this bug should belong to the 'Firefox::File Handling' component, and is moving the bug to that component. Please correct in case you think the bot is wrong.","I guess that's a side effect of privacy efforts. The link in the search results of Google has NEVER been a direct link.
It's always been a link first going through Google for their tracking, like `https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=abc&uact=1&ved=2AhCXKwj9AKAHAOa4AhXf_qQKf__dCH8__noECAoQAQ&url=https%3A%2F%2Fwww.seat.com%2Fcontent%2Fdam%2Fpublic%2Fseat-website%2Fmyco%2F2130%2Fcar-shopping-tools%2Fbrochure-download%2Fbrochures%2Fnew-ateca%2Fcars-models-brochure-newateca-ago-2020.pdf&usg=AxxXxw1xXXxxw0x-0Au__8__X_n_`","I hadn't updated firefox for a time... I don't remember what version I had before... 1xx, but until this 102, it worked for me
If I do the same thing in chrome, for example, if it downloads the pdf file, 
I have also tested that if I go to the link and go back with the browser, sometimes the download also works, at that moment","I went back to Firefox 75.0 and the behavior there is the same as on the latest Firefox. I confirm that on Chrome you can download it as a pdf.
I'm not sure about the expected behavior but it makes sense to download it directly as a pdf.
Reproducible on macOS 11.6, Windows 10 x64 and on Ubuntu 20.04 x64.","(In reply to Hani Yacoub from comment #4)
> I went back to Firefox 75.0 and the behavior there is the same as on the latest Firefox. I confirm that on Chrome you can download it as a pdf.
> I'm not sure about the expected behavior but it makes sense to download it directly as a pdf.
> Reproducible on macOS 11.6, Windows 10 x64 and on Ubuntu 20.04 x64.

really?
wow... this already unsettles me, I'm sure I've downloaded pdf's in the way I indicate and it works in chrome (I hope I didn't dream it)
anyway if at some point I could make it behave like in other browsers it would be nice

thanks","This is because google is treating Firefox differently from Chrome.

In Firefox, there is a `mousedown` event listener on the link, which changes the link content from the correct link to the PDF to a redirect URL as illustrated in comment #2.
If the redirect was a ""real"" http redirect (302 or 301 or w/e) then this would be OK and we'd find the PDF. But it's not; it's an HTML page that needs to be rendered in order to find the javascript and `meta` tag that does the redirect. So we have no idea that that is going to redirect, and we just download the HTML page.

In Chrome, that `mousedown` listener is completely absent, so the link stays the same and the browser is able to download the PDF because the website gives it the right PDF link to download.

Chrome uses a `ping` attribute to do tracking, which Firefox does not support by default for privacy reasons. Presumably this is why Google felt the need to have this interstitial redirect for Firefox, but not Chrome.


Over to web compat because this is ultimately an issue with google serving us suboptimal markup, and fixing it in downloads code would only be possible if we started reading the contents of the file we just downloaded, and then deciding to remove that file again and download something else instead!",Removing release tracking flags because we can't fix this inside Firefox.,"(In reply to :Gijs (he/him) from comment #6)
> This is because google is treating Firefox differently from Chrome.
> 
> In Firefox, there is a `mousedown` event listener on the link, which changes the link content from the correct link to the PDF to a redirect URL as illustrated in comment #2.
> If the redirect was a ""real"" http redirect (302 or 301 or w/e) then this would be OK and we'd find the PDF. But it's not; it's an HTML page that needs to be rendered in order to find the javascript and `meta` tag that does the redirect. So we have no idea that that is going to redirect, and we just download the HTML page.
> 
> In Chrome, that `mousedown` listener is completely absent, so the link stays the same and the browser is able to download the PDF because the website gives it the right PDF link to download.
> 
> Chrome uses a `ping` attribute to do tracking, which Firefox does not support by default for privacy reasons. Presumably this is why Google felt the need to have this interstitial redirect for Firefox, but not Chrome.
> 
> 
> Over to web compat because this is ultimately an issue with google serving us suboptimal markup, and fixing it in downloads code would only be possible if we started reading the contents of the file we just downloaded, and then deciding to remove that file again and download something else instead!

ok I understand.
I have tried something else, if I search ""seat ateca pdf"", click on the first result, in the same window, it loads the pdf, and then, I go back to the search page, if then on the link, I click save link as, then if it downloads it as pdf (that is if you enter the link and go back if it downloads, if you don't enter and save then no)
Is it related to your explanation?","Closing as wontfix based on Gijs comment.
> Removing release tracking flags because we can't fix this inside Firefox.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1347315,Colour mismatch between icons of nav-bar and download panel,WONTFIX,"Created attachment 8847312
Colour mismatch.gif

User Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0
Build ID: 20170313004011

Steps to reproduce:

Reproducible in 2017-03-14 Nightly and DevEd on Windows.

1) Open download panel.
2) Compare the colours of 'Open Containing Folder,' 'Retry,' 'Cancel' etc. icons with the icons in the nav-bar / hamburger menu.


Actual results:

Icons in navbar are #4c4c4c, while those in download panel are #000000.


Expected results:

Both should be #4c4c4c.

A trivial `.downloadButton > .button-box > .button-icon { fill: #4c4c4c; }` fixes the issue.",chrome://browser/skin/panel-icons.svg#folder,"Inside the panel, we use colors provided by the operating system's theme.

The User Experience team is in the process of redesigning the main toolbar, and this will likely make things more consistent. We don't plan to change the colors inside the Downloads Panel at the moment.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1359105,Reload of an empty tab shows ghost search box,WONTFIX,"User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0
Build ID: 20170414022702

Steps to reproduce:

1. Configure browser.tabs.closeWindowWithLastTab=false
2. Configure home to Show Blank Page
2. Restart
3. Browse a little bit and close all tabs
4. On the single and empty tab hit Ctrl-r to reload
5. Centered search box will be visible for a split second


Actual results:

Instead of no visible change in the empty tab being reloaded, for a split second we are shown the search box.


Expected results:

Reload should have been a NOP or at least not result in a ghost search box flashing by.","STR:
1. Configure new tab page options to Show Blank Page.
2. Press Ctrl-r or F5 key to reload this page. You can hold down the key to load repeatedly for see the ghost search box incessancy.","Hello!
This bug has been closed due to inactivity and/or the potential for this bug to no longer be an issue with the new Discovery Stream-powered New Tab experience.
Please help us triage by reopening if this issue still persists and should be addressed.
Thanks!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1590069,usocial.pro social media buttons are missing when fingerprinting blocking or TP is enabled,WONTFIX,"Created attachment 9102928
2019-10-21143016.jpg

[Steps to reproduce]

1. Go to about:preferences#privacy and from the Custom section uncheck all the boxes except for ""Fingerprinters""
2. Navigate to https://www.ucoz.ru/all/

[Expected result]

Social media buttons should not be blocked

[Actual result]

Social media buttons disappear when Fingerprinters are set to be blocked",This is due to us blocking the embed script from `usocial.pro`. Specifically `https://usocial.pro/usocial/usocial.js?js=1.7.0`.,"The fingerprinting code is present in `https://usocial.pro/usocial/fingerprint2.min.js`. However, blocking this script appears to block the load of the social buttons.",We've decided to accept this breakage.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1590078,Mobials.com reviews app is missing on http://haldimandmotors.com/ when fingerprinting blocking or TP are enabled,WONTFIX,"Created attachment 9102937
reviews missing.png

**Affected versions**
* Firefox 71.a01
* Firefox 70.0
* Firefox 69.0

**Affected platforms**
* Windows 10 x64

**Prerequisites**
* Make sure that the Fingerprinters are blocked in about:preferences#privacy.

**Steps to reproduce**
1. Go to http://haldimandmotors.com/.
2. Click on the ""Reviews"" button or scroll down until you reach that section.

**Expected result**
* The Reviews section is displayed. 

**Actual result**
* The Reviews section is missing.

**Regression range**
* This is not a regression.","Created attachment 9102938
reviews displayed.png

If Tracking Protection is disabled this is how the section is displayed.","This is caused by us blocking `mobials.com`. Specifically:
* `https://mobials.com/app/business/reviews?id=5&language=en`
* `https://mobials.com/app/business/reviews?id=5&language=en`","According to [Disconnect's review](https://github.com/disconnectme/disconnect-tracking-protection/blob/master/descriptions.md#mobials) to fingerprinting script is served from `https://cdn.moba.mobials.com/v1/moba.min.js`. This script is not present on the test page above, and it doesn't show up in a [publicwww search](https://publicwww.com/websites/%22moba.min.js%22/).",We've decided to accept this breakage.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1592028,Blocking images option no longer work in private browsing,WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0

Steps to reproduce:

Attempted to block images in the Page info/Media tab to specific webpages in a private window.  


Actual results:

After refreshing the page there are no changes.


Expected results:

Images should gave been blocked. In normal mode this function works properly.","(In reply to 202nine from comment #0)
> User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
> 
> Steps to reproduce:
> 
> Attempted to block images in the Page info/Media tab to specific webpages in a private window.  
> 
> 
> Actual results:
> 
> After refreshing the page there are no changes.
> 
> 
> Expected results:
> 
> Images should have been blocked. In normal mode this function works properly.","I can not reproduce the problem on Fx71b4 on Win10.

Could you give more steps? Like the URL, Firefox version.","This just happened within the last week's v72 nightly on Windows 7. Last Monday's was good so I don't know when the change was made. 

An example is the Google logo just above the search box from https://www.google.com/. Go into a private window, then block that in the Media tab and refresh. There is no change although in normal mode it will be removed.","STR:
Open firefox, and enter to private browsing.
Open the https://bugzilla.mozilla.org/describecomponents.cgi, and then open Page Info window from context menu.
Go to Media panel, find and check the Block images from bugzilla.mozilla.org.
Reload the above page, it works fine if the images (icons) is no longer displayed.

Regression window:
https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=86d60b2e96387dc818cc9fc2f9e58ef6cc1adea3&tochange=f915da42169e70bdd6711457966620e80f9fa774
> End of the bisection
> Error: The url u'https://hg.mozilla.org/integration/mozilla-inbound/json-pushes?changeset=f915da42169e70bdd6711457966620e80f9fa774&full=1' returned a 404 error. Please check the validity of the url.

I suspect bug 1422056.","Seems like a regression from that bug, though I'm not sure why it would happen. Anyway, we are planning to remove native image blocking support very soon (bug 1357107), so depending on the level of effort this is probably not worth fixing at this point.","The priority flag is not set for this bug.
:johannh, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1571730,Autoplay drop down is shifted if opened before the content blocking information is loaded,WONTFIX,"Created attachment 9083351
shiftblockauto.gif

- [Affected versions]:
Nightly 70.0a1
Fx 68.0
Fx 69.0b11

- [Affected platforms]:
MacOS 10.12
Windows 10x64
Ubuntu 18.4

 - [Steps to reproduce]:
1. Launch Firefox with block autoplay enabled
2. Go to https://www.youtube.com
3. Click to open any video in a new tab
4. Click on the autoplay crossover icon
5. Open the autoplay drop down options
6. Wait a second for the content blocking information to load
7. Observe the autoplay dropdown

 - [Expected]:
Autoplay drop downs should not shift when other site information is loaded

 - [Actual Results]:
Autoplay drop down is shifted if opened before the content blocking information is loaded

 - [Note]: Issue is reproducible when autoplay dropdown is opened before the site content blocking is loaded

 - Regression: Not a regression, issue seen on the old autoplay implemented in Fx 66","Created attachment 9083352
blockautoplayWin.png",This is not applicable in Nightly anymore because the content blocking section got moved to a different panel and it's basically impossible to fix for any other release.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1585636,NetMonitor blocking - Add clear filter button in the add path input box,WONTFIX,"Created attachment 9098229
netmonitor_blockingUI_XonRequestBlockingPathBox.png

**Affected versions**
* 71.0a1 (2019-09-29) 

**Affected platforms**
* all available;

**Steps to reproduce**
devtools.netmonitor.features.requestBlocking set on true
1. Launch Firefox, access any webpage, open the DevTools inspector - Network tab;
2. Enable the Request blocking panel;
3. Input any text in the ""Block resource when URL contains"" text-box;
4. Click away so the box is out of focus;

**Expected result / Enchancement suggestion**
* as per the Filter URLs and Search filtering boxes the Clear option would't hurt to be displayed in this one as well;
* only way right now is to ""cancel"" the text is the Escape key;

**Actual result**
* the user might loose track of the text-path input if clicking away and resuming work after a while;

**Regression range**
* not a regression, only visible after implementation of bug 1580728;

**Additional notes**
* attached screenshot with the issue;",Usually we have clear buttons on search inputs only. Have you found more cases of clear inputs on other types?,"None that I can think of right now.
Indeed, this would probably make it confusing at some point.","(In reply to Cristian Fogel, QA [:cfogel] from comment #2)
> None that I can think of right now.
> Indeed, this would probably make it confusing at some point.

Okay so, sounds like we can close this one.
Thanks for the report anyway!
Honza",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1519108,Closed tabs will not disappear immediately from about:performance list,WONTFIX,"Created attachment 9035630
Process not synced .gif

**Affected versions**
* 66.0a1 (2019-01-10)
* 65.0b9 (64-bit)

**Affected platforms**
* Windows 10 x64
* maOS 10.13
* Ubuntu 16.04 x64

**Steps to reproduce**
1. Launch FF.
2. Open multiple pages such as (BBC, CNN, reddit, twtitter etc.)
3. Open about:performance
4. Close one of the open tabs from the tab carousel.


**Expected result**
* Closing one of the tabs from the tab carousel should also close the tab process from about:performance list.

**Actual result**
* Closing one of the tabs from the tab carousel does not close the tab from about:performance immediately.(only after ~10 seconds if not interacted with)

**Regression range**
* Not a regression

**Additional notes**
* As a normal user, when I close a tab from the tab carousel, I would also expect that it will disappear from about:performance list as well. 
Keeping that in mind, I will attempt to click the X for the tab in the about:performance list multiple times to remove it from the list, but only end up with it stuck in the section for another 10 seconds from each click.",Moving out bugs to close Milestone meta.,Moving out bugs to close Milestone meta.,"Mass closing about:performance bugs as about:performance has been removed in bug 1836191 in favor of about:processes which displays more accurate data. If this bug still applies to about:processes, feel free to reopen and change the summary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1530403,"Add a search bar to ""about:performance"" to filter items",WONTFIX,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:65.0) Gecko/20100101 Firefox/65.0

Steps to reproduce:

open about:performance
click on Type


Actual results:

nothing


Expected results:

Sort tasks after Type then memory usage.

A search bar for ""Add-Ons"" or groups with the same part of title/type to filter and see their perfomance.",blocks https://bugzilla.mozilla.org/show_bug.cgi?id=1478832,"Sorting is bug 1498187. I can't find any duplicates for the search bar though, so I'll edit the summary accordingly.","Mass closing about:performance bugs as about:performance has been removed in bug 1836191 in favor of about:processes which displays more accurate data. If this bug still applies to about:processes, feel free to reopen and change the summary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1513885,User must be able to select multiple tabs in about:performance as well,WONTFIX,"[Affected versions]:

Firefox 65.0b4 (BuildId:20181211223337).
Firefox 66.0a1 (BuildId:20181212215507).

[Affected platforms]:

macOS 10.14
Ubuntu 16.04 64bit
Windows 10 64bit

[Steps to reproduce]:

1. Launch FF.
2. Open multiple websites in new tabs.
3. Open about:performance
4. Hold CTRL and select multiple tabs.

[Expected result]:

- User should be able to select multiple tabs (processes)as per in the multi-select tabs feature.

[Actual result]:

- User is unable to select multiple tabs(processes) and must select/close them one at a time.",Moving out bugs to close Milestone meta.,Moving out bugs to close Milestone meta.,"Mass closing about:performance bugs as about:performance has been removed in bug 1836191 in favor of about:processes which displays more accurate data. If this bug still applies to about:processes, feel free to reopen and change the summary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1675017,"the ""about:performance"" page needs correct html table markup",WONTFIX,"User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0

Steps to reproduce:

attempted to navigate the about:performance page via NVDA screen reader 


Actual results:

the page is displaying a table of firefox processies, but the markup is not correct so screen reader cannot read it as a table


Expected results:

valid html table markup should be used so that screeen reader can properly navigate the table.","Can you explain the problems you're experiencing? This is actually a correctly marked up HTML table.

Note that we had some issues with display: block thead/tbody elements which were recently fixed in bug 1020603. That fix is now in Firefox Nightly. I wonder whether this bug is causing the problem you're seeing?","(In reply to James Teh [:Jamie] from comment #1)
> Can you explain the problems you're experiencing? This is actually a correctly marked up HTML table.
> 
> Note that we had some issues with display: block thead/tbody elements which were recently fixed in bug 1020603. That fix is now in Firefox Nightly. I wonder whether this bug is causing the problem you're seeing?

IfI arrow through, I hear:

column1: Name
column2: Type
column3: Energy Impact
column4: Memory

However, I cannot use table nav commands to move across this row, or any row below it.

I copied out the markup via devtools to another file and tried it in same firefox, and everything worked well.

I did notice, however, that the first row of the table (the header row) used ""td"" rather than ""th"" cells; IMO this should be fixed.

I also noticed that attempting to read the tree in devtools failed when it got to the ""tbody"". Inspector saw the first ""tr"" in the body, but couldn't seem to open any cells below it. It seemed as if it was trying to read the entire contents of the ""tbody"" as one long string of html.

-- Rich","This all seems to work for me in Firefox Nightly 84, so I'm guessing whatever issues you're seeing here have been fixed. I'll leave this open until we can confirm that.","Mass closing about:performance bugs as about:performance has been removed in bug 1836191 in favor of about:processes which displays more accurate data. If this bug still applies to about:processes, feel free to reopen and change the summary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1518790,[Win] Worker and tracker icons are not displayed in about:performance while in High Contrast themes,WONTFIX,"Created attachment 9035304
compare HC vs non HC.JPG

[Affected versions]:

- 65.0b9
- 66.0a1

[Affected platforms]:

- Windows 10 x64
- Windows 8.1 x64

[Steps to reproduce]:

1. Launch FF.
2. Access multiple websites such as CNN, BBC , Reddit etc.
3. Open about:performance and drop down all the information about the websites.
4. Wait a few seconds for the icons of the webpage trackers and workers to load.
5. Go to the system's High Contrast menu and activate High Contrast Black.
6. Refresh the about:performance page for the changes to take effect and wait a few seconds.

[Expected result]:

- The tracker and workers icons load and are displayed even while on High Contrast Black.

[Actual result]:

- The icons are never loaded and displayed while the system is on High Contrast Black.

[Regression range]:

- Not a regression.",This issue actually occurs with all the available High Contrast Themes of the system.,Moving out bugs to close Milestone meta.,Moving out bugs to close Milestone meta.,"Mass closing about:performance bugs as about:performance has been removed in bug 1836191 in favor of about:processes which displays more accurate data. If this bug still applies to about:processes, feel free to reopen and change the summary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1511712,"Functionality of  the ""A webpage is slowing down ..."" popup bar?  [a feature request]",WONTFIX,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0

Steps to reproduce:

On some webs (e.g. www.idnes.cz) after a while that yellow bar ""A webpage is slowing down your browser. What would you like to do? [Stop It] [Wait]"" appears.



Actual results:

A yellow bar ""A webpage is slowing down your browser. What would you like to do? [Stop It] [Wait]"" appears.


Expected results:

Would it be possible to show which script(s) exactly (a domain name should be enough) is the culprit, please?","Which problem would such details solve for an average user? 

Advanced users can use the performance / network stuff in the Developer Tools to see loading times.","OK, point taken.","I verified this issue on Ubuntu 16.04 with the latest Firefox release version 63.0 (64-bit) and I cannot reproduce it. 
Can you please test this in safe mode? Here is a link that can help you: https://goo.gl/AR5o9d.
I think it will be a good idea to retest this on the latest Firefox Nightly. Here is a link form where you can download it: https://nightly.mozilla.org. 
If you still have the issue please create a new profile, you have the steps here: https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles?redirectlocale=en-US&redirectslug=Managing-profiles#w_starting-the-profile-manager","Daniel, this isn't a bug but a feature request.
Closing as we don't want to do that.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1534194,"Firefox slow responses in VPN, close() of a socket opened to :80 blocks the socket thread for 20 seconds.",WONTFIX,"User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:65.0) Gecko/20100101 Firefox/65.0

Steps to reproduce:

After I connected to my company network, I would need to configure a proxy to access the internet. But, as I wanted to navigate to a site in the intranet I did not configure the proxy.


Actual results:

Firefox was really slow in loading the pages of the intranet, with some elements / asynchronous calls waiting for a 10 second timeout before loading. I can guarantee that the intranet site is not redirecting any calls of its server / into the internet. This issue is reproducible every time and is not remedied after time, only after configuring the proxy.


Expected results:

Chrome (w/o a proxy set-up and thus no access to the internet) loaded the intranet web pages in less than a second, during the same VPN session. Firefox did as well after I configured the proxy.","can you give us a http log:
https://developer.mozilla.org/en-US/docs/Mozilla/Debugging/HTTP_logging

you can also send it via email, because it may contain intranet uri, cookies...","I repeated the test and created following log files:

1) W/O Proxy > no-proxy.1.txt-main.11540
2) W/ Proxy > proxy.txt-main.11540
3) W/O Proxy > no-proxy.2.txt-main.11540

@Dragana: I send the files to your gmail.","Dragana, if you want me to look at those logs, feel free to forward them to me (I'm on triage this week).","(In reply to Honza Bambas (:mayhemer) from comment #3)

> Dragana, if you want me to look at those logs, feel free to forward them to me (I'm on triage this week).

Thanks!!!","The priority flag is not set for this bug.
:mayhemer, could you have a look please?",Taking from dd.,"Thanks for the logs.  They are cropped (about:networking), I would love to see a complete log to confirm the findings:
https://developer.mozilla.org/en-US/docs/Mozilla/Debugging/HTTP_logging#Start_logging_using_command_line_arguments


PR_Close() (calling `close()` on the socket handle) for sockets opened to `detectportal.firefox.com:80` hang for several seconds, blocking the socket thread and delaying all network operations during that period:

	Line 4826: 2019-03-19 19:46:59.361000 UTC - [Parent 11540: Socket Thread]: D/nsSocketTransport nsSocketTransport: calling PR_Close [this=000001C6DF8CA400]
	Line 5183: 2019-03-19 19:47:20.044000 UTC - [Parent 11540: Socket Thread]: D/nsSocketTransport destroying nsSocketTransport @000001C6DF8CA400

I can see this happening somewhat 3 times in the no-proxy log #1.  Only `detectportal.firefox.com` is being reached on 80, other sockets (for which I can see the address:port) seem to be open only to port 443; on those closing is instant.



I don't think this a Firefox issue at all, it could only be an architectural problem - having one thread for all open sockets processing...  The real problem sits in the VPN client virtual adapter blocking close() of sockets this long.

I'm afraid we can't do much about it unless a huge overhaul of the backend...  This is a strong candidate for a WONTFIX.


CC'ing Michal, our Linux guru, for possible thoughts on how to fix this locally on your system, but please first I'd love to have a look at the complete log.

Thanks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
1590578,Certificate import is slow/unintuitive,WONTFIX,"Created attachment 9103398
Screen Shot 2019-10-22 at 18.54.30.png

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36

Steps to reproduce:

(1) Download DoD root certificates via AllCerts.zip
(2) Unzip the file, select all certificates, right-click, and Open With... 
(3) Select Firefox



Actual results:

Over 40 new tabs open, along with over 40 dialogs asking if I want to save the certificates or open them with Keychain Access. 


Expected results:

The certificates should be imported into Firefox. 

NOTE: This is a regression.","What version of Firefox did this work as expected in?
As an alternative, can you import them into the keychain (setting the appropriate trust), and then enable the enterprise roots feature by setting the `about:config` preference `security.enterprise_roots.enabled` to `true`?","Created attachment 9103624
Mass Cert Import working in Firefox 35.0.png","Created attachment 9103625
Mass Cert Import working in Firefox 45.0.1.png","Confirmed that mass import works in Firefox 35.0 and 45.0.1.  It does not work in Firefox 56.0.  

I'll try the Enterprise Roots feature and see if that helps.","Enabling Enterprise Roots works to enable CAC functionality if DoD certs are imported into Keychain Access.  However, it still exhibits the issue described in https://bugzilla.mozilla.org/show_bug.cgi?id=1590610 -- specifically, use of PIV/CAC login eventually causes the browser to hang while connecting to other sites, and may cause a hang and crash upon quitting Firefox.","The priority flag is not set for this bug.
:wleung, could you have a look please?

For more information, please visit [auto_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).","Hi J.C., please take a look at this and set the priority. thanks!","While we could certainly improve the way Firefox handles importing multiple CA certificates, the preferred route is for users to use the enterprise roots feature, so I'm going to close this as WONTFIX.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
